"use strict";(self.webpackChunkCV=self.webpackChunkCV||[]).push([[179],{802:()=>{function Tt(i){return"function"==typeof i}function kl(i){const t=i(n=>{Error.call(n),n.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Nu=kl(i=>function(t){i(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((n,r)=>`${r+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Vo(i,e){if(i){const t=i.indexOf(e);0<=t&&i.splice(t,1)}}class di{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:n}=this;if(Tt(n))try{n()}catch(s){e=s instanceof Nu?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{G_(s)}catch(o){e=e??[],o instanceof Nu?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Nu(e)}}add(e){var t;if(e&&e!==this)if(this.closed)G_(e);else{if(e instanceof di){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Vo(t,e)}remove(e){const{_finalizers:t}=this;t&&Vo(t,e),e instanceof di&&e._removeParent(this)}}di.EMPTY=(()=>{const i=new di;return i.closed=!0,i})();const V_=di.EMPTY;function H_(i){return i instanceof di||i&&"closed"in i&&Tt(i.remove)&&Tt(i.add)&&Tt(i.unsubscribe)}function G_(i){Tt(i)?i():i.unsubscribe()}const Fs={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Ou={setTimeout(i,e,...t){const{delegate:n}=Ou;return n?.setTimeout?n.setTimeout(i,e,...t):setTimeout(i,e,...t)},clearTimeout(i){const{delegate:e}=Ou;return(e?.clearTimeout||clearTimeout)(i)},delegate:void 0};function W_(i){Ou.setTimeout(()=>{const{onUnhandledError:e}=Fs;if(!e)throw i;e(i)})}function $_(){}const yT=Rp("C",void 0,void 0);function Rp(i,e,t){return{kind:i,value:e,error:t}}let ks=null;function Fu(i){if(Fs.useDeprecatedSynchronousErrorHandling){const e=!ks;if(e&&(ks={errorThrown:!1,error:null}),i(),e){const{errorThrown:t,error:n}=ks;if(ks=null,t)throw n}}else i()}class Pp extends di{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,H_(e)&&e.add(this)):this.destination=ST}static create(e,t,n){return new zl(e,t,n)}next(e){this.isStopped?Np(function _T(i){return Rp("N",i,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Np(function vT(i){return Rp("E",void 0,i)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Np(yT,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const wT=Function.prototype.bind;function Lp(i,e){return wT.call(i,e)}class bT{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){ku(n)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){ku(n)}else ku(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){ku(t)}}}class zl extends Pp{constructor(e,t,n){let r;if(super(),Tt(e)||!e)r={next:e??void 0,error:t??void 0,complete:n??void 0};else{let s;this&&Fs.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Lp(e.next,s),error:e.error&&Lp(e.error,s),complete:e.complete&&Lp(e.complete,s)}):r=e}this.destination=new bT(r)}}function ku(i){Fs.useDeprecatedSynchronousErrorHandling?function xT(i){Fs.useDeprecatedSynchronousErrorHandling&&ks&&(ks.errorThrown=!0,ks.error=i)}(i):W_(i)}function Np(i,e){const{onStoppedNotification:t}=Fs;t&&Ou.setTimeout(()=>t(i,e))}const ST={closed:!0,next:$_,error:function MT(i){throw i},complete:$_},Op="function"==typeof Symbol&&Symbol.observable||"@@observable";function zs(i){return i}function j_(i){return 0===i.length?zs:1===i.length?i[0]:function(t){return i.reduce((n,r)=>r(n),t)}}let Kt=(()=>{class i{constructor(t){t&&(this._subscribe=t)}lift(t){const n=new i;return n.source=this,n.operator=t,n}subscribe(t,n,r){const s=function ET(i){return i&&i instanceof Pp||function DT(i){return i&&Tt(i.next)&&Tt(i.error)&&Tt(i.complete)}(i)&&H_(i)}(t)?t:new zl(t,n,r);return Fu(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return new(n=q_(n))((r,s)=>{const o=new zl({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(t)}[Op](){return this}pipe(...t){return j_(t)(this)}toPromise(t){return new(t=q_(t))((n,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>n(s))})}}return i.create=e=>new i(e),i})();function q_(i){var e;return null!==(e=i??Fs.Promise)&&void 0!==e?e:Promise}const AT=kl(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Mr=(()=>{class i extends Kt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const n=new J_(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new AT}next(t){Fu(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(t)}})}error(t){Fu(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){Fu(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:n,isStopped:r,observers:s}=this;return n||r?V_:(this.currentObservers=null,s.push(t),new di(()=>{this.currentObservers=null,Vo(s,t)}))}_checkFinalizedStatuses(t){const{hasError:n,thrownError:r,isStopped:s}=this;n?t.error(r):s&&t.complete()}asObservable(){const t=new Kt;return t.source=this,t}}return i.create=(e,t)=>new J_(e,t),i})();class J_ extends Mr{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:V_}}function Y_(i){return Tt(i?.lift)}function xn(i){return e=>{if(Y_(e))return e.lift(function(t){try{return i(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function wn(i,e,t,n,r){return new TT(i,e,t,n,r)}class TT extends Pp{constructor(e,t,n,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function lt(i,e){return xn((t,n)=>{let r=0;t.subscribe(wn(n,s=>{n.next(i.call(e,s,r++))}))})}function Bs(i){return this instanceof Bs?(this.v=i,this):new Bs(i)}function PT(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,n=t.apply(i,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(d){n[d]&&(r[d]=function(f){return new Promise(function(p,g){s.push([d,f,p,g])>1||a(d,f)})})}function a(d,f){try{!function l(d){d.value instanceof Bs?Promise.resolve(d.value.v).then(c,u):h(s[0][2],d)}(n[d](f))}catch(p){h(s[0][3],p)}}function c(d){a("next",d)}function u(d){a("throw",d)}function h(d,f){d(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}function LT(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=i[Symbol.asyncIterator];return e?e.call(i):(i=function K_(i){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=i[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=i[s](o)).done,o.value)})}}}const Q_=i=>i&&"number"==typeof i.length&&"function"!=typeof i;function e1(i){return Tt(i?.then)}function t1(i){return Tt(i[Op])}function n1(i){return Symbol.asyncIterator&&Tt(i?.[Symbol.asyncIterator])}function i1(i){return new TypeError(`You provided ${null!==i&&"object"==typeof i?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const r1=function OT(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function s1(i){return Tt(i?.[r1])}function o1(i){return PT(this,arguments,function*(){const t=i.getReader();try{for(;;){const{value:n,done:r}=yield Bs(t.read());if(r)return yield Bs(void 0);yield yield Bs(n)}}finally{t.releaseLock()}})}function a1(i){return Tt(i?.getReader)}function ar(i){if(i instanceof Kt)return i;if(null!=i){if(t1(i))return function FT(i){return new Kt(e=>{const t=i[Op]();if(Tt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(i);if(Q_(i))return function kT(i){return new Kt(e=>{for(let t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}(i);if(e1(i))return function zT(i){return new Kt(e=>{i.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,W_)})}(i);if(n1(i))return l1(i);if(s1(i))return function BT(i){return new Kt(e=>{for(const t of i)if(e.next(t),e.closed)return;e.complete()})}(i);if(a1(i))return function UT(i){return l1(o1(i))}(i)}throw i1(i)}function l1(i){return new Kt(e=>{(function VT(i,e){var t,n,r,s;return function IT(i,e,t,n){return new(t||(t=Promise))(function(s,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((n=n.apply(i,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=LT(i);!(n=yield t.next()).done;)if(e.next(n.value),e.closed)return}catch(o){r={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(i,e).catch(t=>e.error(t))})}function Sr(i,e,t,n=0,r=!1){const s=e.schedule(function(){t(),r?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(s),!r)return s}function En(i,e,t=1/0){return Tt(e)?En((n,r)=>lt((s,o)=>e(n,s,r,o))(ar(i(n,r))),t):("number"==typeof e&&(t=e),xn((n,r)=>function HT(i,e,t,n,r,s,o,a){const l=[];let c=0,u=0,h=!1;const d=()=>{h&&!l.length&&!c&&e.complete()},f=g=>c<n?p(g):l.push(g),p=g=>{s&&e.next(g),c++;let m=!1;ar(t(g,u++)).subscribe(wn(e,y=>{r?.(y),s?f(y):e.next(y)},()=>{m=!0},void 0,()=>{if(m)try{for(c--;l.length&&c<n;){const y=l.shift();o?Sr(e,o,()=>p(y)):p(y)}d()}catch(y){e.error(y)}}))};return i.subscribe(wn(e,f,()=>{h=!0,d()})),()=>{a?.()}}(n,r,i,t)))}function Ho(i=1/0){return En(zs,i)}const Cr=new Kt(i=>i.complete());function c1(i){return i&&Tt(i.schedule)}function kp(i){return i[i.length-1]}function Bl(i){return c1(kp(i))?i.pop():void 0}function u1(i,e=0){return xn((t,n)=>{t.subscribe(wn(n,r=>Sr(n,i,()=>n.next(r),e),()=>Sr(n,i,()=>n.complete(),e),r=>Sr(n,i,()=>n.error(r),e)))})}function h1(i,e=0){return xn((t,n)=>{n.add(i.schedule(()=>t.subscribe(n),e))})}function d1(i,e){if(!i)throw new Error("Iterable cannot be null");return new Kt(t=>{Sr(t,e,()=>{const n=i[Symbol.asyncIterator]();Sr(t,e,()=>{n.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function cn(i,e){return e?function XT(i,e){if(null!=i){if(t1(i))return function jT(i,e){return ar(i).pipe(h1(e),u1(e))}(i,e);if(Q_(i))return function JT(i,e){return new Kt(t=>{let n=0;return e.schedule(function(){n===i.length?t.complete():(t.next(i[n++]),t.closed||this.schedule())})})}(i,e);if(e1(i))return function qT(i,e){return ar(i).pipe(h1(e),u1(e))}(i,e);if(n1(i))return d1(i,e);if(s1(i))return function YT(i,e){return new Kt(t=>{let n;return Sr(t,e,()=>{n=i[r1](),Sr(t,e,()=>{let r,s;try{({value:r,done:s}=n.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>Tt(n?.return)&&n.return()})}(i,e);if(a1(i))return function ZT(i,e){return d1(o1(i),e)}(i,e)}throw i1(i)}(i,e):ar(i)}function zp(i,e,...t){if(!0===e)return void i();if(!1===e)return;const n=new zl({next:()=>{n.unsubscribe(),i()}});return e(...t).subscribe(n)}function Dt(i){for(let e in i)if(i[e]===Dt)return e;throw Error("Could not find renamed property on target object.")}function Et(i){if("string"==typeof i)return i;if(Array.isArray(i))return"["+i.map(Et).join(", ")+"]";if(null==i)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;const e=i.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Up(i,e){return null==i||""===i?null===e?"":e:null==e||""===e?i:i+" "+e}const eI=Dt({__forward_ref__:Dt});function Vp(i){return i.__forward_ref__=Vp,i.toString=function(){return Et(this())},i}function Re(i){return Hp(i)?i():i}function Hp(i){return"function"==typeof i&&i.hasOwnProperty(eI)&&i.__forward_ref__===Vp}function Gp(i){return i&&!!i.\u0275providers}class he extends Error{constructor(e,t){super(function zu(i,e){return`NG0${Math.abs(i)}${e?": "+e.trim():""}`}(e,t)),this.code=e}}function xt(i){return"function"==typeof i?i.name||i.toString():"object"==typeof i&&null!=i&&"function"==typeof i.type?i.type.name||i.type.toString():function $e(i){return"string"==typeof i?i:null==i?"":String(i)}(i)}function Bu(i,e){throw new he(-201,!1)}function Ai(i,e){null==i&&function wt(i,e,t,n){throw new Error(`ASSERTION ERROR: ${i}`+(null==n?"":` [Expected=> ${t} ${n} ${e} <=Actual]`))}(e,i,null,"!=")}function Ve(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function ss(i){return{providers:i.providers||[],imports:i.imports||[]}}function Uu(i){return p1(i,Vu)||p1(i,m1)}function p1(i,e){return i.hasOwnProperty(e)?i[e]:null}function g1(i){return i&&(i.hasOwnProperty(Wp)||i.hasOwnProperty(cI))?i[Wp]:null}const Vu=Dt({\u0275prov:Dt}),Wp=Dt({\u0275inj:Dt}),m1=Dt({ngInjectableDef:Dt}),cI=Dt({ngInjectorDef:Dt});var Pe=(()=>((Pe=Pe||{})[Pe.Default=0]="Default",Pe[Pe.Host=1]="Host",Pe[Pe.Self=2]="Self",Pe[Pe.SkipSelf=4]="SkipSelf",Pe[Pe.Optional=8]="Optional",Pe))();let $p;function Ti(i){const e=$p;return $p=i,e}function y1(i,e,t){const n=Uu(i);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:t&Pe.Optional?null:void 0!==e?e:void Bu(Et(i))}const It=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Ul={},jp="__NG_DI_FLAG__",Hu="ngTempTokenPath",dI=/\n/gm,v1="__source";let Vl;function Go(i){const e=Vl;return Vl=i,e}function pI(i,e=Pe.Default){if(void 0===Vl)throw new he(-203,!1);return null===Vl?y1(i,void 0,e):Vl.get(i,e&Pe.Optional?null:void 0,e)}function Ee(i,e=Pe.Default){return(function uI(){return $p}()||pI)(Re(i),e)}function ct(i,e=Pe.Default){return Ee(i,Gu(e))}function Gu(i){return typeof i>"u"||"number"==typeof i?i:0|(i.optional&&8)|(i.host&&1)|(i.self&&2)|(i.skipSelf&&4)}function qp(i){const e=[];for(let t=0;t<i.length;t++){const n=Re(i[t]);if(Array.isArray(n)){if(0===n.length)throw new he(900,!1);let r,s=Pe.Default;for(let o=0;o<n.length;o++){const a=n[o],l=gI(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Ee(r,s))}else e.push(Ee(n))}return e}function Hl(i,e){return i[jp]=e,i.prototype[jp]=e,i}function gI(i){return i[jp]}function os(i){return{toString:i}.toString()}var Wi=(()=>((Wi=Wi||{})[Wi.OnPush=0]="OnPush",Wi[Wi.Default=1]="Default",Wi))(),lr=(()=>{return(i=lr||(lr={}))[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",lr;var i})();const Er={},vt=[],Wu=Dt({\u0275cmp:Dt}),Jp=Dt({\u0275dir:Dt}),Yp=Dt({\u0275pipe:Dt}),x1=Dt({\u0275mod:Dt}),Ar=Dt({\u0275fac:Dt}),Gl=Dt({__NG_ELEMENT_ID__:Dt});let vI=0;function Wo(i){return os(()=>{const t=!0===i.standalone,n={},r={type:i.type,providersResolver:null,decls:i.decls,vars:i.vars,factory:null,template:i.template||null,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:i.exportAs||null,onPush:i.changeDetection===Wi.OnPush,directiveDefs:null,pipeDefs:null,standalone:t,dependencies:t&&i.dependencies||null,getStandaloneInjector:null,selectors:i.selectors||vt,viewQuery:i.viewQuery||null,features:i.features||null,data:i.data||{},encapsulation:i.encapsulation||lr.Emulated,id:"c"+vI++,styles:i.styles||vt,_:null,setInput:null,schemas:i.schemas||null,tView:null,findHostDirectiveDefs:null,hostDirectives:null},s=i.dependencies,o=i.features;return r.inputs=M1(i.inputs,n),r.outputs=M1(i.outputs),o&&o.forEach(a=>a(r)),r.directiveDefs=s?()=>("function"==typeof s?s():s).map(w1).filter(b1):null,r.pipeDefs=s?()=>("function"==typeof s?s():s).map(Wn).filter(b1):null,r})}function w1(i){return bt(i)||Ln(i)}function b1(i){return null!==i}function Us(i){return os(()=>({type:i.type,bootstrap:i.bootstrap||vt,declarations:i.declarations||vt,imports:i.imports||vt,exports:i.exports||vt,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null}))}function M1(i,e){if(null==i)return Er;const t={};for(const n in i)if(i.hasOwnProperty(n)){let r=i[n],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=n,e&&(e[r]=s)}return t}const Gn=Wo;function bt(i){return i[Wu]||null}function Ln(i){return i[Jp]||null}function Wn(i){return i[Yp]||null}function pi(i,e){const t=i[x1]||null;if(!t&&!0===e)throw new Error(`Type ${Et(i)} does not have '\u0275mod' property.`);return t}function gi(i){return Array.isArray(i)&&"object"==typeof i[1]}function ji(i){return Array.isArray(i)&&!0===i[1]}function Xp(i){return 0!=(4&i.flags)}function Zu(i){return i.componentOffset>-1}function Xu(i){return 1==(1&i.flags)}function qi(i){return null!==i.template}function MI(i){return 0!=(256&i[2])}function Hs(i,e){return i.hasOwnProperty(Ar)?i[Ar]:null}class DI{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function Gs(){return T1}function T1(i){return i.type.prototype.ngOnChanges&&(i.setInput=AI),EI}function EI(){const i=R1(this),e=i?.current;if(e){const t=i.previous;if(t===Er)i.previous=e;else for(let n in e)t[n]=e[n];i.current=null,this.ngOnChanges(e)}}function AI(i,e,t,n){const r=this.declaredInputs[t],s=R1(i)||function TI(i,e){return i[I1]=e}(i,{previous:Er,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[r];o[r]=new DI(l&&l.currentValue,e,a===Er),i[n]=e}Gs.ngInherit=!0;const I1="__ngSimpleChanges__";function R1(i){return i[I1]||null}function An(i){for(;Array.isArray(i);)i=i[0];return i}function mi(i,e){return An(e[i.index])}function yi(i,e){const t=e[i];return gi(t)?t:t[0]}function Qu(i){return 64==(64&i[2])}function as(i,e){return null==e?null:i[e]}function L1(i){i[18]=0}function tg(i,e){i[5]+=e;let t=i,n=i[3];for(;null!==n&&(1===e&&1===t[5]||-1===e&&0===t[5]);)n[5]+=e,t=n,n=n[3]}const He={lFrame:G1(null),bindingsEnabled:!0};function O1(){return He.bindingsEnabled}function K(){return He.lFrame.lView}function ut(){return He.lFrame.tView}function Tn(){let i=F1();for(;null!==i&&64===i.type;)i=i.parent;return i}function F1(){return He.lFrame.currentTNode}function hr(i,e){const t=He.lFrame;t.currentTNode=i,t.isParent=e}function ng(){return He.lFrame.isParent}function jI(i,e){const t=He.lFrame;t.bindingIndex=t.bindingRootIndex=i,rg(e)}function rg(i){He.lFrame.currentDirectiveIndex=i}function og(i){He.lFrame.currentQueryIndex=i}function JI(i){const e=i[1];return 2===e.type?e.declTNode:1===e.type?i[6]:null}function V1(i,e,t){if(t&Pe.SkipSelf){let r=e,s=i;for(;!(r=r.parent,null!==r||t&Pe.Host||(r=JI(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,i=s}const n=He.lFrame=H1();return n.currentTNode=e,n.lView=i,!0}function ag(i){const e=H1(),t=i[1];He.lFrame=e,e.currentTNode=t.firstChild,e.lView=i,e.tView=t,e.contextLView=i,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function H1(){const i=He.lFrame,e=null===i?null:i.child;return null===e?G1(i):e}function G1(i){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return null!==i&&(i.child=e),e}function W1(){const i=He.lFrame;return He.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}const $1=W1;function lg(){const i=W1();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function Ws(i){He.lFrame.selectedIndex=i}function eh(i,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){const s=i.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(i.contentHooks||(i.contentHooks=[])).push(-t,o),a&&((i.contentHooks||(i.contentHooks=[])).push(t,a),(i.contentCheckHooks||(i.contentCheckHooks=[])).push(t,a)),l&&(i.viewHooks||(i.viewHooks=[])).push(-t,l),c&&((i.viewHooks||(i.viewHooks=[])).push(t,c),(i.viewCheckHooks||(i.viewCheckHooks=[])).push(t,c)),null!=u&&(i.destroyHooks||(i.destroyHooks=[])).push(t,u)}}function th(i,e,t){J1(i,e,3,t)}function nh(i,e,t,n){(3&i[2])===t&&J1(i,e,t,n)}function cg(i,e){let t=i[2];(3&t)===e&&(t&=2047,t+=1,i[2]=t)}function J1(i,e,t,n){const s=n??-1,o=e.length-1;let a=0;for(let l=void 0!==n?65535&i[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=n&&a>=n)break}else e[l]<0&&(i[18]+=65536),(a<s||-1==s)&&(tR(i,t,e,l),i[18]=(4294901760&i[18])+l+2),l++}function tR(i,e,t,n){const r=t[n]<0,s=t[n+1],a=i[r?-t[n]:t[n]];if(r){if(i[2]>>11<i[18]>>16&&(3&i[2])===e){i[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class Jl{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function dg(i,e,t){let n=0;for(;n<t.length;){const r=t[n];if("number"==typeof r){if(0!==r)break;n++;const s=t[n++],o=t[n++],a=t[n++];i.setAttribute(e,o,a,s)}else{const s=r,o=t[++n];Z1(s)?i.setProperty(e,s,o):i.setAttribute(e,s,o),n++}}return n}function Y1(i){return 3===i||4===i||6===i}function Z1(i){return 64===i.charCodeAt(0)}function Yl(i,e){if(null!==e&&0!==e.length)if(null===i||0===i.length)i=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){const r=e[n];"number"==typeof r?t=r:0===t||X1(i,t,r,null,-1===t||2===t?e[++n]:null)}}return i}function X1(i,e,t,n,r){let s=0,o=i.length;if(-1===e)o=-1;else for(;s<i.length;){const a=i[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<i.length;){const a=i[s];if("number"==typeof a)break;if(a===t){if(null===n)return void(null!==r&&(i[s+1]=r));if(n===i[s+1])return void(i[s+2]=r)}s++,null!==n&&s++,null!==r&&s++}-1!==o&&(i.splice(o,0,e),s=o+1),i.splice(s++,0,t),null!==n&&i.splice(s++,0,n),null!==r&&i.splice(s++,0,r)}function K1(i){return-1!==i}function ih(i){return 32767&i}function rh(i,e){let t=function oR(i){return i>>16}(i),n=e;for(;t>0;)n=n[15],t--;return n}let fg=!0;function sh(i){const e=fg;return fg=i,e}let aR=0;const dr={};function oh(i,e){const t=tx(i,e);if(-1!==t)return t;const n=e[1];n.firstCreatePass&&(i.injectorIndex=e.length,pg(n.data,i),pg(e,null),pg(n.blueprint,null));const r=gg(i,e),s=i.injectorIndex;if(K1(r)){const o=ih(r),a=rh(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function pg(i,e){i.push(0,0,0,0,0,0,0,0,e)}function tx(i,e){return-1===i.injectorIndex||i.parent&&i.parent.injectorIndex===i.injectorIndex||null===e[i.injectorIndex+8]?-1:i.injectorIndex}function gg(i,e){if(i.parent&&-1!==i.parent.injectorIndex)return i.parent.injectorIndex;let t=0,n=null,r=e;for(;null!==r;){if(n=cx(r),null===n)return-1;if(t++,r=r[15],-1!==n.injectorIndex)return n.injectorIndex|t<<16}return-1}function mg(i,e,t){!function lR(i,e,t){let n;"string"==typeof t?n=t.charCodeAt(0)||0:t.hasOwnProperty(Gl)&&(n=t[Gl]),null==n&&(n=t[Gl]=aR++);const r=255&n;e.data[i+(r>>5)]|=1<<r}(i,e,t)}function nx(i,e,t){if(t&Pe.Optional||void 0!==i)return i;Bu()}function ix(i,e,t,n){if(t&Pe.Optional&&void 0===n&&(n=null),0==(t&(Pe.Self|Pe.Host))){const r=i[9],s=Ti(void 0);try{return r?r.get(e,n,t&Pe.Optional):y1(e,n,t&Pe.Optional)}finally{Ti(s)}}return nx(n,0,t)}function rx(i,e,t,n=Pe.Default,r){if(null!==i){if(1024&e[2]){const o=function fR(i,e,t,n,r){let s=i,o=e;for(;null!==s&&null!==o&&1024&o[2]&&!(256&o[2]);){const a=sx(s,o,t,n|Pe.Self,dr);if(a!==dr)return a;let l=s.parent;if(!l){const c=o[21];if(c){const u=c.get(t,dr,n);if(u!==dr)return u}l=cx(o),o=o[15]}s=l}return r}(i,e,t,n,dr);if(o!==dr)return o}const s=sx(i,e,t,n,dr);if(s!==dr)return s}return ix(e,t,n,r)}function sx(i,e,t,n,r){const s=function hR(i){if("string"==typeof i)return i.charCodeAt(0)||0;const e=i.hasOwnProperty(Gl)?i[Gl]:void 0;return"number"==typeof e?e>=0?255&e:dR:e}(t);if("function"==typeof s){if(!V1(e,i,n))return n&Pe.Host?nx(r,0,n):ix(e,t,n,r);try{const o=s(n);if(null!=o||n&Pe.Optional)return o;Bu()}finally{$1()}}else if("number"==typeof s){let o=null,a=tx(i,e),l=-1,c=n&Pe.Host?e[16][6]:null;for((-1===a||n&Pe.SkipSelf)&&(l=-1===a?gg(i,e):e[a+8],-1!==l&&ax(n,!1)?(o=e[1],a=ih(l),e=rh(l,e)):a=-1);-1!==a;){const u=e[1];if(ox(s,a,u.data)){const h=uR(a,e,t,o,n,c);if(h!==dr)return h}l=e[a+8],-1!==l&&ax(n,e[1].data[a+8]===c)&&ox(s,a,e)?(o=u,a=ih(l),e=rh(l,e)):a=-1}}return r}function uR(i,e,t,n,r,s){const o=e[1],a=o.data[i+8],u=function ah(i,e,t,n,r){const s=i.providerIndexes,o=e.data,a=1048575&s,l=i.directiveStart,u=s>>20,d=r?a+u:i.directiveEnd;for(let f=n?a:a+u;f<d;f++){const p=o[f];if(f<l&&t===p||f>=l&&p.type===t)return f}if(r){const f=o[l];if(f&&qi(f)&&f.type===t)return l}return null}(a,o,t,null==n?Zu(a)&&fg:n!=o&&0!=(3&a.type),r&Pe.Host&&s===a);return null!==u?Qo(e,o,u,a):dr}function Qo(i,e,t,n){let r=i[t];const s=e.data;if(function nR(i){return i instanceof Jl}(r)){const o=r;o.resolving&&function tI(i,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${i}`:"";throw new he(-200,`Circular dependency in DI detected for ${i}${t}`)}(xt(s[t]));const a=sh(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Ti(o.injectImpl):null;V1(i,n,Pe.Default);try{r=i[t]=o.factory(void 0,s,i,n),e.firstCreatePass&&t>=n.directiveStart&&function eR(i,e,t){const{ngOnChanges:n,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(n){const o=T1(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(i,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(i,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-i,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(i,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(i,s))}(t,s[t],e)}finally{null!==l&&Ti(l),sh(a),o.resolving=!1,$1()}}return r}function ox(i,e,t){return!!(t[e+(i>>5)]&1<<i)}function ax(i,e){return!(i&Pe.Self||i&Pe.Host&&e)}class ea{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return rx(this._tNode,this._lView,e,Gu(n),t)}}function dR(){return new ea(Tn(),K())}function yg(i){return Hp(i)?()=>{const e=yg(Re(i));return e&&e()}:Hs(i)}function cx(i){const e=i[1],t=e.type;return 2===t?e.declTNode:1===t?i[6]:null}const na="__parameters__";function ra(i,e,t){return os(()=>{const n=function vg(i){return function(...t){if(i){const n=i(...t);for(const r in n)this[r]=n[r]}}}(e);function r(...s){if(this instanceof r)return n.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const h=l.hasOwnProperty(na)?l[na]:Object.defineProperty(l,na,{value:[]})[na];for(;h.length<=u;)h.push(null);return(h[u]=h[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=i,r.annotationCls=r,r})}class ze{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Ve({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function $s(i,e){i.forEach(t=>Array.isArray(t)?$s(t,e):e(t))}function hx(i,e,t){e>=i.length?i.push(t):i.splice(e,0,t)}function ch(i,e){return e>=i.length-1?i.pop():i.splice(e,1)[0]}const Ql=Hl(ra("Optional"),8),ec=Hl(ra("SkipSelf"),4);var ri=(()=>((ri=ri||{})[ri.Important=1]="Important",ri[ri.DashCase=2]="DashCase",ri))();const Dg=new Map;let BR=0;const Ag="__ngContext__";function Fn(i,e){gi(e)?(i[Ag]=e[20],function VR(i){Dg.set(i[20],i)}(e)):i[Ag]=e}function Ig(i,e){return undefined(i,e)}function rc(i){const e=i[3];return ji(e)?e[3]:e}function Rg(i){return Ox(i[13])}function Pg(i){return Ox(i[4])}function Ox(i){for(;null!==i&&!ji(i);)i=i[4];return i}function aa(i,e,t,n,r){if(null!=n){let s,o=!1;ji(n)?s=n:gi(n)&&(o=!0,n=n[0]);const a=An(n);0===i&&null!==t?null==r?Vx(e,t,a):js(e,t,a,r||null,!0):1===i&&null!==t?js(e,t,a,r||null,!0):2===i?function Bg(i,e,t){const n=fh(i,e);n&&function lP(i,e,t,n){i.removeChild(e,t,n)}(i,n,e,t)}(e,a,o):3===i&&e.destroyNode(a),null!=s&&function hP(i,e,t,n,r){const s=t[7];s!==An(t)&&aa(e,i,n,s,r);for(let a=10;a<t.length;a++){const l=t[a];sc(l[1],l,i,e,n,s)}}(e,i,s,t,r)}}function Ng(i,e,t){return i.createElement(e,t)}function kx(i,e){const t=i[9],n=t.indexOf(e),r=e[3];512&e[2]&&(e[2]&=-513,tg(r,-1)),t.splice(n,1)}function Og(i,e){if(i.length<=10)return;const t=10+e,n=i[t];if(n){const r=n[17];null!==r&&r!==i&&kx(r,n),e>0&&(i[t-1][4]=n[4]);const s=ch(i,10+e);!function eP(i,e){sc(i,e,e[11],2,null,null),e[0]=null,e[6]=null}(n[1],n);const o=s[19];null!==o&&o.detachView(s[1]),n[3]=null,n[4]=null,n[2]&=-65}return n}function zx(i,e){if(!(128&e[2])){const t=e[11];t.destroyNode&&sc(i,e,t,3,null,null),function iP(i){let e=i[13];if(!e)return Fg(i[1],i);for(;e;){let t=null;if(gi(e))t=e[13];else{const n=e[10];n&&(t=n)}if(!t){for(;e&&!e[4]&&e!==i;)gi(e)&&Fg(e[1],e),e=e[3];null===e&&(e=i),gi(e)&&Fg(e[1],e),t=e&&e[4]}e=t}}(e)}}function Fg(i,e){if(!(128&e[2])){e[2]&=-65,e[2]|=128,function aP(i,e){let t;if(null!=i&&null!=(t=i.destroyHooks))for(let n=0;n<t.length;n+=2){const r=e[t[n]];if(!(r instanceof Jl)){const s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(i,e),function oP(i,e){const t=i.cleanup,n=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?n[r=o]():n[r=-o].unsubscribe(),s+=2}else{const o=n[r=t[s+1]];t[s].call(o)}if(null!==n){for(let s=r+1;s<n.length;s++)(0,n[s])();e[7]=null}}(i,e),1===e[1].type&&e[11].destroy();const t=e[17];if(null!==t&&ji(e[3])){t!==e[3]&&kx(t,e);const n=e[19];null!==n&&n.detachView(i)}!function HR(i){Dg.delete(i[20])}(e)}}function Bx(i,e,t){return function Ux(i,e,t){let n=e;for(;null!==n&&40&n.type;)n=(e=n).parent;if(null===n)return t[0];{const{componentOffset:r}=n;if(r>-1){const{encapsulation:s}=i.data[n.directiveStart+r];if(s===lr.None||s===lr.Emulated)return null}return mi(n,t)}}(i,e.parent,t)}function js(i,e,t,n,r){i.insertBefore(e,t,n,r)}function Vx(i,e,t){i.appendChild(e,t)}function Hx(i,e,t,n,r){null!==n?js(i,e,t,n,r):Vx(i,e,t)}function fh(i,e){return i.parentNode(e)}let Hg,$x=function Wx(i,e,t){return 40&i.type?mi(i,t):null};function ph(i,e,t,n){const r=Bx(i,n,e),s=e[11],a=function Gx(i,e,t){return $x(i,e,t)}(n.parent||e[6],n,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)Hx(s,r,t[l],a,!1);else Hx(s,r,t,a,!1)}function gh(i,e){if(null!==e){const t=e.type;if(3&t)return mi(e,i);if(4&t)return zg(-1,i[e.index]);if(8&t){const n=e.child;if(null!==n)return gh(i,n);{const r=i[e.index];return ji(r)?zg(-1,r):An(r)}}if(32&t)return Ig(e,i)()||An(i[e.index]);{const n=qx(i,e);return null!==n?Array.isArray(n)?n[0]:gh(rc(i[16]),n):gh(i,e.next)}}return null}function qx(i,e){return null!==e?i[16][6].projection[e.projection]:null}function zg(i,e){const t=10+i+1;if(t<e.length){const n=e[t],r=n[1].firstChild;if(null!==r)return gh(n,r)}return e[7]}function Ug(i,e,t,n,r,s,o){for(;null!=t;){const a=n[t.index],l=t.type;if(o&&0===e&&(a&&Fn(An(a),n),t.flags|=2),32!=(32&t.flags))if(8&l)Ug(i,e,t.child,n,r,s,!1),aa(e,i,r,a,s);else if(32&l){const c=Ig(t,n);let u;for(;u=c();)aa(e,i,r,u,s);aa(e,i,r,a,s)}else 16&l?Jx(i,e,n,t,r,s):aa(e,i,r,a,s);t=o?t.projectionNext:t.next}}function sc(i,e,t,n,r,s){Ug(t,n,i.firstChild,e,r,s,!1)}function Jx(i,e,t,n,r,s){const o=t[16],l=o[6].projection[n.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)aa(e,i,r,l[c],s);else Ug(i,e,l,o[3],r,s,!0)}function Yx(i,e,t){""===t?i.removeAttribute(e,"class"):i.setAttribute(e,"class",t)}function Zx(i,e,t){const{mergedAttrs:n,classes:r,styles:s}=t;null!==n&&dg(i,e,n),null!==r&&Yx(i,e,r),null!==s&&function fP(i,e,t){i.setAttribute(e,"style",t)}(i,e,s)}const _h=new ze("ENVIRONMENT_INITIALIZER"),hw=new ze("INJECTOR",-1),dw=new ze("INJECTOR_DEF_TYPES");class fw{get(e,t=Ul){if(t===Ul){const n=new Error(`NullInjectorError: No provider for ${Et(e)}!`);throw n.name="NullInjectorError",n}return t}}function UP(...i){return{\u0275providers:pw(0,i),\u0275fromNgModule:!0}}function pw(i,...e){const t=[],n=new Set;let r;return $s(e,s=>{const o=s;Jg(o,t,[],n)&&(r||(r=[]),r.push(o))}),void 0!==r&&gw(r,t),t}function gw(i,e){for(let t=0;t<i.length;t++){const{providers:r}=i[t];Yg(r,s=>{e.push(s)})}}function Jg(i,e,t,n){if(!(i=Re(i)))return!1;let r=null,s=g1(i);const o=!s&&bt(i);if(s||o){if(o&&!o.standalone)return!1;r=i}else{const l=i.ngModule;if(s=g1(l),!s)return!1;r=l}const a=n.has(r);if(o){if(a)return!1;if(n.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)Jg(c,e,t,n)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;n.add(r);try{$s(s.imports,u=>{Jg(u,e,t,n)&&(c||(c=[]),c.push(u))})}finally{}void 0!==c&&gw(c,e)}if(!a){const c=Hs(r)||(()=>new r);e.push({provide:r,useFactory:c,deps:vt},{provide:dw,useValue:r,multi:!0},{provide:_h,useValue:()=>Ee(r),multi:!0})}const l=s.providers;null==l||a||Yg(l,u=>{e.push(u)})}}return r!==i&&void 0!==i.providers}function Yg(i,e){for(let t of i)Gp(t)&&(t=t.\u0275providers),Array.isArray(t)?Yg(t,e):e(t)}const VP=Dt({provide:String,useValue:Dt});function Zg(i){return null!==i&&"object"==typeof i&&VP in i}function Js(i){return"function"==typeof i}const Xg=new ze("Set Injector scope."),xh={},GP={};let Kg;function wh(){return void 0===Kg&&(Kg=new fw),Kg}class Pr{}class vw extends Pr{constructor(e,t,n,r){super(),this.parent=t,this.source=n,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,em(e,o=>this.processProvider(o)),this.records.set(hw,la(void 0,this)),r.has("environment")&&this.records.set(Pr,la(void 0,this));const s=this.records.get(Xg);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(dw.multi,vt,Pe.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}runInContext(e){this.assertNotDestroyed();const t=Go(this),n=Ti(void 0);try{return e()}finally{Go(t),Ti(n)}}get(e,t=Ul,n=Pe.Default){this.assertNotDestroyed(),n=Gu(n);const r=Go(this),s=Ti(void 0);try{if(!(n&Pe.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function JP(i){return"function"==typeof i||"object"==typeof i&&i instanceof ze}(e)&&Uu(e);a=l&&this.injectableDefInScope(l)?la(Qg(e),xh):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(n&Pe.Self?wh():this.parent).get(e,t=n&Pe.Optional&&t===Ul?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Hu]=o[Hu]||[]).unshift(Et(e)),r)throw o;return function mI(i,e,t,n){const r=i[Hu];throw e[v1]&&r.unshift(e[v1]),i.message=function yI(i,e,t,n=null){i=i&&"\n"===i.charAt(0)&&"\u0275"==i.charAt(1)?i.slice(2):i;let r=Et(e);if(Array.isArray(e))r=e.map(Et).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Et(a)))}r=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${r}]: ${i.replace(dI,"\n  ")}`}("\n"+i.message,r,t,n),i.ngTokenPath=r,i[Hu]=null,i}(o,e,"R3InjectorError",this.source)}throw o}finally{Ti(s),Go(r)}}resolveInjectorInitializers(){const e=Go(this),t=Ti(void 0);try{const n=this.get(_h.multi,vt,Pe.Self);for(const r of n)r()}finally{Go(e),Ti(t)}}toString(){const e=[],t=this.records;for(const n of t.keys())e.push(Et(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new he(205,!1)}processProvider(e){let t=Js(e=Re(e))?e:Re(e&&e.provide);const n=function $P(i){return Zg(i)?la(void 0,i.useValue):la(function _w(i,e,t){let n;if(Js(i)){const r=Re(i);return Hs(r)||Qg(r)}if(Zg(i))n=()=>Re(i.useValue);else if(function yw(i){return!(!i||!i.useFactory)}(i))n=()=>i.useFactory(...qp(i.deps||[]));else if(function mw(i){return!(!i||!i.useExisting)}(i))n=()=>Ee(Re(i.useExisting));else{const r=Re(i&&(i.useClass||i.provide));if(!function jP(i){return!!i.deps}(i))return Hs(r)||Qg(r);n=()=>new r(...qp(i.deps))}return n}(i),xh)}(e);if(Js(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=la(void 0,xh,!0),r.factory=()=>qp(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,n)}hydrate(e,t){return t.value===xh&&(t.value=GP,t.value=t.factory()),"object"==typeof t.value&&t.value&&function qP(i){return null!==i&&"object"==typeof i&&"function"==typeof i.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Re(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}}function Qg(i){const e=Uu(i),t=null!==e?e.factory:Hs(i);if(null!==t)return t;if(i instanceof ze)throw new he(204,!1);if(i instanceof Function)return function WP(i){const e=i.length;if(e>0)throw function Kl(i,e){const t=[];for(let n=0;n<i;n++)t.push(e);return t}(e,"?"),new he(204,!1);const t=function aI(i){const e=i&&(i[Vu]||i[m1]);if(e){const t=function lI(i){if(i.hasOwnProperty("name"))return i.name;const e=(""+i).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(i);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(i);return null!==t?()=>t.factory(i):()=>new i}(i);throw new he(204,!1)}function la(i,e,t=!1){return{factory:i,value:e,multi:t?[]:void 0}}function em(i,e){for(const t of i)Array.isArray(t)?em(t,e):t&&Gp(t)?em(t.\u0275providers,e):e(t)}class YP{}class xw{}class XP{resolveComponentFactory(e){throw function ZP(i){const e=Error(`No component factory found for ${Et(i)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=i,e}(e)}}let cc=(()=>{class i{}return i.NULL=new XP,i})();function KP(){return ca(Tn(),K())}function ca(i,e){return new cs(mi(i,e))}let cs=(()=>{class i{constructor(t){this.nativeElement=t}}return i.__NG_ELEMENT_ID__=KP,i})();class bw{}let tL=(()=>{class i{}return i.\u0275prov=Ve({token:i,providedIn:"root",factory:()=>null}),i})();class Mh{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const nL=new Mh("15.0.2"),tm={};function im(i){return i.ngOriginalError}class ua{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&im(e);for(;t&&im(t);)t=im(t);return t||null}}function rm(i){return i.ownerDocument.defaultView}function Lr(i){return i instanceof Function?i():i}function Sw(i,e,t){let n=i.length;for(;;){const r=i.indexOf(e,t);if(-1===r)return r;if(0===r||i.charCodeAt(r-1)<=32){const s=e.length;if(r+s===n||i.charCodeAt(r+s)<=32)return r}t=r+1}}const Cw="ng-template";function dL(i,e,t){let n=0;for(;n<i.length;){let r=i[n++];if(t&&"class"===r){if(r=i[n],-1!==Sw(r.toLowerCase(),e,0))return!0}else if(1===r){for(;n<i.length&&"string"==typeof(r=i[n++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function Dw(i){return 4===i.type&&i.value!==Cw}function fL(i,e,t){return e===(4!==i.type||t?i.value:Cw)}function pL(i,e,t){let n=4;const r=i.attrs||[],s=function yL(i){for(let e=0;e<i.length;e++)if(Y1(i[e]))return e;return i.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&n){if(n=2|1&n,""!==l&&!fL(i,l,t)||""===l&&1===e.length){if(Ji(n))return!1;o=!0}}else{const c=8&n?l:e[++a];if(8&n&&null!==i.attrs){if(!dL(i.attrs,c,t)){if(Ji(n))return!1;o=!0}continue}const h=gL(8&n?"class":l,r,Dw(i),t);if(-1===h){if(Ji(n))return!1;o=!0;continue}if(""!==c){let d;d=h>s?"":r[h+1].toLowerCase();const f=8&n?d:null;if(f&&-1!==Sw(f,c,0)||2&n&&c!==d){if(Ji(n))return!1;o=!0}}}}else{if(!o&&!Ji(n)&&!Ji(l))return!1;if(o&&Ji(l))continue;o=!1,n=l|1&n}}return Ji(n)||o}function Ji(i){return 0==(1&i)}function gL(i,e,t,n){if(null===e)return-1;let r=0;if(n||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===i)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function vL(i,e){let t=i.indexOf(4);if(t>-1)for(t++;t<i.length;){const n=i[t];if("number"==typeof n)return-1;if(n===e)return t;t++}return-1}(e,i)}function Ew(i,e,t=!1){for(let n=0;n<e.length;n++)if(pL(i,e[n],t))return!0;return!1}function Aw(i,e){return i?":not("+e.trim()+")":e}function xL(i){let e=i[0],t=1,n=2,r="",s=!1;for(;t<i.length;){let o=i[t];if("string"==typeof o)if(2&n){const a=i[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&n?r+="."+o:4&n&&(r+=" "+o);else""!==r&&!Ji(o)&&(e+=Aw(s,r),r=""),n=o,s=s||!Ji(n);t++}return""!==r&&(e+=Aw(s,r)),e}const je={};function Lw(i,e=null,t=null,n){const r=Nw(i,e,t,n);return r.resolveInjectorInitializers(),r}function Nw(i,e=null,t=null,n,r=new Set){const s=[t||vt,UP(i)];return n=n||("object"==typeof i?void 0:Et(i)),new vw(s,e||wh(),n||null,r)}let Yi=(()=>{class i{static create(t,n){if(Array.isArray(t))return Lw({name:""},n,t,"");{const r=t.name??"";return Lw({name:r},t.parent,t.providers,r)}}}return i.THROW_IF_NOT_FOUND=Ul,i.NULL=new fw,i.\u0275prov=Ve({token:i,providedIn:"any",factory:()=>Ee(hw)}),i.__NG_ELEMENT_ID__=-1,i})();function Ne(i,e=Pe.Default){const t=K();return null===t?Ee(i,e):rx(Tn(),t,Re(i),e)}function cm(){throw new Error("invalid")}function Vw(i,e){const t=i.contentQueries;if(null!==t)for(let n=0;n<t.length;n+=2){const r=t[n],s=t[n+1];if(-1!==s){const o=i.data[s];og(r),o.contentQueries(2,e[s],s)}}}function Ch(i,e,t,n,r,s,o,a,l,c,u){const h=e.blueprint.slice();return h[0]=r,h[2]=76|n,(null!==u||i&&1024&i[2])&&(h[2]|=1024),L1(h),h[3]=h[15]=i,h[8]=t,h[10]=o||i&&i[10],h[11]=a||i&&i[11],h[12]=l||i&&i[12]||null,h[9]=c||i&&i[9]||null,h[6]=s,h[20]=function UR(){return BR++}(),h[21]=u,h[16]=2==e.type?i[16]:h,h}function fa(i,e,t,n,r){let s=i.data[e];if(null===s)s=function um(i,e,t,n,r){const s=F1(),o=ng(),l=i.data[e]=function qL(i,e,t,n,r,s){return{type:t,index:n,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,n,r);return null===i.firstChild&&(i.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(i,e,t,n,r),function $I(){return He.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=n,s.attrs=r;const o=function ql(){const i=He.lFrame,e=i.currentTNode;return i.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return hr(s,!0),s}function uc(i,e,t,n){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(n),i.blueprint.push(n),i.data.push(null);return r}function hm(i,e,t){ag(e);try{const n=i.viewQuery;null!==n&&wm(1,n,t);const r=i.template;null!==r&&Hw(i,e,r,1,t),i.firstCreatePass&&(i.firstCreatePass=!1),i.staticContentQueries&&Vw(i,e),i.staticViewQueries&&wm(2,i.viewQuery,t);const s=i.components;null!==s&&function WL(i,e){for(let t=0;t<e.length;t++)d4(i,e[t])}(e,s)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{e[2]&=-5,lg()}}function Dh(i,e,t,n){const r=e[2];if(128!=(128&r)){ag(e);try{L1(e),function z1(i){return He.lFrame.bindingIndex=i}(i.bindingStartIndex),null!==t&&Hw(i,e,t,2,n);const o=3==(3&r);if(o){const c=i.preOrderCheckHooks;null!==c&&th(e,c,null)}else{const c=i.preOrderHooks;null!==c&&nh(e,c,0,null),cg(e,0)}if(function u4(i){for(let e=Rg(i);null!==e;e=Pg(e)){if(!e[2])continue;const t=e[9];for(let n=0;n<t.length;n++){const r=t[n],s=r[3];0==(512&r[2])&&tg(s,1),r[2]|=512}}}(e),function c4(i){for(let e=Rg(i);null!==e;e=Pg(e))for(let t=10;t<e.length;t++){const n=e[t],r=n[1];Qu(n)&&Dh(r,n,r.template,n[8])}}(e),null!==i.contentQueries&&Vw(i,e),o){const c=i.contentCheckHooks;null!==c&&th(e,c)}else{const c=i.contentHooks;null!==c&&nh(e,c,1),cg(e,1)}!function HL(i,e){const t=i.hostBindingOpCodes;if(null!==t)try{for(let n=0;n<t.length;n++){const r=t[n];if(r<0)Ws(~r);else{const s=r,o=t[++n],a=t[++n];jI(o,s),a(2,e[s])}}}finally{Ws(-1)}}(i,e);const a=i.components;null!==a&&function GL(i,e){for(let t=0;t<e.length;t++)h4(i,e[t])}(e,a);const l=i.viewQuery;if(null!==l&&wm(2,l,n),o){const c=i.viewCheckHooks;null!==c&&th(e,c)}else{const c=i.viewHooks;null!==c&&nh(e,c,2),cg(e,2)}!0===i.firstUpdatePass&&(i.firstUpdatePass=!1),e[2]&=-41,512&e[2]&&(e[2]&=-513,tg(e[3],-1))}finally{lg()}}}function Hw(i,e,t,n,r){const s=function qn(){return He.lFrame.selectedIndex}(),o=2&n;try{Ws(-1),o&&e.length>22&&function Tw(i,e,t,n){if(!n)if(3==(3&e[2])){const s=i.preOrderCheckHooks;null!==s&&th(e,s,t)}else{const s=i.preOrderHooks;null!==s&&nh(e,s,0,t)}Ws(t)}(i,e,22,!1),t(n,r)}finally{Ws(s)}}function dm(i,e,t){if(Xp(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=i.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}function Gw(i){const e=i.tView;return null===e||e.incompleteFirstPass?i.tView=gm(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts):e}function gm(i,e,t,n,r,s,o,a,l,c){const u=22+n,h=u+r,d=function $L(i,e){const t=[];for(let n=0;n<e;n++)t.push(n<i?null:je);return t}(u,h),f="function"==typeof c?c():c;return d[1]={type:i,blueprint:d,template:t,queries:null,viewQuery:a,declTNode:e,data:d.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function $w(i,e,t,n){for(let r in i)if(i.hasOwnProperty(r)){t=null===t?{}:t;const s=i[r];null===n?jw(t,e,r,s):n.hasOwnProperty(r)&&jw(t,e,n[r],s)}return t}function jw(i,e,t,n){i.hasOwnProperty(t)?i[t].push(e,n):i[t]=[e,n]}function Jw(i,e,t,n,r,s){for(let c=0;c<n.length;c++)mg(oh(t,e),i,n[c].type);!function r4(i,e,t){i.flags|=1,i.directiveStart=e,i.directiveEnd=e+t,i.providerIndexes=e}(t,i.data.length,n.length);for(let c=0;c<n.length;c++){const u=n[c];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,l=uc(i,e,n.length,null);for(let c=0;c<n.length;c++){const u=n[c];t.mergedAttrs=Yl(t.mergedAttrs,u.hostAttrs),s4(i,t,e,l,u),i4(l,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const h=u.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((i.preOrderHooks||(i.preOrderHooks=[])).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(t.index),a=!0),l++}!function JL(i,e,t){const r=e.directiveEnd,s=i.data,o=e.attrs,a=[];let l=null,c=null;for(let u=e.directiveStart;u<r;u++){const h=s[u],d=t?t.get(h):null,p=d?d.outputs:null;l=$w(h.inputs,u,l,d?d.inputs:null),c=$w(h.outputs,u,c,p);const g=null===l||null===o||Dw(e)?null:l4(l,u,o);a.push(g)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}(i,t,s)}function Yw(i,e,t){const n=t.directiveStart,r=t.directiveEnd,s=t.index,o=function qI(){return He.lFrame.currentDirectiveIndex}();try{Ws(s);for(let a=n;a<r;a++){const l=i.data[a],c=e[a];rg(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&e4(l,c)}}finally{Ws(-1),rg(o)}}function e4(i,e){null!==i.hostBindings&&i.hostBindings(1,e)}function ym(i,e,t){e.componentOffset=t,(i.components||(i.components=[])).push(e.index)}function i4(i,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=i;qi(e)&&(t[""]=i)}}function s4(i,e,t,n,r){i.data[n]=r;const s=r.factory||(r.factory=Hs(r.type)),o=new Jl(s,qi(r),Ne);i.blueprint[n]=o,t[n]=o,function XL(i,e,t,n,r){const s=r.hostBindings;if(s){let o=i.hostBindingOpCodes;null===o&&(o=i.hostBindingOpCodes=[]);const a=~e.index;(function KL(i){let e=i.length;for(;e>0;){const t=i[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,n,s)}}(i,e,n,uc(i,t,r.hostVars,je),r)}function o4(i,e,t){const n=mi(e,i),r=Gw(t),s=i[10],o=Eh(i,Ch(i,r,null,t.onPush?32:16,n,e,s,s.createRenderer(n,t),null,null,null));i[e.index]=o}function a4(i,e,t,n,r,s){const o=s[e];if(null!==o){const a=n.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],h=o[l++];null!==a?n.setInput(t,h,c,u):t[u]=h}}}function l4(i,e,t){let n=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(i.hasOwnProperty(s)){null===n&&(n=[]);const o=i[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){n.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return n}function h4(i,e){const t=yi(e,i);if(Qu(t)){const n=t[1];48&t[2]?Dh(n,t,n.template,t[8]):t[5]>0&&_m(t)}}function _m(i){for(let n=Rg(i);null!==n;n=Pg(n))for(let r=10;r<n.length;r++){const s=n[r];if(Qu(s))if(512&s[2]){const o=s[1];Dh(o,s,o.template,s[8])}else s[5]>0&&_m(s)}const t=i[1].components;if(null!==t)for(let n=0;n<t.length;n++){const r=yi(t[n],i);Qu(r)&&r[5]>0&&_m(r)}}function d4(i,e){const t=yi(e,i),n=t[1];(function f4(i,e){for(let t=e.length;t<i.blueprint.length;t++)e.push(i.blueprint[t])})(n,t),hm(n,t,t[8])}function Eh(i,e){return i[13]?i[14][4]=e:i[13]=e,i[14]=e,e}function xm(i){for(;i;){i[2]|=32;const e=rc(i);if(MI(i)&&!e)return i;i=e}return null}function Ah(i,e,t,n=!0){const r=e[10];r.begin&&r.begin();try{Dh(i,e,i.template,t)}catch(o){throw n&&eb(e,o),o}finally{r.end&&r.end()}}function wm(i,e,t){og(0),e(i,t)}function Xw(i){return i[7]||(i[7]=[])}function Kw(i){return i.cleanup||(i.cleanup=[])}function eb(i,e){const t=i[9],n=t?t.get(ua,null):null;n&&n.handleError(e)}function bm(i,e,t,n,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=i.data[o];null!==c.setInput?c.setInput(l,r,n,a):l[a]=r}}function Th(i,e,t){let n=t?i.styles:null,r=t?i.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=Up(r,a):2==s&&(n=Up(n,a+": "+e[++o]+";"))}t?i.styles=n:i.stylesWithoutHost=n,t?i.classes=r:i.classesWithoutHost=r}function Ih(i,e,t,n,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&n.push(An(s)),ji(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&Ih(l[1],l,c,n)}const o=t.type;if(8&o)Ih(i,e,t.child,n);else if(32&o){const a=Ig(t,e);let l;for(;l=a();)n.push(l)}else if(16&o){const a=qx(e,t);if(Array.isArray(a))n.push(...a);else{const l=rc(e[16]);Ih(l[1],l,a,n,!0)}}t=r?t.projectionNext:t.next}return n}class hc{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return Ih(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(ji(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(Og(e,n),ch(t,n))}this._attachedToViewContainer=!1}zx(this._lView[1],this._lView)}onDestroy(e){!function Ww(i,e,t,n){const r=Xw(e);null===t?r.push(n):(r.push(t),i.firstCreatePass&&Kw(i).push(n,r.length-1))}(this._lView[1],this._lView,null,e)}markForCheck(){xm(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){Ah(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new he(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function nP(i,e){sc(i,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new he(902,!1);this._appRef=e}}class p4 extends hc{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Ah(e[1],e,e[8],!1)}checkNoChanges(){}get context(){return null}}class tb extends cc{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=bt(e);return new dc(t,this.ngModule)}}function nb(i){const e=[];for(let t in i)i.hasOwnProperty(t)&&e.push({propName:i[t],templateName:t});return e}class m4{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=Gu(n);const r=this.injector.get(e,tm,n);return r!==tm||t===tm?r:this.parentInjector.get(e,t,n)}}class dc extends xw{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function wL(i){return i.map(xL).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return nb(this.componentDef.inputs)}get outputs(){return nb(this.componentDef.outputs)}create(e,t,n,r){let s=(r=r||this.ngModule)instanceof Pr?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new m4(e,s):e,a=o.get(bw,null);if(null===a)throw new he(407,!1);const l=o.get(tL,null),c=a.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",h=n?function jL(i,e,t){return i.selectRootElement(e,t===lr.ShadowDom)}(c,n,this.componentDef.encapsulation):Ng(c,u,function g4(i){const e=i.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(u)),d=this.componentDef.onPush?288:272,f=gm(0,null,null,1,0,null,null,null,null,null),p=Ch(null,f,null,d,null,null,a,c,l,o,null);let g,m;ag(p);try{const y=this.componentDef;let _,v=null;y.findHostDirectiveDefs?(_=[],v=new Map,y.findHostDirectiveDefs(y,_,v),_.push(y)):_=[y];const x=function v4(i,e){const t=i[1];return i[22]=e,fa(t,22,2,"#host",null)}(p,h),b=function _4(i,e,t,n,r,s,o,a){const l=r[1];!function x4(i,e,t,n){for(const r of i)e.mergedAttrs=Yl(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(Th(e,e.mergedAttrs,!0),null!==t&&Zx(n,t,e))}(n,i,e,o);const c=s.createRenderer(e,t),u=Ch(r,Gw(t),null,t.onPush?32:16,r[i.index],i,s,c,a||null,null,null);return l.firstCreatePass&&ym(l,i,n.length-1),Eh(r,u),r[i.index]=u}(x,h,y,_,p,a,c);m=function P1(i,e){return i.data[e]}(f,22),h&&function b4(i,e,t,n){if(n)dg(i,t,["ng-version",nL.full]);else{const{attrs:r,classes:s}=function bL(i){const e=[],t=[];let n=1,r=2;for(;n<i.length;){let s=i[n];if("string"==typeof s)2===r?""!==s&&e.push(s,i[++n]):8===r&&t.push(s);else{if(!Ji(r))break;r=s}n++}return{attrs:e,classes:t}}(e.selectors[0]);r&&dg(i,t,r),s&&s.length>0&&Yx(i,t,s.join(" "))}}(c,y,h,n),void 0!==t&&function M4(i,e,t){const n=i.projection=[];for(let r=0;r<e.length;r++){const s=t[r];n.push(null!=s?Array.from(s):null)}}(m,this.ngContentSelectors,t),g=function w4(i,e,t,n,r,s){const o=Tn(),a=r[1],l=mi(o,r);Jw(a,r,o,t,null,n);for(let u=0;u<t.length;u++)Fn(Qo(r,a,o.directiveStart+u,o),r);Yw(a,r,o),l&&Fn(l,r);const c=Qo(r,a,o.directiveStart+o.componentOffset,o);if(i[8]=r[8]=c,null!==s)for(const u of s)u(c,e);return dm(a,o,i),c}(b,y,_,v,p,[S4]),hm(f,p,null)}finally{lg()}return new y4(this.componentType,g,ca(m,p),p,m)}}class y4 extends YP{constructor(e,t,n,r,s){super(),this.location=n,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new p4(r),this.componentType=e}setInput(e,t){const n=this._tNode.inputs;let r;if(null!==n&&(r=n[e])){const s=this._rootLView;bm(s[1],s,r,e,t),function qw(i,e){const t=yi(e,i);16&t[2]||(t[2]|=32)}(s,this._tNode.index)}}get injector(){return new ea(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function S4(){const i=Tn();eh(K()[1],i)}function Dm(i,e,t,n,r){const o=r?"class":"style";bm(i,t,e.inputs[o],o,n)}function gt(i,e,t,n){const r=K(),s=ut(),o=22+i,a=r[11],l=r[o]=Ng(a,e,function QI(){return He.lFrame.currentNamespace}()),c=s.firstCreatePass?function H4(i,e,t,n,r,s,o){const a=e.consts,c=fa(e,i,2,r,as(a,s));return function mm(i,e,t,n){let r=!1;if(O1()){const s=null===n?null:{"":-1},o=function t4(i,e){const t=i.directiveRegistry;let n=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(Ew(e,o.selectors,!1))if(n||(n=[]),qi(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),n.unshift(...a,o),ym(i,e,a.length)}else n.unshift(o),ym(i,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,n,r),n.push(o)}return null===n?null:[n,r]}(i,t);let a,l;null===o?a=l=null:[a,l]=o,null!==a&&(r=!0,Jw(i,e,t,a,s,l)),s&&function n4(i,e,t){if(e){const n=i.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new he(-301,!1);n.push(e[r],s)}}}(t,n,s)}return t.mergedAttrs=Yl(t.mergedAttrs,t.attrs),r}(e,t,c,as(a,o)),null!==c.attrs&&Th(c,c.attrs,!1),null!==c.mergedAttrs&&Th(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,n):s.data[o];return hr(c,!0),Zx(a,l,c),32!=(32&c.flags)&&ph(s,r,l,c),0===function kI(){return He.lFrame.elementDepthCount}()&&Fn(l,r),function zI(){He.lFrame.elementDepthCount++}(),Xu(c)&&(function fm(i,e,t){!O1()||(function QL(i,e,t,n){const r=t.directiveStart,s=t.directiveEnd;i.firstCreatePass||oh(t,e),Fn(n,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=i.data[a],c=qi(l);c&&o4(e,t,l);const u=Qo(e,i,a,t);Fn(u,e),null!==o&&a4(0,a-r,u,l,0,o),c&&(yi(t.index,e)[8]=u)}}(i,e,t,mi(t,e)),64==(64&t.flags)&&Yw(i,e,t))}(s,r,c),dm(s,c,r)),null!==n&&function pm(i,e,t=mi){const n=e.localNames;if(null!==n){let r=e.index+1;for(let s=0;s<n.length;s+=2){const o=n[s+1],a=-1===o?t(e,i):i[o];i[r++]=a}}}(r,c),gt}function Ut(){let i=Tn();ng()?function ig(){He.lFrame.isParent=!1}():(i=i.parent,hr(i,!1));const e=i;!function BI(){He.lFrame.elementDepthCount--}();const t=ut();return t.firstCreatePass&&(eh(t,i),Xp(i)&&t.queries.elementEnd(i)),null!=e.classesWithoutHost&&function rR(i){return 0!=(8&i.flags)}(e)&&Dm(t,e,K(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function sR(i){return 0!=(16&i.flags)}(e)&&Dm(t,e,K(),e.stylesWithoutHost,!1),Ut}function hn(i,e,t,n){return gt(i,e,t,n),Ut(),hn}function Lh(i){return!!i&&"function"==typeof i.then}const xb=function _b(i){return!!i&&"function"==typeof i.subscribe};function gc(i,e,t,n){const r=K(),s=ut(),o=Tn();return function bb(i,e,t,n,r,s,o){const a=Xu(n),c=i.firstCreatePass&&Kw(i),u=e[8],h=Xw(e);let d=!0;if(3&n.type||o){const g=mi(n,e),m=o?o(g):g,y=h.length,_=o?x=>o(An(x[n.index])):n.index;let v=null;if(!o&&a&&(v=function $4(i,e,t,n){const r=i.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===n){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(i,e,r,n.index)),null!==v)(v.__ngLastListenerFn__||v).__ngNextListenerFn__=s,v.__ngLastListenerFn__=s,d=!1;else{s=Sb(n,e,u,s,!1);const x=t.listen(m,r,s);h.push(s,x),c&&c.push(r,_,y,y+1)}}else s=Sb(n,e,u,s,!1);const f=n.outputs;let p;if(d&&null!==f&&(p=f[r])){const g=p.length;if(g)for(let m=0;m<g;m+=2){const b=e[p[m]][p[m+1]].subscribe(s),S=h.length;h.push(s,b),c&&c.push(r,n.index,S,-(S+1))}}}(s,r,r[11],o,i,e,n),gc}function Mb(i,e,t,n){try{return!1!==t(n)}catch(r){return eb(i,r),!1}}function Sb(i,e,t,n,r){return function s(o){if(o===Function)return n;xm(i.componentOffset>-1?yi(i.index,e):e);let l=Mb(e,0,n,o),c=s.__ngNextListenerFn__;for(;c;)l=Mb(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function zn(i,e=""){const t=K(),n=ut(),r=i+22,s=n.firstCreatePass?fa(n,r,1,e,null):n.data[r],o=t[r]=function Lg(i,e){return i.createText(e)}(t[11],e);ph(n,t,o,s),hr(s,!1)}const Ca="en-US";let yM=Ca;class Da{}class GM{}class WM extends Da{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new tb(this);const n=pi(e);this._bootstrapComponents=Lr(n.bootstrap),this._r3Injector=Nw(e,t,[{provide:Da,useValue:this},{provide:cc,useValue:this.componentFactoryResolver}],Et(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Vm extends GM{constructor(e){super(),this.moduleType=e}create(e){return new WM(this.moduleType,e)}}class kN extends Da{constructor(e,t,n){super(),this.componentFactoryResolver=new tb(this),this.instance=null;const r=new vw([...e,{provide:Da,useValue:this},{provide:cc,useValue:this.componentFactoryResolver}],t||wh(),n,new Set(["environment"]));this.injector=r,r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function Uh(i,e,t=null){return new kN(i,e,t).injector}let zN=(()=>{class i{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t.id)){const n=pw(0,t.type),r=n.length>0?Uh([n],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t.id,r)}return this.cachedInjectors.get(t.id)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}}return i.\u0275prov=Ve({token:i,providedIn:"environment",factory:()=>new i(Ee(Pr))}),i})();function $M(i){i.getStandaloneInjector=e=>e.get(zN).getOrCreateStandaloneInjector(i)}function Gm(i){return e=>{setTimeout(i,void 0,e)}}const Yn=class uO extends Mr{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){let r=e,s=t||(()=>null),o=n;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=Gm(s),r&&(r=Gm(r)),o&&(o=Gm(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof di&&e.add(a),a}};let Ki=(()=>{class i{}return i.__NG_ELEMENT_ID__=gO,i})();function gO(){return function sS(i,e){let t;const n=e[i.index];if(ji(n))t=n;else{let r;if(8&i.type)r=An(n);else{const s=e[11];r=s.createComment("");const o=mi(i,e);js(s,fh(s,o),r,function cP(i,e){return i.nextSibling(e)}(s,o),!1)}e[i.index]=t=function Zw(i,e,t,n){return[i,!0,!1,e,null,0,n,t,null,null]}(n,e,r,i),Eh(e,t)}return new iS(t,i,e)}(Tn(),K())}const mO=Ki,iS=class extends mO{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return ca(this._hostTNode,this._hostLView)}get injector(){return new ea(this._hostTNode,this._hostLView)}get parentInjector(){const e=gg(this._hostTNode,this._hostLView);if(K1(e)){const t=rh(e,this._hostLView),n=ih(e);return new ea(t[1].data[n+8],t)}return new ea(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=rS(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,n){let r,s;"number"==typeof n?r=n:null!=n&&(r=n.index,s=n.injector);const o=e.createEmbeddedView(t||{},s);return this.insert(o,r),o}createComponent(e,t,n,r,s){const o=e&&!function Xl(i){return"function"==typeof i}(e);let a;if(o)a=t;else{const h=t||{};a=h.index,n=h.injector,r=h.projectableNodes,s=h.environmentInjector||h.ngModuleRef}const l=o?e:new dc(bt(e)),c=n||this.parentInjector;if(!s&&null==l.ngModule){const d=(o?c:this.parentInjector).get(Pr,null);d&&(s=d)}const u=l.create(c,r,void 0,s);return this.insert(u.hostView,a),u}insert(e,t){const n=e._lView,r=n[1];if(function FI(i){return ji(i[3])}(n)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const h=n[3],d=new iS(h,h[6],h[3]);d.detach(d.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function rP(i,e,t,n){const r=10+n,s=t.length;n>0&&(t[r-1][4]=e),n<s-10?(e[4]=t[r],hx(t,10+n,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function sP(i,e){const t=i[9];e[16]!==e[3][3][16]&&(i[2]=!0),null===t?i[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(i),e[2]|=64}(r,n,o,s);const a=zg(s,o),l=n[11],c=fh(l,o[7]);return null!==c&&function tP(i,e,t,n,r,s){n[0]=r,n[6]=e,sc(i,n,t,1,r,s)}(r,o[6],l,n,c,a),e.attachToViewContainerRef(),hx($m(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=rS(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=Og(this._lContainer,t);n&&(ch($m(this._lContainer),t),zx(n[1],n))}detach(e){const t=this._adjustIndex(e,-1),n=Og(this._lContainer,t);return n&&null!=ch($m(this._lContainer),t)?new hc(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function rS(i){return i[8]}function $m(i){return i[8]||(i[8]=[])}function Gh(...i){}const Wh=new ze("Application Initializer");let $h=(()=>{class i{constructor(t){this.appInits=t,this.resolve=Gh,this.reject=Gh,this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],n=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(Lh(s))t.push(s);else if(xb(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{n()}).catch(r=>{this.reject(r)}),0===t.length&&n(),this.initialized=!0}}return i.\u0275fac=function(t){return new(t||i)(Ee(Wh,8))},i.\u0275prov=Ve({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Cc=new ze("AppId",{providedIn:"root",factory:function PS(){return`${t0()}${t0()}${t0()}`}});function t0(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const LS=new ze("Platform Initializer"),NS=new ze("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),OS=new ze("appBootstrapListener");let jO=(()=>{class i{log(t){console.log(t)}warn(t){console.warn(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ve({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();const Fr=new ze("LocaleId",{providedIn:"root",factory:()=>ct(Fr,Pe.Optional|Pe.SkipSelf)||function qO(){return typeof $localize<"u"&&$localize.locale||Ca}()});class YO{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let n0=(()=>{class i{compileModuleSync(t){return new Vm(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const n=this.compileModuleSync(t),s=Lr(pi(t).declarations).reduce((o,a)=>{const l=bt(a);return l&&o.push(new dc(l)),o},[]);return new YO(n,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ve({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const KO=(()=>Promise.resolve(0))();function r0(i){typeof Zone>"u"?KO.then(()=>{i&&i.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",i)}class en{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Yn(!1),this.onMicrotaskEmpty=new Yn(!1),this.onStable=new Yn(!1),this.onError=new Yn(!1),typeof Zone>"u")throw new he(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&t,r.shouldCoalesceRunChangeDetection=n,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function QO(){let i=It.requestAnimationFrame,e=It.cancelAnimationFrame;if(typeof Zone<"u"&&i&&e){const t=i[Zone.__symbol__("OriginalDelegate")];t&&(i=t);const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function nF(i){const e=()=>{!function tF(i){i.isCheckStableRunning||-1!==i.lastRequestAnimationFrameId||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(It,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,o0(i),i.isCheckStableRunning=!0,s0(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),o0(i))}(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,r,s,o,a)=>{try{return zS(i),t.invokeTask(r,s,o,a)}finally{(i.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||i.shouldCoalesceRunChangeDetection)&&e(),BS(i)}},onInvoke:(t,n,r,s,o,a,l)=>{try{return zS(i),t.invoke(r,s,o,a,l)}finally{i.shouldCoalesceRunChangeDetection&&e(),BS(i)}},onHasTask:(t,n,r,s)=>{t.hasTask(r,s),n===r&&("microTask"==s.change?(i._hasPendingMicrotasks=s.microTask,o0(i),s0(i)):"macroTask"==s.change&&(i.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,n,r,s)=>(t.handleError(r,s),i.runOutsideAngular(()=>i.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!en.isInAngularZone())throw new he(909,!1)}static assertNotInAngularZone(){if(en.isInAngularZone())throw new he(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,eF,Gh,Gh);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const eF={};function s0(i){if(0==i._nesting&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function o0(i){i.hasPendingMicrotasks=!!(i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&-1!==i.lastRequestAnimationFrameId)}function zS(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function BS(i){i._nesting--,s0(i)}class iF{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Yn,this.onMicrotaskEmpty=new Yn,this.onStable=new Yn,this.onError=new Yn}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,r){return e.apply(t,n)}}const US=new ze(""),jh=new ze("");let c0,a0=(()=>{class i{constructor(t,n,r){this._ngZone=t,this.registry=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,c0||(function rF(i){c0=i}(r),r.addToWindow(n)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{en.assertNotInAngularZone(),r0(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())r0(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(n=>!n.updateCb||!n.updateCb(t)||(clearTimeout(n.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,n,r){let s=-1;n&&n>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},n)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,n,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,n,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,n,r){return[]}}return i.\u0275fac=function(t){return new(t||i)(Ee(en),Ee(l0),Ee(jh))},i.\u0275prov=Ve({token:i,factory:i.\u0275fac}),i})(),l0=(()=>{class i{constructor(){this._applications=new Map}registerApplication(t,n){this._applications.set(t,n)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,n=!0){return c0?.findTestabilityInTree(this,t,n)??null}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ve({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})(),hs=null;const VS=new ze("AllowMultipleToken"),u0=new ze("PlatformDestroyListeners");class HS{constructor(e,t){this.name=e,this.token=t}}function WS(i,e,t=[]){const n=`Platform: ${e}`,r=new ze(n);return(s=[])=>{let o=h0();if(!o||o.injector.get(VS,!1)){const a=[...t,...s,{provide:r,useValue:!0}];i?i(a):function aF(i){if(hs&&!hs.get(VS,!1))throw new he(400,!1);hs=i;const e=i.get(jS);(function GS(i){const e=i.get(LS,null);e&&e.forEach(t=>t())})(i)}(function $S(i=[],e){return Yi.create({name:e,providers:[{provide:Xg,useValue:"platform"},{provide:u0,useValue:new Set([()=>hs=null])},...i]})}(a,n))}return function cF(i){const e=h0();if(!e)throw new he(401,!1);return e}()}}function h0(){return hs?.get(jS)??null}let jS=(()=>{class i{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,n){const r=function JS(i,e){let t;return t="noop"===i?new iF:("zone.js"===i?void 0:i)||new en(e),t}(n?.ngZone,function qS(i){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!i||!i.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!i||!i.ngZoneRunCoalescing)||!1}}(n)),s=[{provide:en,useValue:r}];return r.run(()=>{const o=Yi.create({providers:s,parent:this.injector,name:t.moduleType.name}),a=t.create(o),l=a.injector.get(ua,null);if(!l)throw new he(402,!1);return r.runOutsideAngular(()=>{const c=r.onError.subscribe({next:u=>{l.handleError(u)}});a.onDestroy(()=>{Jh(this._modules,a),c.unsubscribe()})}),function YS(i,e,t){try{const n=t();return Lh(n)?n.catch(r=>{throw e.runOutsideAngular(()=>i.handleError(r)),r}):n}catch(n){throw e.runOutsideAngular(()=>i.handleError(n)),n}}(l,r,()=>{const c=a.injector.get($h);return c.runInitializers(),c.donePromise.then(()=>(function vM(i){Ai(i,"Expected localeId to be defined"),"string"==typeof i&&(yM=i.toLowerCase().replace(/_/g,"-"))}(a.injector.get(Fr,Ca)||Ca),this._moduleDoBootstrap(a),a))})})}bootstrapModule(t,n=[]){const r=ZS({},n);return function sF(i,e,t){const n=new Vm(t);return Promise.resolve(n)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const n=t.injector.get(qh);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>n.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new he(403,!1);t.instance.ngDoBootstrap(n)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new he(404,!1);this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n());const t=this._injector.get(u0,null);t&&(t.forEach(n=>n()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return i.\u0275fac=function(t){return new(t||i)(Ee(Yi))},i.\u0275prov=Ve({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();function ZS(i,e){return Array.isArray(e)?e.reduce(ZS,i):{...i,...e}}let qh=(()=>{class i{constructor(t,n,r){this._zone=t,this._injector=n,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new Kt(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),o=new Kt(a=>{let l;this._zone.runOutsideAngular(()=>{l=this._zone.onStable.subscribe(()=>{en.assertNotInAngularZone(),r0(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const c=this._zone.onUnstable.subscribe(()=>{en.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{l.unsubscribe(),c.unsubscribe()}});this.isStable=function KT(...i){const e=Bl(i),t=function $T(i,e){return"number"==typeof kp(i)?i.pop():e}(i,1/0),n=i;return n.length?1===n.length?ar(n[0]):Ho(t)(cn(n,e)):Cr}(s,o.pipe(function QT(i={}){const{connector:e=(()=>new Mr),resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:r=!0}=i;return s=>{let o,a,l,c=0,u=!1,h=!1;const d=()=>{a?.unsubscribe(),a=void 0},f=()=>{d(),o=l=void 0,u=h=!1},p=()=>{const g=o;f(),g?.unsubscribe()};return xn((g,m)=>{c++,!h&&!u&&d();const y=l=l??e();m.add(()=>{c--,0===c&&!h&&!u&&(a=zp(p,r))}),y.subscribe(m),!o&&c>0&&(o=new zl({next:_=>y.next(_),error:_=>{h=!0,d(),a=zp(f,t,_),y.error(_)},complete:()=>{u=!0,d(),a=zp(f,n),y.complete()}}),ar(g).subscribe(o))})(s)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,n){const r=t instanceof xw;if(!this._injector.get($h).done)throw!r&&function $o(i){const e=bt(i)||Ln(i)||Wn(i);return null!==e&&e.standalone}(t),new he(405,false);let o;o=r?t:this._injector.get(cc).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function oF(i){return i.isBoundToModule}(o)?void 0:this._injector.get(Da),c=o.create(Yi.NULL,[],n||o.selector,a),u=c.location.nativeElement,h=c.injector.get(US,null);return h?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),Jh(this.components,c),h?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new he(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const n=t;this._views.push(n),n.attachToAppRef(this)}detachView(t){const n=t;Jh(this._views,n),n.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(OS,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Jh(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new he(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return i.\u0275fac=function(t){return new(t||i)(Ee(en),Ee(Pr),Ee(ua))},i.\u0275prov=Ve({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function Jh(i,e){const t=i.indexOf(e);t>-1&&i.splice(t,1)}let d0=(()=>{class i{}return i.__NG_ELEMENT_ID__=hF,i})();function hF(i){return function dF(i,e,t){if(Zu(i)&&!t){const n=yi(i.index,e);return new hc(n,n)}return 47&i.type?new hc(e[16],e):null}(Tn(),K(),16==(16&i))}const CF=WS(null,"core",[]);let DF=(()=>{class i{constructor(t){}}return i.\u0275fac=function(t){return new(t||i)(Ee(qh))},i.\u0275mod=Us({type:i}),i.\u0275inj=ss({}),i})(),Kh=null;function ds(){return Kh}class TF{}const oi=new ze("DocumentToken");let v0=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ve({token:i,factory:function(){return function IF(){return Ee(aC)}()},providedIn:"platform"}),i})();const RF=new ze("Location Initialized");let aC=(()=>{class i extends v0{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ds().getBaseHref(this._doc)}onPopState(t){const n=ds().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",t,!1),()=>n.removeEventListener("popstate",t)}onHashChange(t){const n=ds().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",t,!1),()=>n.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,n,r){lC()?this._history.pushState(t,n,r):this.location.hash=r}replaceState(t,n,r){lC()?this._history.replaceState(t,n,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return i.\u0275fac=function(t){return new(t||i)(Ee(oi))},i.\u0275prov=Ve({token:i,factory:function(){return function PF(){return new aC(Ee(oi))}()},providedIn:"platform"}),i})();function lC(){return!!window.history.pushState}function _0(i,e){if(0==i.length)return e;if(0==e.length)return i;let t=0;return i.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?i+e.substring(1):1==t?i+e:i+"/"+e}function cC(i){const e=i.match(/#|\?|$/),t=e&&e.index||i.length;return i.slice(0,t-("/"===i[t-1]?1:0))+i.slice(t)}function zr(i){return i&&"?"!==i[0]?"?"+i:i}let eo=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ve({token:i,factory:function(){return ct(hC)},providedIn:"root"}),i})();const uC=new ze("appBaseHref");let hC=(()=>{class i extends eo{constructor(t,n){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??ct(oi).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return _0(this._baseHref,t)}path(t=!1){const n=this._platformLocation.pathname+zr(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${n}${r}`:n}pushState(t,n,r,s){const o=this.prepareExternalUrl(r+zr(s));this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){const o=this.prepareExternalUrl(r+zr(s));this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return i.\u0275fac=function(t){return new(t||i)(Ee(v0),Ee(uC,8))},i.\u0275prov=Ve({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),LF=(()=>{class i extends eo{constructor(t,n){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let n=this._platformLocation.hash;return null==n&&(n="#"),n.length>0?n.substring(1):n}prepareExternalUrl(t){const n=_0(this._baseHref,t);return n.length>0?"#"+n:n}pushState(t,n,r,s){let o=this.prepareExternalUrl(r+zr(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){let o=this.prepareExternalUrl(r+zr(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return i.\u0275fac=function(t){return new(t||i)(Ee(v0),Ee(uC,8))},i.\u0275prov=Ve({token:i,factory:i.\u0275fac}),i})(),x0=(()=>{class i{constructor(t){this._subject=new Yn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const n=this._locationStrategy.getBaseHref();this._baseHref=cC(dC(n)),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,n=""){return this.path()==this.normalize(t+zr(n))}normalize(t){return i.stripTrailingSlash(function OF(i,e){return i&&e.startsWith(i)?e.substring(i.length):e}(this._baseHref,dC(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,n="",r=null){this._locationStrategy.pushState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+zr(n)),r)}replaceState(t,n="",r=null){this._locationStrategy.replaceState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+zr(n)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)})),()=>{const n=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(n,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",n){this._urlChangeListeners.forEach(r=>r(t,n))}subscribe(t,n,r){return this._subject.subscribe({next:t,error:n,complete:r})}}return i.normalizeQueryParams=zr,i.joinWithSlash=_0,i.stripTrailingSlash=cC,i.\u0275fac=function(t){return new(t||i)(Ee(eo))},i.\u0275prov=Ve({token:i,factory:function(){return function NF(){return new x0(Ee(eo))}()},providedIn:"root"}),i})();function dC(i){return i.replace(/\/index.html$/,"")}let e8=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=Us({type:i}),i.\u0275inj=ss({}),i})();let r8=(()=>{class i{}return i.\u0275prov=Ve({token:i,providedIn:"root",factory:()=>new s8(Ee(oi),window)}),i})();class s8{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function o8(i,e){const t=i.getElementById(e)||i.getElementsByName(e)[0];if(t)return t;if("function"==typeof i.createTreeWalker&&i.body&&(i.body.createShadowRoot||i.body.attachShadow)){const n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT);let r=n.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=AC(this.window.history)||AC(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function AC(i){return Object.getOwnPropertyDescriptor(i,"scrollRestoration")}class N8 extends TF{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class F0 extends N8{static makeCurrent(){!function AF(i){Kh||(Kh=i)}(new F0)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function O8(){return Ic=Ic||document.querySelector("base"),Ic?Ic.getAttribute("href"):null}();return null==t?null:function F8(i){cd=cd||document.createElement("a"),cd.setAttribute("href",i);const e=cd.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Ic=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function v6(i,e){e=encodeURIComponent(e);for(const t of i.split(";")){const n=t.indexOf("="),[r,s]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let cd,Ic=null;const NC=new ze("TRANSITION_ID"),z8=[{provide:Wh,useFactory:function k8(i,e,t){return()=>{t.get($h).donePromise.then(()=>{const n=ds(),r=e.querySelectorAll(`style[ng-transition="${i}"]`);for(let s=0;s<r.length;s++)n.remove(r[s])})}},deps:[NC,oi,Yi],multi:!0}];let U8=(()=>{class i{build(){return new XMLHttpRequest}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ve({token:i,factory:i.\u0275fac}),i})();const ud=new ze("EventManagerPlugins");let hd=(()=>{class i{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,n,r){return this._findPluginFor(n).addEventListener(t,n,r)}addGlobalEventListener(t,n,r){return this._findPluginFor(n).addGlobalEventListener(t,n,r)}getZone(){return this._zone}_findPluginFor(t){const n=this._eventNameToPlugin.get(t);if(n)return n;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return i.\u0275fac=function(t){return new(t||i)(Ee(ud),Ee(en))},i.\u0275prov=Ve({token:i,factory:i.\u0275fac}),i})();class OC{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const r=ds().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,n)}}let FC=(()=>{class i{constructor(){this._stylesSet=new Set}addStyles(t){const n=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),n.add(r))}),this.onStylesAdded(n)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ve({token:i,factory:i.\u0275fac}),i})(),Rc=(()=>{class i extends FC{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,n,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(n.appendChild(o))})}addHost(t){const n=[];this._addStylesToHost(this._stylesSet,t,n),this._hostNodes.set(t,n)}removeHost(t){const n=this._hostNodes.get(t);n&&n.forEach(kC),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((n,r)=>{this._addStylesToHost(t,r,n)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(kC))}}return i.\u0275fac=function(t){return new(t||i)(Ee(oi))},i.\u0275prov=Ve({token:i,factory:i.\u0275fac}),i})();function kC(i){ds().remove(i)}const k0={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},z0=/%COMP%/g;function dd(i,e,t){for(let n=0;n<e.length;n++){let r=e[n];Array.isArray(r)?dd(i,r,t):(r=r.replace(z0,i),t.push(r))}return t}function UC(i){return e=>{if("__ngUnwrap__"===e)return i;!1===i(e)&&(e.preventDefault(),e.returnValue=!1)}}let B0=(()=>{class i{constructor(t,n,r){this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new U0(t)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;switch(n.encapsulation){case lr.Emulated:{let r=this.rendererByCompId.get(n.id);return r||(r=new j8(this.eventManager,this.sharedStylesHost,n,this.appId),this.rendererByCompId.set(n.id,r)),r.applyToHost(t),r}case 1:case lr.ShadowDom:return new q8(this.eventManager,this.sharedStylesHost,t,n);default:if(!this.rendererByCompId.has(n.id)){const r=dd(n.id,n.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(n.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return i.\u0275fac=function(t){return new(t||i)(Ee(hd),Ee(Rc),Ee(Cc))},i.\u0275prov=Ve({token:i,factory:i.\u0275fac}),i})();class U0{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(k0[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(HC(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(HC(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;const s=k0[r];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const r=k0[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(ri.DashCase|ri.Important)?e.style.setProperty(t,n,r&ri.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&ri.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,UC(n)):this.eventManager.addEventListener(e,t,UC(n))}}function HC(i){return"TEMPLATE"===i.tagName&&void 0!==i.content}class j8 extends U0{constructor(e,t,n,r){super(e),this.component=n;const s=dd(r+"-"+n.id,n.styles,[]);t.addStyles(s),this.contentAttr=function G8(i){return"_ngcontent-%COMP%".replace(z0,i)}(r+"-"+n.id),this.hostAttr=function W8(i){return"_nghost-%COMP%".replace(z0,i)}(r+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class q8 extends U0{constructor(e,t,n,r){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=dd(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let J8=(()=>{class i extends OC{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,r){return t.addEventListener(n,r,!1),()=>this.removeEventListener(t,n,r)}removeEventListener(t,n,r){return t.removeEventListener(n,r)}}return i.\u0275fac=function(t){return new(t||i)(Ee(oi))},i.\u0275prov=Ve({token:i,factory:i.\u0275fac}),i})();const GC=["alt","control","meta","shift"],Y8={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Z8={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let X8=(()=>{class i extends OC{constructor(t){super(t)}supports(t){return null!=i.parseEventName(t)}addEventListener(t,n,r){const s=i.parseEventName(n),o=i.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ds().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const n=t.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const s=i._normalizeKey(n.pop());let o="",a=n.indexOf("code");if(a>-1&&(n.splice(a,1),o="code."),GC.forEach(c=>{const u=n.indexOf(c);u>-1&&(n.splice(u,1),o+=c+".")}),o+=s,0!=n.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,n){let r=Y8[t.key]||t.key,s="";return n.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),GC.forEach(o=>{o!==r&&(0,Z8[o])(t)&&(s+=o+".")}),s+=r,s===n)}static eventCallback(t,n,r){return s=>{i.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>n(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return i.\u0275fac=function(t){return new(t||i)(Ee(oi))},i.\u0275prov=Ve({token:i,factory:i.\u0275fac}),i})();const tk=WS(CF,"browser",[{provide:NS,useValue:"browser"},{provide:LS,useValue:function K8(){F0.makeCurrent()},multi:!0},{provide:oi,useFactory:function ek(){return function yP(i){Hg=i}(document),document},deps:[]}]),jC=new ze(""),qC=[{provide:jh,useClass:class B8{addToWindow(e){It.getAngularTestability=(n,r=!0)=>{const s=e.findTestabilityInTree(n,r);if(null==s)throw new Error("Could not find testability for element.");return s},It.getAllAngularTestabilities=()=>e.getAllTestabilities(),It.getAllAngularRootElements=()=>e.getAllRootElements(),It.frameworkStabilizers||(It.frameworkStabilizers=[]),It.frameworkStabilizers.push(n=>{const r=It.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&n(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,n){return null==t?null:e.getTestability(t)??(n?ds().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:US,useClass:a0,deps:[en,l0,jh]},{provide:a0,useClass:a0,deps:[en,l0,jh]}],JC=[{provide:Xg,useValue:"root"},{provide:ua,useFactory:function Q8(){return new ua},deps:[]},{provide:ud,useClass:J8,multi:!0,deps:[oi,en,NS]},{provide:ud,useClass:X8,multi:!0,deps:[oi]},{provide:B0,useClass:B0,deps:[hd,Rc,Cc]},{provide:bw,useExisting:B0},{provide:FC,useExisting:Rc},{provide:Rc,useClass:Rc,deps:[oi]},{provide:hd,useClass:hd,deps:[ud,en]},{provide:class a8{},useClass:U8,deps:[]},[]];let nk=(()=>{class i{constructor(t){}static withServerTransition(t){return{ngModule:i,providers:[{provide:Cc,useValue:t.appId},{provide:NC,useExisting:Cc},z8]}}}return i.\u0275fac=function(t){return new(t||i)(Ee(jC,12))},i.\u0275mod=Us({type:i}),i.\u0275inj=ss({providers:[...JC,...qC],imports:[e8,DF]}),i})(),YC=(()=>{class i{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return i.\u0275fac=function(t){return new(t||i)(Ee(oi))},i.\u0275prov=Ve({token:i,factory:function(t){let n=null;return n=t?new t:function rk(){return new YC(Ee(oi))}(),n},providedIn:"root"}),i})();function Te(...i){return cn(i,Bl(i))}typeof window<"u"&&window;class nr extends Mr{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}const fd=kl(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:dk}=Array,{getPrototypeOf:fk,prototype:pk,keys:gk}=Object;const{isArray:vk}=Array;function KC(...i){const e=Bl(i),t=function WT(i){return Tt(kp(i))?i.pop():void 0}(i),{args:n,keys:r}=function mk(i){if(1===i.length){const e=i[0];if(dk(e))return{args:e,keys:null};if(function yk(i){return i&&"object"==typeof i&&fk(i)===pk}(e)){const t=gk(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}(i);if(0===n.length)return cn([],e);const s=new Kt(function bk(i,e,t=zs){return n=>{QC(e,()=>{const{length:r}=i,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)QC(e,()=>{const c=cn(i[l],e);let u=!1;c.subscribe(wn(n,h=>{s[l]=h,u||(u=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}(n,e,r?o=>function wk(i,e){return i.reduce((t,n,r)=>(t[n]=e[r],t),{})}(r,o):zs));return t?s.pipe(function xk(i){return lt(e=>function _k(i,e){return vk(e)?i(...e):i(e)}(i,e))}(t)):s}function QC(i,e,t){i?Sr(t,i,e):e()}function G0(...i){return function Mk(){return Ho(1)}()(cn(i,Bl(i)))}function e2(i){return new Kt(e=>{ar(i()).subscribe(e)})}function Pc(i,e){const t=Tt(i)?i:()=>i,n=r=>r.error(t());return new Kt(e?r=>e.schedule(n,0,r):n)}function W0(){return xn((i,e)=>{let t=null;i._refCount++;const n=wn(e,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(t=null);const r=i._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});i.subscribe(n),n.closed||(t=i.connect())})}class t2 extends Kt{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Y_(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new di;const t=this.getSubject();e.add(this.source.subscribe(wn(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=di.EMPTY)}return e}refCount(){return W0()(this)}}function yr(i,e){return xn((t,n)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&n.complete();t.subscribe(wn(n,l=>{r?.unsubscribe();let c=0;const u=s++;ar(i(l,u)).subscribe(r=wn(n,h=>n.next(e?e(l,h,u,c++):h),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Lc(i){return i<=0?()=>Cr:xn((e,t)=>{let n=0;e.subscribe(wn(t,r=>{++n<=i&&(t.next(r),i<=n&&t.complete())}))})}function ps(i,e){return xn((t,n)=>{let r=0;t.subscribe(wn(n,s=>i.call(e,s,r++)&&n.next(s)))})}function pd(i){return xn((e,t)=>{let n=!1;e.subscribe(wn(t,r=>{n=!0,t.next(r)},()=>{n||t.next(i),t.complete()}))})}function n2(i=Ck){return xn((e,t)=>{let n=!1;e.subscribe(wn(t,r=>{n=!0,t.next(r)},()=>n?t.complete():t.error(i())))})}function Ck(){return new fd}function gs(i,e){const t=arguments.length>=2;return n=>n.pipe(i?ps((r,s)=>i(r,s,n)):zs,Lc(1),t?pd(e):n2(()=>new fd))}function to(i,e){return Tt(e)?En(i,e,1):En(i,1)}function Bn(i,e,t){const n=Tt(i)||e||t?{next:i,error:e,complete:t}:i;return n?xn((r,s)=>{var o;null===(o=n.subscribe)||void 0===o||o.call(n);let a=!0;r.subscribe(wn(s,l=>{var c;null===(c=n.next)||void 0===c||c.call(n,l),s.next(l)},()=>{var l;a=!1,null===(l=n.complete)||void 0===l||l.call(n),s.complete()},l=>{var c;a=!1,null===(c=n.error)||void 0===c||c.call(n,l),s.error(l)},()=>{var l,c;a&&(null===(l=n.unsubscribe)||void 0===l||l.call(n)),null===(c=n.finalize)||void 0===c||c.call(n)}))}):zs}function ms(i){return xn((e,t)=>{let s,n=null,r=!1;n=e.subscribe(wn(t,void 0,void 0,o=>{s=ar(i(o,ms(i)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):r=!0})),r&&(n.unsubscribe(),n=null,s.subscribe(t))})}function Dk(i,e,t,n,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(wn(o,u=>{const h=c++;l=a?i(l,u,h):(a=!0,u),n&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function i2(i,e){return xn(Dk(i,e,arguments.length>=2,!0))}function $0(i){return i<=0?()=>Cr:xn((e,t)=>{let n=[];e.subscribe(wn(t,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(const r of n)t.next(r);t.complete()},void 0,()=>{n=null}))})}function r2(i,e){const t=arguments.length>=2;return n=>n.pipe(i?ps((r,s)=>i(r,s,n)):zs,$0(1),t?pd(e):n2(()=>new fd))}function j0(i){return xn((e,t)=>{try{e.subscribe(t)}finally{t.add(i)}})}const et="primary",Nc=Symbol("RouteTitle");class Tk{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Ta(i){return new Tk(i)}function Ik(i,e,t){const n=t.path.split("/");if(n.length>i.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<i.length))return null;const r={};for(let s=0;s<n.length;s++){const o=n[s],a=i[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function vr(i,e){const t=i?Object.keys(i):void 0,n=e?Object.keys(e):void 0;if(!t||!n||t.length!=n.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!s2(i[r],e[r]))return!1;return!0}function s2(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;const t=[...i].sort(),n=[...e].sort();return t.every((r,s)=>n[s]===r)}return i===e}function o2(i){return Array.prototype.concat.apply([],i)}function a2(i){return i.length>0?i[i.length-1]:null}function In(i,e){for(const t in i)i.hasOwnProperty(t)&&e(i[t],t)}function ys(i){return xb(i)?i:Lh(i)?cn(Promise.resolve(i)):Te(i)}const gd=!1,Pk={exact:function u2(i,e,t){if(!io(i.segments,e.segments)||!md(i.segments,e.segments,t)||i.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!i.children[n]||!u2(i.children[n],e.children[n],t))return!1;return!0},subset:h2},l2={exact:function Lk(i,e){return vr(i,e)},subset:function Nk(i,e){return Object.keys(e).length<=Object.keys(i).length&&Object.keys(e).every(t=>s2(i[t],e[t]))},ignored:()=>!0};function c2(i,e,t){return Pk[t.paths](i.root,e.root,t.matrixParams)&&l2[t.queryParams](i.queryParams,e.queryParams)&&!("exact"===t.fragment&&i.fragment!==e.fragment)}function h2(i,e,t){return d2(i,e,e.segments,t)}function d2(i,e,t,n){if(i.segments.length>t.length){const r=i.segments.slice(0,t.length);return!(!io(r,t)||e.hasChildren()||!md(r,t,n))}if(i.segments.length===t.length){if(!io(i.segments,t)||!md(i.segments,t,n))return!1;for(const r in e.children)if(!i.children[r]||!h2(i.children[r],e.children[r],n))return!1;return!0}{const r=t.slice(0,i.segments.length),s=t.slice(i.segments.length);return!!(io(i.segments,r)&&md(i.segments,r,n)&&i.children[et])&&d2(i.children[et],e,s,n)}}function md(i,e,t){return e.every((n,r)=>l2[t](i[r].parameters,n.parameters))}class no{constructor(e=new nt([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Ta(this.queryParams)),this._queryParamMap}toString(){return kk.serialize(this)}}class nt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,In(t,(n,r)=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return yd(this)}}class Oc{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Ta(this.parameters)),this._parameterMap}toString(){return g2(this)}}function io(i,e){return i.length===e.length&&i.every((t,n)=>t.path===e[n].path)}let Fc=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ve({token:i,factory:function(){return new q0},providedIn:"root"}),i})();class q0{parse(e){const t=new jk(e);return new no(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${kc(e.root,!0)}`,n=function Uk(i){const e=Object.keys(i).map(t=>{const n=i[t];return Array.isArray(n)?n.map(r=>`${vd(t)}=${vd(r)}`).join("&"):`${vd(t)}=${vd(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${n}${"string"==typeof e.fragment?`#${function zk(i){return encodeURI(i)}(e.fragment)}`:""}`}}const kk=new q0;function yd(i){return i.segments.map(e=>g2(e)).join("/")}function kc(i,e){if(!i.hasChildren())return yd(i);if(e){const t=i.children[et]?kc(i.children[et],!1):"",n=[];return In(i.children,(r,s)=>{s!==et&&n.push(`${s}:${kc(r,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function Fk(i,e){let t=[];return In(i.children,(n,r)=>{r===et&&(t=t.concat(e(n,r)))}),In(i.children,(n,r)=>{r!==et&&(t=t.concat(e(n,r)))}),t}(i,(n,r)=>r===et?[kc(i.children[et],!1)]:[`${r}:${kc(n,!1)}`]);return 1===Object.keys(i.children).length&&null!=i.children[et]?`${yd(i)}/${t[0]}`:`${yd(i)}/(${t.join("//")})`}}function f2(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function vd(i){return f2(i).replace(/%3B/gi,";")}function J0(i){return f2(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function _d(i){return decodeURIComponent(i)}function p2(i){return _d(i.replace(/\+/g,"%20"))}function g2(i){return`${J0(i.path)}${function Bk(i){return Object.keys(i).map(e=>`;${J0(e)}=${J0(i[e])}`).join("")}(i.parameters)}`}const Vk=/^[^\/()?;=#]+/;function xd(i){const e=i.match(Vk);return e?e[0]:""}const Hk=/^[^=?&#]+/,Wk=/^[^&#]+/;class jk{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new nt([],{}):new nt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[et]=new nt(e,t)),n}parseSegment(){const e=xd(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new he(4009,gd);return this.capture(e),new Oc(_d(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=xd(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const r=xd(this.remaining);r&&(n=r,this.capture(n))}e[_d(t)]=_d(n)}parseQueryParam(e){const t=function Gk(i){const e=i.match(Hk);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const o=function $k(i){const e=i.match(Wk);return e?e[0]:""}(this.remaining);o&&(n=o,this.capture(n))}const r=p2(t),s=p2(n);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=xd(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new he(4010,gd);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=et);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[et]:new nt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new he(4011,gd)}}function Y0(i){return i.segments.length>0?new nt([],{[et]:i}):i}function wd(i){const e={};for(const n of Object.keys(i.children)){const s=wd(i.children[n]);(s.segments.length>0||s.hasChildren())&&(e[n]=s)}return function qk(i){if(1===i.numberOfChildren&&i.children[et]){const e=i.children[et];return new nt(i.segments.concat(e.segments),e.children)}return i}(new nt(i.segments,e))}function ro(i){return i instanceof no}function Zk(i,e,t,n,r){if(0===t.length)return Ia(e.root,e.root,e.root,n,r);const s=function v2(i){if("string"==typeof i[0]&&1===i.length&&"/"===i[0])return new y2(!0,0,i);let e=0,t=!1;const n=i.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return In(s.outlets,(l,c)=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new y2(t,e,n)}(t);return s.toRoot()?Ia(e.root,e.root,new nt([],{}),n,r):function o(l){const c=function Kk(i,e,t,n){if(i.isAbsolute)return new Ra(e.root,!0,0);if(-1===n)return new Ra(t,t===e.root,0);return function _2(i,e,t){let n=i,r=e,s=t;for(;s>r;){if(s-=r,n=n.parent,!n)throw new he(4005,!1);r=n.segments.length}return new Ra(n,!1,r-s)}(t,n+(zc(i.commands[0])?0:1),i.numberOfDoubleDots)}(s,e,i.snapshot?._urlSegment,l),u=c.processChildren?Uc(c.segmentGroup,c.index,s.commands):X0(c.segmentGroup,c.index,s.commands);return Ia(e.root,c.segmentGroup,u,n,r)}(i.snapshot?._lastPathIndex)}function zc(i){return"object"==typeof i&&null!=i&&!i.outlets&&!i.segmentPath}function Bc(i){return"object"==typeof i&&null!=i&&i.outlets}function Ia(i,e,t,n,r){let o,s={};n&&In(n,(l,c)=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`}),o=i===e?t:m2(i,e,t);const a=Y0(wd(o));return new no(a,s,r)}function m2(i,e,t){const n={};return In(i.children,(r,s)=>{n[s]=r===e?t:m2(r,e,t)}),new nt(i.segments,n)}class y2{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&zc(n[0]))throw new he(4003,!1);const r=n.find(Bc);if(r&&r!==a2(n))throw new he(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Ra{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function X0(i,e,t){if(i||(i=new nt([],{})),0===i.segments.length&&i.hasChildren())return Uc(i,e,t);const n=function e9(i,e,t){let n=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=t.length)return s;const o=i.segments[r],a=t[n];if(Bc(a))break;const l=`${a}`,c=n<t.length-1?t[n+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!w2(l,c,o))return s;n+=2}else{if(!w2(l,{},o))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}(i,e,t),r=t.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){const s=new nt(i.segments.slice(0,n.pathIndex),{});return s.children[et]=new nt(i.segments.slice(n.pathIndex),i.children),Uc(s,0,r)}return n.match&&0===r.length?new nt(i.segments,{}):n.match&&!i.hasChildren()?K0(i,e,t):n.match?Uc(i,0,r):K0(i,e,t)}function Uc(i,e,t){if(0===t.length)return new nt(i.segments,{});{const n=function Qk(i){return Bc(i[0])?i[0].outlets:{[et]:i}}(t),r={};return In(n,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=X0(i.children[o],e,s))}),In(i.children,(s,o)=>{void 0===n[o]&&(r[o]=s)}),new nt(i.segments,r)}}function K0(i,e,t){const n=i.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(Bc(s)){const l=t9(s.outlets);return new nt(n,l)}if(0===r&&zc(t[0])){n.push(new Oc(i.segments[e].path,x2(t[0]))),r++;continue}const o=Bc(s)?s.outlets[et]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&zc(a)?(n.push(new Oc(o,x2(a))),r+=2):(n.push(new Oc(o,{})),r++)}return new nt(n,{})}function t9(i){const e={};return In(i,(t,n)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[n]=K0(new nt([],{}),0,t))}),e}function x2(i){const e={};return In(i,(t,n)=>e[n]=`${t}`),e}function w2(i,e,t){return i==t.path&&vr(e,t.parameters)}class Ur{constructor(e,t){this.id=e,this.url=t}}class Q0 extends Ur{constructor(e,t,n="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class so extends Ur{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class bd extends Ur{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class b2 extends Ur{constructor(e,t,n,r){super(e,t),this.error=n,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class n9 extends Ur{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class i9 extends Ur{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class r9 extends Ur{constructor(e,t,n,r,s){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class s9 extends Ur{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class o9 extends Ur{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class a9{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class l9{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class c9{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class u9{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class h9{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class d9{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class M2{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class S2{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=ey(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=ey(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=ty(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return ty(e,this._root).map(t=>t.value)}}function ey(i,e){if(i===e.value)return e;for(const t of e.children){const n=ey(i,t);if(n)return n}return null}function ty(i,e){if(i===e.value)return[e];for(const t of e.children){const n=ty(i,t);if(n.length)return n.unshift(e),n}return[]}class Vr{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Pa(i){const e={};return i&&i.children.forEach(t=>e[t.value.outlet]=t),e}class C2 extends S2{constructor(e,t){super(e),this.snapshot=t,ny(this,e)}toString(){return this.snapshot.toString()}}function D2(i,e){const t=function p9(i,e){const o=new Md([],{},{},"",{},et,e,null,i.root,-1,{});return new A2("",new Vr(o,[]))}(i,e),n=new nr([new Oc("",{})]),r=new nr({}),s=new nr({}),o=new nr({}),a=new nr(""),l=new La(n,r,o,a,s,et,e,t.root);return l.snapshot=t.root,new C2(new Vr(l,[]),t)}class La{constructor(e,t,n,r,s,o,a,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.title=this.data?.pipe(lt(c=>c[Nc]))??Te(void 0),this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(lt(e=>Ta(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(lt(e=>Ta(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function E2(i,e="emptyOnly"){const t=i.pathFromRoot;let n=0;if("always"!==e)for(n=t.length-1;n>=1;){const r=t[n],s=t[n-1];if(r.routeConfig&&""===r.routeConfig.path)n--;else{if(s.component)break;n--}}return function g9(i){return i.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(n))}class Md{constructor(e,t,n,r,s,o,a,l,c,u,h){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=u,this._resolve=h}get title(){return this.data?.[Nc]}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Ta(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Ta(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class A2 extends S2{constructor(e,t){super(t),this.url=e,ny(this,t)}toString(){return T2(this._root)}}function ny(i,e){e.value._routerState=i,e.children.forEach(t=>ny(i,t))}function T2(i){const e=i.children.length>0?` { ${i.children.map(T2).join(", ")} } `:"";return`${i.value}${e}`}function iy(i){if(i.snapshot){const e=i.snapshot,t=i._futureSnapshot;i.snapshot=t,vr(e.queryParams,t.queryParams)||i.queryParams.next(t.queryParams),e.fragment!==t.fragment&&i.fragment.next(t.fragment),vr(e.params,t.params)||i.params.next(t.params),function Rk(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;++t)if(!vr(i[t],e[t]))return!1;return!0}(e.url,t.url)||i.url.next(t.url),vr(e.data,t.data)||i.data.next(t.data)}else i.snapshot=i._futureSnapshot,i.data.next(i._futureSnapshot.data)}function ry(i,e){const t=vr(i.params,e.params)&&function Ok(i,e){return io(i,e)&&i.every((t,n)=>vr(t.parameters,e[n].parameters))}(i.url,e.url);return t&&!(!i.parent!=!e.parent)&&(!i.parent||ry(i.parent,e.parent))}function Vc(i,e,t){if(t&&i.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const r=function y9(i,e,t){return e.children.map(n=>{for(const r of t.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return Vc(i,n,r);return Vc(i,n)})}(i,e,t);return new Vr(n,r)}{if(i.shouldAttach(e.value)){const s=i.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Vc(i,a)),o}}const n=function v9(i){return new La(new nr(i.url),new nr(i.params),new nr(i.queryParams),new nr(i.fragment),new nr(i.data),i.outlet,i.component,i)}(e.value),r=e.children.map(s=>Vc(i,s));return new Vr(n,r)}}const sy="ngNavigationCancelingError";function I2(i,e){const{redirectTo:t,navigationBehaviorOptions:n}=ro(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=R2(!1,0,e);return r.url=t,r.navigationBehaviorOptions=n,r}function R2(i,e,t){const n=new Error("NavigationCancelingError: "+(i||""));return n[sy]=!0,n.cancellationCode=e,t&&(n.url=t),n}function P2(i){return L2(i)&&ro(i.url)}function L2(i){return i&&i[sy]}class _9{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Na,this.attachRef=null}}let Na=(()=>{class i{constructor(){this.contexts=new Map}onChildOutletCreated(t,n){const r=this.getOrCreateContext(t);r.outlet=n,this.contexts.set(t,r)}onChildOutletDestroyed(t){const n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new _9,this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ve({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Sd=!1;let N2=(()=>{class i{constructor(){this.activated=null,this._activatedRoute=null,this.name=et,this.activateEvents=new Yn,this.deactivateEvents=new Yn,this.attachEvents=new Yn,this.detachEvents=new Yn,this.parentContexts=ct(Na),this.location=ct(Ki),this.changeDetector=ct(d0),this.environmentInjector=ct(Pr)}ngOnChanges(t){if(t.name){const{firstChange:n,previousValue:r}=t.name;if(n)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new he(4012,Sd);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new he(4012,Sd);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new he(4012,Sd);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new he(4013,Sd);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new x9(t,a,r.injector);if(n&&function w9(i){return!!i.resolveComponentFactory}(n)){const c=n.resolveComponentFactory(o);this.activated=r.createComponent(c,r.length,l)}else this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:n??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=Gn({type:i,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Gs]}),i})();class x9{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===La?this.route:e===Na?this.childContexts:this.parent.get(e,t)}}let oy=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=Wo({type:i,selectors:[["ng-component"]],standalone:!0,features:[$M],decls:1,vars:0,template:function(t,n){1&t&&hn(0,"router-outlet")},dependencies:[N2],encapsulation:2}),i})();function O2(i,e){return i.providers&&!i._injector&&(i._injector=Uh(i.providers,e,`Route: ${i.path}`)),i._injector??e}function ly(i){const e=i.children&&i.children.map(ly),t=e?{...i,children:e}:{...i};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==et&&(t.component=oy),t}function Ni(i){return i.outlet||et}function F2(i,e){const t=i.filter(n=>Ni(n)===e);return t.push(...i.filter(n=>Ni(n)!==e)),t}function Hc(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let e=i.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class D9{constructor(e,t,n,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),iy(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const r=Pa(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],n),delete r[o]}),In(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=Pa(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(n&&n.outlet){const o=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=Pa(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(e,t,n){const r=Pa(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],n),this.forwardEvent(new d9(s.value.snapshot))}),e.children.length&&this.forwardEvent(new u9(e.value.snapshot))}activateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(iy(r),r===s)if(r.component){const o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(r.component){const o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),iy(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=Hc(r.snapshot),l=a?.get(cc)??null;o.attachRef=null,o.route=r,o.resolver=l,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}class k2{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Cd{constructor(e,t){this.component=e,this.route=t}}function E9(i,e,t){const n=i._root;return Gc(n,e?e._root:null,t,[n.value])}function Oa(i,e){const t=Symbol(),n=e.get(i,t);return n===t?"function"!=typeof i||function oI(i){return null!==Uu(i)}(i)?e.get(i):i:n}function Gc(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=Pa(e);return i.children.forEach(o=>{(function T9(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=i.value,o=e?e.value:null,a=t?t.getContext(i.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function I9(i,e,t){if("function"==typeof t)return t(i,e);switch(t){case"pathParamsChange":return!io(i.url,e.url);case"pathParamsOrQueryParamsChange":return!io(i.url,e.url)||!vr(i.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ry(i,e)||!vr(i.queryParams,e.queryParams);default:return!ry(i,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new k2(n)):(s.data=o.data,s._resolvedData=o._resolvedData),Gc(i,e,s.component?a?a.children:null:t,n,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Cd(a.outlet.component,o))}else o&&Wc(e,a,r),r.canActivateChecks.push(new k2(n)),Gc(i,null,s.component?a?a.children:null:t,n,r)})(o,s[o.value.outlet],t,n.concat([o.value]),r),delete s[o.value.outlet]}),In(s,(o,a)=>Wc(o,t.getContext(a),r)),r}function Wc(i,e,t){const n=Pa(i),r=i.value;In(n,(s,o)=>{Wc(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new Cd(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function $c(i){return"function"==typeof i}function cy(i){return i instanceof fd||"EmptyError"===i?.name}const Dd=Symbol("INITIAL_VALUE");function Fa(){return yr(i=>KC(i.map(e=>e.pipe(Lc(1),function Sk(...i){const e=Bl(i);return xn((t,n)=>{(e?G0(i,t,e):G0(i,t)).subscribe(n)})}(Dd)))).pipe(lt(e=>{for(const t of e)if(!0!==t){if(t===Dd)return Dd;if(!1===t||t instanceof no)return t}return!0}),ps(e=>e!==Dd),Lc(1)))}function z2(i){return function CT(...i){return j_(i)}(Bn(e=>{if(ro(e))throw I2(0,e)}),lt(e=>!0===e))}const uy={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function B2(i,e,t,n,r){const s=hy(i,e,t);return s.matched?function q9(i,e,t,n){const r=e.canMatch;return r&&0!==r.length?Te(r.map(o=>{const a=Oa(o,i);return ys(function F9(i){return i&&$c(i.canMatch)}(a)?a.canMatch(e,t):i.runInContext(()=>a(e,t)))})).pipe(Fa(),z2()):Te(!0)}(n=O2(e,n),e,t).pipe(lt(o=>!0===o?s:{...uy})):Te(s)}function hy(i,e,t){if(""===e.path)return"full"===e.pathMatch&&(i.hasChildren()||t.length>0)?{...uy}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||Ik)(t,i,e);if(!r)return{...uy};const s={};In(r.posParams,(a,l)=>{s[l]=a.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function Ed(i,e,t,n){if(t.length>0&&function Z9(i,e,t){return t.some(n=>Ad(i,e,n)&&Ni(n)!==et)}(i,t,n)){const s=new nt(e,function Y9(i,e,t,n){const r={};r[et]=n,n._sourceSegment=i,n._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&Ni(s)!==et){const o=new nt([],{});o._sourceSegment=i,o._segmentIndexShift=e.length,r[Ni(s)]=o}return r}(i,e,n,new nt(t,i.children)));return s._sourceSegment=i,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===t.length&&function X9(i,e,t){return t.some(n=>Ad(i,e,n))}(i,t,n)){const s=new nt(i.segments,function J9(i,e,t,n,r){const s={};for(const o of n)if(Ad(i,t,o)&&!r[Ni(o)]){const a=new nt([],{});a._sourceSegment=i,a._segmentIndexShift=e.length,s[Ni(o)]=a}return{...r,...s}}(i,e,t,n,i.children));return s._sourceSegment=i,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}const r=new nt(i.segments,i.children);return r._sourceSegment=i,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:t}}function Ad(i,e,t){return(!(i.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function U2(i,e,t,n){return!!(Ni(i)===n||n!==et&&Ad(e,t,i))&&("**"===i.path||hy(e,i,t).matched)}function V2(i,e,t){return 0===e.length&&!i.children[t]}const Td=!1;class Id{constructor(e){this.segmentGroup=e||null}}class H2{constructor(e){this.urlTree=e}}function jc(i){return Pc(new Id(i))}function G2(i){return Pc(new H2(i))}class t7{constructor(e,t,n,r,s){this.injector=e,this.configLoader=t,this.urlSerializer=n,this.urlTree=r,this.config=s,this.allowRedirects=!0}apply(){const e=Ed(this.urlTree.root,[],[],this.config).segmentGroup,t=new nt(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,et).pipe(lt(s=>this.createUrlTree(wd(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(ms(s=>{if(s instanceof H2)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof Id?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,et).pipe(lt(r=>this.createUrlTree(wd(r),e.queryParams,e.fragment))).pipe(ms(r=>{throw r instanceof Id?this.noMatchError(r):r}))}noMatchError(e){return new he(4002,Td)}createUrlTree(e,t,n){const r=Y0(e);return new no(r,t,n)}expandSegmentGroup(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(lt(s=>new nt([],s))):this.expandSegment(e,n,t,n.segments,r,!0)}expandChildren(e,t,n){const r=[];for(const s of Object.keys(n.children))"primary"===s?r.unshift(s):r.push(s);return cn(r).pipe(to(s=>{const o=n.children[s],a=F2(t,s);return this.expandSegmentGroup(e,a,o,s).pipe(lt(l=>({segment:l,outlet:s})))}),i2((s,o)=>(s[o.outlet]=o.segment,s),{}),r2())}expandSegment(e,t,n,r,s,o){return cn(n).pipe(to(a=>this.expandSegmentAgainstRoute(e,t,n,a,r,s,o).pipe(ms(c=>{if(c instanceof Id)return Te(null);throw c}))),gs(a=>!!a),ms((a,l)=>{if(cy(a))return V2(t,r,s)?Te(new nt([],{})):jc(t);throw a}))}expandSegmentAgainstRoute(e,t,n,r,s,o,a){return U2(r,t,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o):jc(t):jc(t)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,r){const s=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?G2(s):this.lineralizeSegments(n,s).pipe(En(o=>{const a=new nt(o,{});return this.expandSegment(e,a,t,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:u}=hy(t,r,s);if(!a)return jc(t);const h=this.applyRedirectCommands(l,r.redirectTo,u);return r.redirectTo.startsWith("/")?G2(h):this.lineralizeSegments(r,h).pipe(En(d=>this.expandSegment(e,t,n,d.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,n,r,s){return"**"===n.path?(e=O2(n,e),n.loadChildren?(n._loadedRoutes?Te({routes:n._loadedRoutes,injector:n._loadedInjector}):this.configLoader.loadChildren(e,n)).pipe(lt(a=>(n._loadedRoutes=a.routes,n._loadedInjector=a.injector,new nt(r,{})))):Te(new nt(r,{}))):B2(t,n,r,e).pipe(yr(({matched:o,consumedSegments:a,remainingSegments:l})=>o?this.getChildConfig(e=n._injector??e,n,r).pipe(En(u=>{const h=u.injector??e,d=u.routes,{segmentGroup:f,slicedSegments:p}=Ed(t,a,l,d),g=new nt(f.segments,f.children);if(0===p.length&&g.hasChildren())return this.expandChildren(h,d,g).pipe(lt(v=>new nt(a,v)));if(0===d.length&&0===p.length)return Te(new nt(a,{}));const m=Ni(n)===s;return this.expandSegment(h,g,d,p,m?et:s,!0).pipe(lt(_=>new nt(a.concat(_.segments),_.children)))})):jc(t)))}getChildConfig(e,t,n){return t.children?Te({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Te({routes:t._loadedRoutes,injector:t._loadedInjector}):function j9(i,e,t,n){const r=e.canLoad;return void 0===r||0===r.length?Te(!0):Te(r.map(o=>{const a=Oa(o,i);return ys(function P9(i){return i&&$c(i.canLoad)}(a)?a.canLoad(e,t):i.runInContext(()=>a(e,t)))})).pipe(Fa(),z2())}(e,t,n).pipe(En(r=>r?this.configLoader.loadChildren(e,t).pipe(Bn(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function Q9(i){return Pc(R2(Td,3))}())):Te({routes:[],injector:e})}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Te(n);if(r.numberOfChildren>1||!r.children[et])return Pc(new he(4e3,Td));r=r.children[et]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreateUrlTree(e,t,n,r){const s=this.createSegmentGroup(e,t.root,n,r);return new no(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return In(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);n[s]=t[a]}else n[s]=r}),n}createSegmentGroup(e,t,n,r){const s=this.createSegments(e,t.segments,n,r);let o={};return In(t.children,(a,l)=>{o[l]=this.createSegmentGroup(e,a,n,r)}),new nt(s,o)}createSegments(e,t,n,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,n))}findPosParam(e,t,n){const r=n[t.path.substring(1)];if(!r)throw new he(4001,Td);return r}findOrReturn(e,t){let n=0;for(const r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}}class i7{}class o7{constructor(e,t,n,r,s,o,a){this.injector=e,this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a}recognize(){const e=Ed(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,et).pipe(lt(t=>{if(null===t)return null;const n=new Md([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},et,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Vr(n,t),s=new A2(this.url,r);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(e){const t=e.value,n=E2(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.processChildren(e,t,n):this.processSegment(e,t,n,n.segments,r)}processChildren(e,t,n){return cn(Object.keys(n.children)).pipe(to(r=>{const s=n.children[r],o=F2(t,r);return this.processSegmentGroup(e,o,s,r)}),i2((r,s)=>r&&s?(r.push(...s),r):null),function Ek(i,e=!1){return xn((t,n)=>{let r=0;t.subscribe(wn(n,s=>{const o=i(s,r++);(o||e)&&n.next(s),!o&&n.complete()}))})}(r=>null!==r),pd(null),r2(),lt(r=>{if(null===r)return null;const s=$2(r);return function a7(i){i.sort((e,t)=>e.value.outlet===et?-1:t.value.outlet===et?1:e.value.outlet.localeCompare(t.value.outlet))}(s),s}))}processSegment(e,t,n,r,s){return cn(t).pipe(to(o=>this.processSegmentAgainstRoute(o._injector??e,o,n,r,s)),gs(o=>!!o),ms(o=>{if(cy(o))return V2(n,r,s)?Te([]):Te(null);throw o}))}processSegmentAgainstRoute(e,t,n,r,s){if(t.redirectTo||!U2(t,n,r,s))return Te(null);let o;if("**"===t.path){const a=r.length>0?a2(r).parameters:{},l=q2(n)+r.length;o=Te({snapshot:new Md(r,a,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,J2(t),Ni(t),t.component??t._loadedComponent??null,t,j2(n),l,Y2(t)),consumedSegments:[],remainingSegments:[]})}else o=B2(n,t,r,e).pipe(lt(({matched:a,consumedSegments:l,remainingSegments:c,parameters:u})=>{if(!a)return null;const h=q2(n)+l.length;return{snapshot:new Md(l,u,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,J2(t),Ni(t),t.component??t._loadedComponent??null,t,j2(n),h,Y2(t)),consumedSegments:l,remainingSegments:c}}));return o.pipe(yr(a=>{if(null===a)return Te(null);const{snapshot:l,consumedSegments:c,remainingSegments:u}=a;e=t._injector??e;const h=t._loadedInjector??e,d=function l7(i){return i.children?i.children:i.loadChildren?i._loadedRoutes:[]}(t),{segmentGroup:f,slicedSegments:p}=Ed(n,c,u,d.filter(m=>void 0===m.redirectTo));if(0===p.length&&f.hasChildren())return this.processChildren(h,d,f).pipe(lt(m=>null===m?null:[new Vr(l,m)]));if(0===d.length&&0===p.length)return Te([new Vr(l,[])]);const g=Ni(t)===s;return this.processSegment(h,d,f,p,g?et:s).pipe(lt(m=>null===m?null:[new Vr(l,m)]))}))}}function c7(i){const e=i.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function $2(i){const e=[],t=new Set;for(const n of i){if(!c7(n)){e.push(n);continue}const r=e.find(s=>n.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...n.children),t.add(r)):e.push(n)}for(const n of t){const r=$2(n.children);e.push(new Vr(n.value,r))}return e.filter(n=>!t.has(n))}function j2(i){let e=i;for(;e._sourceSegment;)e=e._sourceSegment;return e}function q2(i){let e=i,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function J2(i){return i.data||{}}function Y2(i){return i.resolve||{}}function Z2(i){return"string"==typeof i.title||null===i.title}function dy(i){return yr(e=>{const t=i(e);return t?cn(t).pipe(lt(()=>e)):Te(e)})}const ka=new ze("ROUTES");let fy=(()=>{class i{constructor(t,n){this.injector=t,this.compiler=n,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Te(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const n=ys(t.loadComponent()).pipe(lt(K2),Bn(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),j0(()=>{this.componentLoaders.delete(t)})),r=new t2(n,()=>new Mr).pipe(W0());return this.componentLoaders.set(t,r),r}loadChildren(t,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return Te({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);const s=this.loadModuleFactoryOrRoutes(n.loadChildren).pipe(lt(a=>{this.onLoadEndListener&&this.onLoadEndListener(n);let l,c,u=!1;Array.isArray(a)?c=a:(l=a.create(t).injector,c=o2(l.get(ka,[],Pe.Self|Pe.Optional)));return{routes:c.map(ly),injector:l}}),j0(()=>{this.childrenLoaders.delete(n)})),o=new t2(s,()=>new Mr).pipe(W0());return this.childrenLoaders.set(n,o),o}loadModuleFactoryOrRoutes(t){return ys(t()).pipe(lt(K2),En(r=>r instanceof GM||Array.isArray(r)?Te(r):cn(this.compiler.compileModuleAsync(r))))}}return i.\u0275fac=function(t){return new(t||i)(Ee(Yi),Ee(n0))},i.\u0275prov=Ve({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function K2(i){return function v7(i){return i&&"object"==typeof i&&"default"in i}(i)?i.default:i}let py=(()=>{class i{constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Mr,this.configLoader=ct(fy),this.environmentInjector=ct(Pr),this.urlSerializer=ct(Fc),this.rootContexts=ct(Na),this.navigationId=0,this.configLoader.onLoadEndListener=r=>this.events.next(new l9(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new a9(r))}get hasRequestedNavigation(){return 0!==this.navigationId}complete(){this.transitions?.complete()}handleNavigationRequest(t){const n=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:n})}setupNavigations(t){return this.transitions=new nr({id:0,targetPageId:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(ps(n=>0!==n.id),lt(n=>({...n,extractedUrl:t.urlHandlingStrategy.extract(n.rawUrl)})),yr(n=>{let r=!1,s=!1;return Te(n).pipe(Bn(o=>{this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),yr(o=>{const a=t.browserUrlTree.toString(),l=!t.navigated||o.extractedUrl.toString()!==a||a!==t.currentUrlTree.toString();if(("reload"===t.onSameUrlNavigation||l)&&t.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return eD(o.source)&&(t.browserUrlTree=o.extractedUrl),Te(o).pipe(yr(u=>{const h=this.transitions?.getValue();return this.events.next(new Q0(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),h!==this.transitions?.getValue()?Cr:Promise.resolve(u)}),function n7(i,e,t,n){return yr(r=>function e7(i,e,t,n,r){return new t7(i,e,t,n,r).apply()}(i,e,t,r.extractedUrl,n).pipe(lt(s=>({...r,urlAfterRedirects:s}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,t.config),Bn(u=>{this.currentNavigation={...this.currentNavigation,finalUrl:u.urlAfterRedirects},n.urlAfterRedirects=u.urlAfterRedirects}),function h7(i,e,t,n,r){return En(s=>function s7(i,e,t,n,r,s,o="emptyOnly"){return new o7(i,e,t,n,r,o,s).recognize().pipe(yr(a=>null===a?function r7(i){return new Kt(e=>e.error(i))}(new i7):Te(a)))}(i,e,t,s.urlAfterRedirects,n.serialize(s.urlAfterRedirects),n,r).pipe(lt(o=>({...s,targetSnapshot:o}))))}(this.environmentInjector,t.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),Bn(u=>{if(n.targetSnapshot=u.targetSnapshot,"eager"===t.urlUpdateStrategy){if(!u.extras.skipLocationChange){const d=t.urlHandlingStrategy.merge(u.urlAfterRedirects,u.rawUrl);t.setBrowserUrl(d,u)}t.browserUrlTree=u.urlAfterRedirects}const h=new n9(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}));if(l&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:h,extractedUrl:d,source:f,restoredState:p,extras:g}=o,m=new Q0(h,this.urlSerializer.serialize(d),f,p);this.events.next(m);const y=D2(d,t.rootComponentType).snapshot;return Te(n={...o,targetSnapshot:y,urlAfterRedirects:d,extras:{...g,skipLocationChange:!1,replaceUrl:!1}})}return t.rawUrlTree=o.rawUrl,o.resolve(null),Cr}),Bn(o=>{const a=new i9(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),lt(o=>n={...o,guards:E9(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),function z9(i,e){return En(t=>{const{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Te({...t,guardsResult:!0}):function B9(i,e,t,n){return cn(i).pipe(En(r=>function $9(i,e,t,n,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Te(s.map(a=>{const l=Hc(e)??r,c=Oa(a,l);return ys(function O9(i){return i&&$c(i.canDeactivate)}(c)?c.canDeactivate(i,e,t,n):l.runInContext(()=>c(i,e,t,n))).pipe(gs())})).pipe(Fa()):Te(!0)}(r.component,r.route,t,e,n)),gs(r=>!0!==r,!0))}(o,n,r,i).pipe(En(a=>a&&function R9(i){return"boolean"==typeof i}(a)?function U9(i,e,t,n){return cn(e).pipe(to(r=>G0(function H9(i,e){return null!==i&&e&&e(new c9(i)),Te(!0)}(r.route.parent,n),function V9(i,e){return null!==i&&e&&e(new h9(i)),Te(!0)}(r.route,n),function W9(i,e,t){const n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function A9(i){const e=i.routeConfig?i.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:i,guards:e}:null}(o)).filter(o=>null!==o).map(o=>e2(()=>Te(o.guards.map(l=>{const c=Hc(o.node)??t,u=Oa(l,c);return ys(function N9(i){return i&&$c(i.canActivateChild)}(u)?u.canActivateChild(n,i):c.runInContext(()=>u(n,i))).pipe(gs())})).pipe(Fa())));return Te(s).pipe(Fa())}(i,r.path,t),function G9(i,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return Te(!0);const r=n.map(s=>e2(()=>{const o=Hc(e)??t,a=Oa(s,o);return ys(function L9(i){return i&&$c(i.canActivate)}(a)?a.canActivate(e,i):o.runInContext(()=>a(e,i))).pipe(gs())}));return Te(r).pipe(Fa())}(i,r.route,t))),gs(r=>!0!==r,!0))}(n,s,i,e):Te(a)),lt(a=>({...t,guardsResult:a})))})}(this.environmentInjector,o=>this.events.next(o)),Bn(o=>{if(n.guardsResult=o.guardsResult,ro(o.guardsResult))throw I2(0,o.guardsResult);const a=new r9(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),ps(o=>!!o.guardsResult||(t.restoreHistory(o),this.cancelNavigationTransition(o,"",3,t),!1)),dy(o=>{if(o.guards.canActivateChecks.length)return Te(o).pipe(Bn(a=>{const l=new s9(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}),yr(a=>{let l=!1;return Te(a).pipe(function d7(i,e){return En(t=>{const{targetSnapshot:n,guards:{canActivateChecks:r}}=t;if(!r.length)return Te(t);let s=0;return cn(r).pipe(to(o=>function f7(i,e,t,n){const r=i.routeConfig,s=i._resolve;return void 0!==r?.title&&!Z2(r)&&(s[Nc]=r.title),function p7(i,e,t,n){const r=function g7(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}(i);if(0===r.length)return Te({});const s={};return cn(r).pipe(En(o=>function m7(i,e,t,n){const r=Hc(e)??n,s=Oa(i,r);return ys(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(i[o],e,t,n).pipe(gs(),Bn(a=>{s[o]=a}))),$0(1),function Ak(i){return lt(()=>i)}(s),ms(o=>cy(o)?Cr:Pc(o)))}(s,i,e,n).pipe(lt(o=>(i._resolvedData=o,i.data=E2(i,t).resolve,r&&Z2(r)&&(i.data[Nc]=r.title),null)))}(o.route,n,i,e)),Bn(()=>s++),$0(1),En(o=>s===r.length?Te(t):Cr))})}(t.paramsInheritanceStrategy,this.environmentInjector),Bn({next:()=>l=!0,complete:()=>{l||(t.restoreHistory(a),this.cancelNavigationTransition(a,"",2,t))}}))}),Bn(a=>{const l=new o9(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}))}),dy(o=>{const a=l=>{const c=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&c.push(this.configLoader.loadComponent(l.routeConfig).pipe(Bn(u=>{l.component=u}),lt(()=>{})));for(const u of l.children)c.push(...a(u));return c};return KC(a(o.targetSnapshot.root)).pipe(pd(),Lc(1))}),dy(()=>t.afterPreactivation()),lt(o=>{const a=function m9(i,e,t){const n=Vc(i,e._root,t?t._root:void 0);return new C2(n,e)}(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return n={...o,targetRouterState:a}}),Bn(o=>{t.currentUrlTree=o.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(o.urlAfterRedirects,o.rawUrl),t.routerState=o.targetRouterState,"deferred"===t.urlUpdateStrategy&&(o.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,o),t.browserUrlTree=o.urlAfterRedirects)}),((i,e,t)=>lt(n=>(new D9(e,n.targetRouterState,n.currentRouterState,t).activate(i),n)))(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o)),Bn({next:o=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new so(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{r=!0}}),j0(()=>{r||s||this.cancelNavigationTransition(n,"",1,t),this.currentNavigation?.id===n.id&&(this.currentNavigation=null)}),ms(o=>{if(s=!0,L2(o)){P2(o)||(t.navigated=!0,t.restoreHistory(n,!0));const a=new bd(n.id,this.urlSerializer.serialize(n.extractedUrl),o.message,o.cancellationCode);if(this.events.next(a),P2(o)){const l=t.urlHandlingStrategy.merge(o.url,t.rawUrlTree),c={skipLocationChange:n.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||eD(n.source)};t.scheduleNavigation(l,"imperative",null,c,{resolve:n.resolve,reject:n.reject,promise:n.promise})}else n.resolve(!1)}else{t.restoreHistory(n,!0);const a=new b2(n.id,this.urlSerializer.serialize(n.extractedUrl),o,n.targetSnapshot??void 0);this.events.next(a);try{n.resolve(t.errorHandler(o))}catch(l){n.reject(l)}}return Cr}))}))}cancelNavigationTransition(t,n,r,s){const o=new bd(t.id,this.urlSerializer.serialize(t.extractedUrl),n,r);this.events.next(o),t.resolve(!1)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ve({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function eD(i){return"imperative"!==i}let tD=(()=>{class i{buildTitle(t){let n,r=t.root;for(;void 0!==r;)n=this.getResolvedTitleForRoute(r)??n,r=r.children.find(s=>s.outlet===et);return n}getResolvedTitleForRoute(t){return t.data[Nc]}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ve({token:i,factory:function(){return ct(_7)},providedIn:"root"}),i})(),_7=(()=>{class i extends tD{constructor(t){super(),this.title=t}updateTitle(t){const n=this.buildTitle(t);void 0!==n&&this.title.setTitle(n)}}return i.\u0275fac=function(t){return new(t||i)(Ee(YC))},i.\u0275prov=Ve({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),x7=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ve({token:i,factory:function(){return ct(b7)},providedIn:"root"}),i})();class w7{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let b7=(()=>{class i extends w7{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=function lx(i){return os(()=>{const e=i.prototype.constructor,t=e[Ar]||yg(e),n=Object.prototype;let r=Object.getPrototypeOf(i.prototype).constructor;for(;r&&r!==n;){const s=r[Ar]||yg(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}(i)))(n||i)}}(),i.\u0275prov=Ve({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Rd=new ze("",{providedIn:"root",factory:()=>({})});let S7=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ve({token:i,factory:function(){return ct(C7)},providedIn:"root"}),i})(),C7=(()=>{class i{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ve({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function D7(i){throw i}function E7(i,e,t){return e.parse("/")}const A7={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},T7={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function iD(){const i=ct(Fc),e=ct(Na),t=ct(x0),n=ct(Yi),r=ct(n0),s=ct(ka,{optional:!0})??[],o=ct(Rd,{optional:!0})??{},a=new li(null,i,e,t,n,r,o2(s));return function I7(i,e){i.errorHandler&&(e.errorHandler=i.errorHandler),i.malformedUriErrorHandler&&(e.malformedUriErrorHandler=i.malformedUriErrorHandler),i.onSameUrlNavigation&&(e.onSameUrlNavigation=i.onSameUrlNavigation),i.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=i.paramsInheritanceStrategy),i.urlUpdateStrategy&&(e.urlUpdateStrategy=i.urlUpdateStrategy),i.canceledNavigationResolution&&(e.canceledNavigationResolution=i.canceledNavigationResolution)}(o,a),a}let li=(()=>{class i{constructor(t,n,r,s,o,a,l){this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=s,this.config=l,this.disposed=!1,this.currentPageId=0,this.isNgZoneEnabled=!1,this.errorHandler=D7,this.malformedUriErrorHandler=E7,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>Te(void 0),this.urlHandlingStrategy=ct(S7),this.routeReuseStrategy=ct(x7),this.titleStrategy=ct(tD),this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.canceledNavigationResolution="replace",this.navigationTransitions=ct(py),this.console=o.get(jO);const c=o.get(en);this.isNgZoneEnabled=c instanceof en&&en.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=new no,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=D2(this.currentUrlTree,this.rootComponentType),this.navigationTransitions.setupNavigations(this).subscribe(u=>{this.lastSuccessfulId=u.id,this.currentPageId=u.targetPageId},u=>{this.console.warn(`Unhandled Navigation Error: ${u}`)})}get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const n="popstate"===t.type?"popstate":"hashchange";"popstate"===n&&setTimeout(()=>{const r={replaceUrl:!0},s=t.state?.navigationId?t.state:null;if(t.state){const a={...t.state};delete a.navigationId,delete a.\u0275routerPageId,0!==Object.keys(a).length&&(r.state=a)}const o=this.parseUrl(t.url);this.scheduleNavigation(o,n,s,r)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(t){this.config=t.map(ly),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,n={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=n,c=r||this.routerState.root,u=l?this.currentUrlTree.fragment:o;let h=null;switch(a){case"merge":h={...this.currentUrlTree.queryParams,...s};break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=s||null}return null!==h&&(h=this.removeEmptyProps(h)),Zk(c,this.currentUrlTree,t,h,u??null)}navigateByUrl(t,n={skipLocationChange:!1}){const r=ro(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,n)}navigate(t,n={skipLocationChange:!1}){return function R7(i){for(let e=0;e<i.length;e++){if(null==i[e])throw new he(4008,!1)}}(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let n;try{n=this.urlSerializer.parse(t)}catch(r){n=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return n}isActive(t,n){let r;if(r=!0===n?{...A7}:!1===n?{...T7}:n,ro(t))return c2(this.currentUrlTree,t,r);const s=this.parseUrl(t);return c2(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((n,r)=>{const s=t[r];return null!=s&&(n[r]=s),n},{})}scheduleNavigation(t,n,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c,u;return o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((h,d)=>{a=h,l=d}),"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),u=r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):u=0,this.navigationTransitions.handleNavigationRequest({targetPageId:u,source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(h=>Promise.reject(h))}setBrowserUrl(t,n){const r=this.urlSerializer.serialize(t),s={...n.extras.state,...this.generateNgRouterState(n.id,n.targetPageId)};this.location.isCurrentPathEqualTo(r)||n.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,n=!1){if("computed"===this.canceledNavigationResolution){const r=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===r?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===r&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(r)}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,n){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}}return i.\u0275fac=function(t){cm()},i.\u0275prov=Ve({token:i,factory:function(){return iD()},providedIn:"root"}),i})();class rD{}let N7=(()=>{class i{constructor(t,n,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(ps(t=>t instanceof so),to(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,n){const r=[];for(const s of n){s.providers&&!s._injector&&(s._injector=Uh(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent?r.push(this.preloadConfig(o,s)):(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return cn(r).pipe(Ho())}preloadConfig(t,n){return this.preloadingStrategy.preload(n,()=>{let r;r=n.loadChildren&&void 0===n.canLoad?this.loader.loadChildren(t,n):Te(null);const s=r.pipe(En(o=>null===o?Te(void 0):(n._loadedRoutes=o.routes,n._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return n.loadComponent&&!n._loadedComponent?cn([s,this.loader.loadComponent(n)]).pipe(Ho()):s})}}return i.\u0275fac=function(t){return new(t||i)(Ee(li),Ee(n0),Ee(Pr),Ee(rD),Ee(fy))},i.\u0275prov=Ve({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const my=new ze("");let sD=(()=>{class i{constructor(t,n,r,s,o={}){this.urlSerializer=t,this.transitions=n,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Q0?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof so&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof M2&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,n){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new M2(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return i.\u0275fac=function(t){cm()},i.\u0275prov=Ve({token:i,factory:i.\u0275fac}),i})();function Ba(i,e){return{\u0275kind:i,\u0275providers:e}}function aD(){const i=ct(Yi);return e=>{const t=i.get(qh);if(e!==t.components[0])return;const n=i.get(li),r=i.get(lD);1===i.get(vy)&&n.initialNavigation(),i.get(cD,null,Pe.Optional)?.setUpPreloading(),i.get(my,null,Pe.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.unsubscribe())}}const lD=new ze("",{factory:()=>new Mr}),vy=new ze("",{providedIn:"root",factory:()=>1});const cD=new ze("");function B7(i){return Ba(0,[{provide:cD,useExisting:N7},{provide:rD,useExisting:i}])}const uD=new ze("ROUTER_FORROOT_GUARD"),U7=[x0,{provide:Fc,useClass:q0},{provide:li,useFactory:iD},Na,{provide:La,useFactory:function oD(i){return i.routerState.root},deps:[li]},fy,[]];function V7(){return new HS("Router",li)}let hD=(()=>{class i{constructor(t){}static forRoot(t,n){return{ngModule:i,providers:[U7,[],{provide:ka,multi:!0,useValue:t},{provide:uD,useFactory:$7,deps:[[li,new Ql,new ec]]},{provide:Rd,useValue:n||{}},n?.useHash?{provide:eo,useClass:LF}:{provide:eo,useClass:hC},{provide:my,useFactory:()=>{const i=ct(r8),e=ct(en),t=ct(Rd),n=ct(py),r=ct(Fc);return t.scrollOffset&&i.setOffset(t.scrollOffset),new sD(r,n,i,e,t)}},n?.preloadingStrategy?B7(n.preloadingStrategy).\u0275providers:[],{provide:HS,multi:!0,useFactory:V7},n?.initialNavigation?j7(n):[],[{provide:dD,useFactory:aD},{provide:OS,multi:!0,useExisting:dD}]]}}static forChild(t){return{ngModule:i,providers:[{provide:ka,multi:!0,useValue:t}]}}}return i.\u0275fac=function(t){return new(t||i)(Ee(uD,8))},i.\u0275mod=Us({type:i}),i.\u0275inj=ss({imports:[oy]}),i})();function $7(i){return"guarded"}function j7(i){return["disabled"===i.initialNavigation?Ba(3,[{provide:Wh,multi:!0,useFactory:()=>{const e=ct(li);return()=>{e.setUpLocationChangeListener()}}},{provide:vy,useValue:2}]).\u0275providers:[],"enabledBlocking"===i.initialNavigation?Ba(2,[{provide:vy,useValue:0},{provide:Wh,multi:!0,deps:[Yi],useFactory:e=>{const t=e.get(RF,Promise.resolve());return()=>t.then(()=>new Promise(r=>{const s=e.get(li),o=e.get(lD);(function n(r){e.get(li).events.pipe(ps(o=>o instanceof so||o instanceof bd||o instanceof b2),lt(o=>o instanceof so||o instanceof bd&&(0===o.code||1===o.code)&&null),ps(o=>null!==o),Lc(1)).subscribe(()=>{r()})})(()=>{r(!0)}),s.afterPreactivation=()=>(r(!0),o.closed?Te(void 0):o),s.initialNavigation()}))}}]).\u0275providers:[]]}const dD=new ze(""),J7=[];class Pd{static#e=this.\u0275fac=function(t){return new(t||Pd)};static#t=this.\u0275mod=Us({type:Pd});static#n=this.\u0275inj=ss({imports:[hD.forRoot(J7),hD]})}class Y7 extends di{constructor(e,t){super()}schedule(e,t=0){return this}}const Ld={setInterval(i,e,...t){const{delegate:n}=Ld;return n?.setInterval?n.setInterval(i,e,...t):setInterval(i,e,...t)},clearInterval(i){const{delegate:e}=Ld;return(e?.clearInterval||clearInterval)(i)},delegate:void 0},fD={now:()=>(fD.delegate||Date).now(),delegate:void 0};class Jc{constructor(e,t=Jc.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}Jc.now=fD.now;const K7=new class X7 extends Jc{constructor(e,t=Jc.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}(class Z7 extends Y7{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var n;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,n=0){return Ld.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&Ld.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,n=!1;try{this.work(e)}catch(s){n=!0,r=s||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Vo(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}});class Nd{ngOnInit(){(function ez(i=0,e,t=K7){let n=-1;return null!=e&&(c1(e)?t=e:n=e),new Kt(r=>{let s=function Q7(i){return i instanceof Date&&!isNaN(i)}(i)?+i-t.now():i;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=n?this.schedule(void 0,n):r.complete())},s)})})(300).subscribe(()=>{document.querySelectorAll(".splash-item").forEach(e=>{e.classList.remove("hidden")})})}static#e=this.\u0275fac=function(t){return new(t||Nd)};static#t=this.\u0275cmp=Wo({type:Nd,selectors:[["app-profile"]],decls:16,vars:0,consts:[[1,"hero"],[1,"splash"],[1,"splash-item","hi","hidden"],[1,"splash-item","name","hidden"],[1,"splash-item","description","hidden"],[1,"presentation"],[2,"margin","0 auto"]],template:function(t,n){1&t&&(gt(0,"div",0)(1,"div",1)(2,"h1",2),zn(3,"Hi there!"),Ut(),gt(4,"h1",3),zn(5,"I'm Patrick Coral"),Ut(),gt(6,"h1",4),zn(7," Independent "),gt(8,"span"),zn(9,"Digital Designer"),Ut()()()(),gt(10,"div",5)(11,"div",6)(12,"h1"),zn(13,"About me..."),Ut(),gt(14,"p"),zn(15," I am a web developper based in Switzerland. "),Ut()()())},styles:['.hero[_ngcontent-%COMP%]{height:100vh;position:relative}.hero[_ngcontent-%COMP%]:before{z-index:-1;content:"";position:absolute;height:100%;width:100%;background-image:url(https://images.unsplash.com/photo-1519389950473-47ba0277781c?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1740&q=80);background-size:cover;background-position:50%;filter:grayscale(.5) brightness(.5)}.hero[_ngcontent-%COMP%]:after{content:"";position:absolute;height:100%;width:100%;background:linear-gradient(#00000000 50%,#131316 98%)}.splash[_ngcontent-%COMP%]{z-index:1;position:absolute;top:25%;left:25%}.splash[_ngcontent-%COMP%] > h1[_ngcontent-%COMP%]{overflow:hidden;padding:1em;width:-moz-fit-content;width:fit-content;max-width:100%;background-color:#202020;font-size:min(4vw,4vh);color:#fff;transition:all 1s ease-in-out;white-space:nowrap}.splash[_ngcontent-%COMP%] > h1.hidden[_ngcontent-%COMP%]{color:#fff0;max-width:0;padding:1em 0}.hi[_ngcontent-%COMP%]{transition-delay:0ms}.name[_ngcontent-%COMP%]{transition-delay:.3s!important;transform:translate(-3vh) translateY(-30%)}.description[_ngcontent-%COMP%]{transition-delay:.5s!important;transform:translateY(-60%)}span[_ngcontent-%COMP%]{color:transparent;background:linear-gradient(-20deg,#40e0d0 0%,#ff00dd 100%);-webkit-background-clip:text;background-clip:text}.presentation[_ngcontent-%COMP%]{width:100%;height:50vh;display:flex}.presentation[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:50vw}.presentation[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h1[_ngcontent-%COMP%]{margin:1em auto;font-family:"Exo 2",sans-serif;font-weight:700;font-size:5vh}.presentation[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{text-indent:2em;font-family:"Exo 2",sans-serif;font-size:3vh;font-weight:200}']})}function pD(i,e,t,n,r,s,o){try{var a=i[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(n,r)}const Xn=1001,gn=1003,rn=1006,lo=1009,co=1014,xs=1015,Xc=1016,Wa=1020,Fi=1023,uo=1026,$a=1027,ho=3e3,Ht=3001,_r="srgb",Kc="srgb-linear";class Ja{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const n=this._listeners[e.type];if(void 0!==n){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Un=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],po=Math.PI/180,Qc=180/Math.PI;function wi(){const i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Un[255&i]+Un[i>>8&255]+Un[i>>16&255]+Un[i>>24&255]+"-"+Un[255&e]+Un[e>>8&255]+"-"+Un[e>>16&15|64]+Un[e>>24&255]+"-"+Un[63&t|128]+Un[t>>8&255]+"-"+Un[t>>16&255]+Un[t>>24&255]+Un[255&n]+Un[n>>8&255]+Un[n>>16&255]+Un[n>>24&255]).toLowerCase()}function Zt(i,e,t){return Math.max(e,Math.min(t,i))}function eu(i,e,t){return(1-t)*i+t*e}function Ly(i){return 0==(i&i-1)&&0!==i}function Wd(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function Gr(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function At(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return Math.round(65535*i);case Uint8Array:return Math.round(255*i);case Int16Array:return Math.round(32767*i);case Int8Array:return Math.round(127*i);default:throw new Error("Invalid component type.")}}class ee{constructor(e=0,t=0){ee.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ci{constructor(){ci.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,n,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=n,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[3],l=n[6],c=n[1],u=n[4],h=n[7],d=n[2],f=n[5],p=n[8],g=r[0],m=r[3],y=r[6],_=r[1],v=r[4],x=r[7],b=r[2],S=r[5],T=r[8];return s[0]=o*g+a*_+l*b,s[3]=o*m+a*v+l*S,s[6]=o*y+a*x+l*T,s[1]=c*g+u*_+h*b,s[4]=c*m+u*v+h*S,s[7]=c*y+u*x+h*T,s[2]=d*g+f*_+p*b,s[5]=d*m+f*v+p*S,s[8]=d*y+f*x+p*T,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-n*s*u+n*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,d=a*l-u*s,f=c*s-o*l,p=t*h+n*d+r*f;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const g=1/p;return e[0]=h*g,e[1]=(r*c-u*n)*g,e[2]=(a*n-r*o)*g,e[3]=d*g,e[4]=(u*t-r*l)*g,e[5]=(r*s-a*t)*g,e[6]=f*g,e[7]=(n*l-c*t)*g,e[8]=(o*t-n*s)*g,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(Ny.makeScale(e,t)),this}rotate(e){return this.premultiply(Ny.makeRotation(-e)),this}translate(e,t){return this.premultiply(Ny.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const Ny=new ci;function XD(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}function tu(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function go(i){return i<.04045?.0773993808*i:Math.pow(.9478672986*i+.0521327014,2.4)}function $d(i){return i<.0031308?12.92*i:1.055*Math.pow(i,.41666)-.055}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const Oy={[_r]:{[Kc]:go},[Kc]:{[_r]:$d}},Kn={legacyMode:!0,get workingColorSpace(){return Kc},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,e,t){if(this.legacyMode||e===t||!e||!t)return i;if(Oy[e]&&void 0!==Oy[e][t]){const n=Oy[e][t];return i.r=n(i.r),i.g=n(i.g),i.b=n(i.b),i}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)}},KD={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},mn={r:0,g:0,b:0},ir={h:0,s:0,l:0},jd={h:0,s:0,l:0};function Fy(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+6*(e-i)*t:t<.5?e:t<2/3?i+6*(e-i)*(2/3-t):i}function qd(i,e){return e.r=i.r,e.g=i.g,e.b=i.b,e}let Za,_e=(()=>{class i{constructor(t,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===n&&void 0===r?this.set(t):this.setRGB(t,n,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,n=_r){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,Kn.toWorkingColorSpace(this,n),this}setRGB(t,n,r,s=Kn.workingColorSpace){return this.r=t,this.g=n,this.b=r,Kn.toWorkingColorSpace(this,s),this}setHSL(t,n,r,s=Kn.workingColorSpace){if(t=function Py(i,e){return(i%e+e)%e}(t,1),n=Zt(n,0,1),r=Zt(r,0,1),0===n)this.r=this.g=this.b=r;else{const o=r<=.5?r*(1+n):r+n-r*n,a=2*r-o;this.r=Fy(a,o,t+1/3),this.g=Fy(a,o,t),this.b=Fy(a,o,t-1/3)}return Kn.toWorkingColorSpace(this,s),this}setStyle(t,n=_r){function r(o){void 0!==o&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let s;if(s=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let o;const l=s[2];switch(s[1]){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(255,parseInt(o[1],10))/255,this.g=Math.min(255,parseInt(o[2],10))/255,this.b=Math.min(255,parseInt(o[3],10))/255,Kn.toWorkingColorSpace(this,n),r(o[4]),this;if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(100,parseInt(o[1],10))/100,this.g=Math.min(100,parseInt(o[2],10))/100,this.b=Math.min(100,parseInt(o[3],10))/100,Kn.toWorkingColorSpace(this,n),r(o[4]),this;break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l)){const c=parseFloat(o[1])/360,u=parseFloat(o[2])/100,h=parseFloat(o[3])/100;return r(o[4]),this.setHSL(c,u,h,n)}}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(t)){const o=s[1],a=o.length;if(3===a)return this.r=parseInt(o.charAt(0)+o.charAt(0),16)/255,this.g=parseInt(o.charAt(1)+o.charAt(1),16)/255,this.b=parseInt(o.charAt(2)+o.charAt(2),16)/255,Kn.toWorkingColorSpace(this,n),this;if(6===a)return this.r=parseInt(o.charAt(0)+o.charAt(1),16)/255,this.g=parseInt(o.charAt(2)+o.charAt(3),16)/255,this.b=parseInt(o.charAt(4)+o.charAt(5),16)/255,Kn.toWorkingColorSpace(this,n),this}return t&&t.length>0?this.setColorName(t,n):this}setColorName(t,n=_r){const r=KD[t.toLowerCase()];return void 0!==r?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=go(t.r),this.g=go(t.g),this.b=go(t.b),this}copyLinearToSRGB(t){return this.r=$d(t.r),this.g=$d(t.g),this.b=$d(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=_r){return Kn.fromWorkingColorSpace(qd(this,mn),t),Zt(255*mn.r,0,255)<<16^Zt(255*mn.g,0,255)<<8^Zt(255*mn.b,0,255)<<0}getHexString(t=_r){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,n=Kn.workingColorSpace){Kn.fromWorkingColorSpace(qd(this,mn),n);const r=mn.r,s=mn.g,o=mn.b,a=Math.max(r,s,o),l=Math.min(r,s,o);let c,u;const h=(l+a)/2;if(l===a)c=0,u=0;else{const d=a-l;switch(u=h<=.5?d/(a+l):d/(2-a-l),a){case r:c=(s-o)/d+(s<o?6:0);break;case s:c=(o-r)/d+2;break;case o:c=(r-s)/d+4}c/=6}return t.h=c,t.s=u,t.l=h,t}getRGB(t,n=Kn.workingColorSpace){return Kn.fromWorkingColorSpace(qd(this,mn),n),t.r=mn.r,t.g=mn.g,t.b=mn.b,t}getStyle(t=_r){return Kn.fromWorkingColorSpace(qd(this,mn),t),t!==_r?`color(${t} ${mn.r} ${mn.g} ${mn.b})`:`rgb(${255*mn.r|0},${255*mn.g|0},${255*mn.b|0})`}offsetHSL(t,n,r){return this.getHSL(ir),ir.h+=t,ir.s+=n,ir.l+=r,this.setHSL(ir.h,ir.s,ir.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this}lerpColors(t,n,r){return this.r=t.r+(n.r-t.r)*r,this.g=t.g+(n.g-t.g)*r,this.b=t.b+(n.b-t.b)*r,this}lerpHSL(t,n){this.getHSL(ir),t.getHSL(jd);const r=eu(ir.h,jd.h,n),s=eu(ir.s,jd.s,n),o=eu(ir.l,jd.l,n);return this.setHSL(r,s,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,n=0){return this.r=t[n],this.g=t[n+1],this.b=t[n+2],this}toArray(t=[],n=0){return t[n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t}fromBufferAttribute(t,n){return this.r=t.getX(n),this.g=t.getY(n),this.b=t.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}return i.NAMES=KD,i})();class QD{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Za&&(Za=tu("canvas")),Za.width=e.width,Za.height=e.height;const n=Za.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Za}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=tu("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*go(s[o]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t[n]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*go(t[n]/255)):go(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Xa{constructor(e=null){this.isSource=!0,this.uuid=wi(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(ky(r[o].isDataTexture?r[o].image:r[o]))}else s=ky(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function ky(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?QD.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let fB=0,ws=(()=>{class i extends Ja{constructor(t=i.DEFAULT_IMAGE,n=i.DEFAULT_MAPPING,r=Xn,s=Xn,o=rn,a=1008,l=Fi,c=lo,u=i.DEFAULT_ANISOTROPY,h=ho){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:fB++}),this.uuid=wi(),this.name="",this.source=new Xa(t),this.mipmaps=[],this.mapping=n,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new ee(0,0),this.repeat=new ee(1,1),this.center=new ee(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ci,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const n=void 0===t||"string"==typeof t;if(!n&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case Xn:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case Xn:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return i.DEFAULT_IMAGE=null,i.DEFAULT_MAPPING=300,i.DEFAULT_ANISOTROPY=1,i})();class Ct{constructor(e=0,t=0,n=0,r=1){Ct.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const l=e.elements,c=l[0],u=l[4],h=l[8],d=l[1],f=l[5],p=l[9],g=l[2],m=l[6],y=l[10];if(Math.abs(u-d)<.01&&Math.abs(h-g)<.01&&Math.abs(p-m)<.01){if(Math.abs(u+d)<.1&&Math.abs(h+g)<.1&&Math.abs(p+m)<.1&&Math.abs(c+f+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const v=(c+1)/2,x=(f+1)/2,b=(y+1)/2,S=(u+d)/4,T=(h+g)/4,w=(p+m)/4;return v>x&&v>b?v<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(v),r=S/n,s=T/n):x>b?x<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(x),n=S/r,s=w/r):b<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(b),n=T/s,r=w/s),this.set(n,r,s,t),this}let _=Math.sqrt((m-p)*(m-p)+(h-g)*(h-g)+(d-u)*(d-u));return Math.abs(_)<.001&&(_=1),this.x=(m-p)/_,this.y=(h-g)/_,this.z=(d-u)/_,this.w=Math.acos((c+f+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class mo extends Ja{constructor(e=1,t=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ct(0,0,e,t),this.scissorTest=!1,this.viewport=new Ct(0,0,e,t),this.texture=new ws({width:e,height:t,depth:1},n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:rn,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Xa(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class zy extends ws{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=gn,this.minFilter=gn,this.wrapR=Xn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class eE extends ws{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=gn,this.minFilter=gn,this.wrapR=Xn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class bi{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,o,a){let l=n[r+0],c=n[r+1],u=n[r+2],h=n[r+3];const d=s[o+0],f=s[o+1],p=s[o+2],g=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=u,void(e[t+3]=h);if(1===a)return e[t+0]=d,e[t+1]=f,e[t+2]=p,void(e[t+3]=g);if(h!==g||l!==d||c!==f||u!==p){let m=1-a;const y=l*d+c*f+u*p+h*g,_=y>=0?1:-1,v=1-y*y;if(v>Number.EPSILON){const b=Math.sqrt(v),S=Math.atan2(b,y*_);m=Math.sin(m*S)/b,a=Math.sin(a*S)/b}const x=a*_;if(l=l*m+d*x,c=c*m+f*x,u=u*m+p*x,h=h*m+g*x,m===1-a){const b=1/Math.sqrt(l*l+c*c+u*u+h*h);l*=b,c*=b,u*=b,h*=b}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=h}static multiplyQuaternionsFlat(e,t,n,r,s,o){const a=n[r],l=n[r+1],c=n[r+2],u=n[r+3],h=s[o],d=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*h+l*f-c*d,e[t+1]=l*p+u*d+c*h-a*f,e[t+2]=c*p+u*f+a*d-l*h,e[t+3]=u*p-a*h-l*d-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(n/2),u=a(r/2),h=a(s/2),d=l(n/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=d*u*h+c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h-d*f*p;break;case"YXZ":this._x=d*u*h+c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h+d*f*p;break;case"ZXY":this._x=d*u*h-c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h-d*f*p;break;case"ZYX":this._x=d*u*h-c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h+d*f*p;break;case"YZX":this._x=d*u*h+c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h-d*f*p;break;case"XZY":this._x=d*u*h-c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],h=t[10],d=n+a+h;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(n>a&&n>h){const f=2*Math.sqrt(1+n-a-h);this._w=(u-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>h){const f=2*Math.sqrt(1+a-n-h);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+h-n-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Zt(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=n*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-n*c,this._z=s*u+o*c+n*l-r*a,this._w=o*u-n*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*n+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),h=Math.sin((1-t)*u)/c,d=Math.sin(t*u)/c;return this._w=o*h+this._w*d,this._x=n*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(s),n*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class E{constructor(e=0,t=0,n=0){E.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(tE.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(tE.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*n,u=l*n+a*t-s*r,h=l*r+s*n-o*t,d=-s*t-o*n-a*r;return this.x=c*l+d*-s+u*-a-h*-o,this.y=u*l+d*-o+h*-s-c*-a,this.z=h*l+d*-a+c*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return By.copy(this).projectOnVector(e),this.sub(By)}reflect(e){return this.sub(By.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Zt(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const By=new E,tE=new bi;class Ka{constructor(e=new E(1/0,1/0,1/0),t=new E(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.length;l<c;l+=3){const u=e[l],h=e[l+1],d=e[l+2];u<t&&(t=u),h<n&&(n=h),d<r&&(r=d),u>s&&(s=u),h>o&&(o=h),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.count;l<c;l++){const u=e.getX(l),h=e.getY(l),d=e.getZ(l);u<t&&(t=u),h<n&&(n=h),d<r&&(r=d),u>s&&(s=u),h>o&&(o=h),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=yo.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){const s=n.attributes.position;for(let o=0,a=s.count;o<a;o++)yo.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(yo)}else null===n.boundingBox&&n.computeBoundingBox(),Uy.copy(n.boundingBox),Uy.applyMatrix4(e.matrixWorld),this.union(Uy);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,yo),yo.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(nu),Jd.subVectors(this.max,nu),Qa.subVectors(e.a,nu),el.subVectors(e.b,nu),tl.subVectors(e.c,nu),bs.subVectors(el,Qa),Ms.subVectors(tl,el),vo.subVectors(Qa,tl);let t=[0,-bs.z,bs.y,0,-Ms.z,Ms.y,0,-vo.z,vo.y,bs.z,0,-bs.x,Ms.z,0,-Ms.x,vo.z,0,-vo.x,-bs.y,bs.x,0,-Ms.y,Ms.x,0,-vo.y,vo.x,0];return!(!Vy(t,Qa,el,tl,Jd)||(t=[1,0,0,0,1,0,0,0,1],!Vy(t,Qa,el,tl,Jd)))&&(Yd.crossVectors(bs,Ms),t=[Yd.x,Yd.y,Yd.z],Vy(t,Qa,el,tl,Jd))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return yo.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(yo).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Wr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Wr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Wr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Wr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Wr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Wr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Wr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Wr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Wr)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Wr=[new E,new E,new E,new E,new E,new E,new E,new E],yo=new E,Uy=new Ka,Qa=new E,el=new E,tl=new E,bs=new E,Ms=new E,vo=new E,nu=new E,Jd=new E,Yd=new E,_o=new E;function Vy(i,e,t,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){_o.fromArray(i,s);const a=r.x*Math.abs(_o.x)+r.y*Math.abs(_o.y)+r.z*Math.abs(_o.z),l=e.dot(_o),c=t.dot(_o),u=n.dot(_o);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const pB=new Ka,iu=new E,Hy=new E;class nl{constructor(e=new E,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):pB.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;iu.subVectors(e,this.center);const t=iu.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=.5*(n-this.radius);this.center.addScaledVector(iu,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Hy.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(iu.copy(e.center).add(Hy)),this.expandByPoint(iu.copy(e.center).sub(Hy))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const $r=new E,Gy=new E,Zd=new E,Ss=new E,Wy=new E,Xd=new E,$y=new E;class Kd{constructor(e=new E,t=new E(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,$r)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=$r.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):($r.copy(this.direction).multiplyScalar(t).add(this.origin),$r.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){Gy.copy(e).add(t).multiplyScalar(.5),Zd.copy(t).sub(e).normalize(),Ss.copy(this.origin).sub(Gy);const s=.5*e.distanceTo(t),o=-this.direction.dot(Zd),a=Ss.dot(this.direction),l=-Ss.dot(Zd),c=Ss.lengthSq(),u=Math.abs(1-o*o);let h,d,f,p;if(u>0)if(h=o*l-a,d=o*a-l,p=s*u,h>=0)if(d>=-p)if(d<=p){const g=1/u;h*=g,d*=g,f=h*(h+o*d+2*a)+d*(o*h+d+2*l)+c}else d=s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;else d=-s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;else d<=-p?(h=Math.max(0,-(-o*s+a)),d=h>0?-s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+c):d<=p?(h=0,d=Math.min(Math.max(-s,-l),s),f=d*(d+2*l)+c):(h=Math.max(0,-(o*s+a)),d=h>0?s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+c);else d=o>0?-s:s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;return n&&n.copy(this.direction).multiplyScalar(h).add(this.origin),r&&r.copy(Zd).multiplyScalar(d).add(Gy),f}intersectSphere(e,t){$r.subVectors(e.center,this.origin);const n=$r.dot(this.direction),r=$r.dot($r)-n*n,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,l=n+o;return a<0&&l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return c>=0?(n=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(n=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),u>=0?(s=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),h>=0?(a=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),n>l||a>r)||((a>n||n!=n)&&(n=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return null!==this.intersectBox(e,$r)}intersectTriangle(e,t,n,r,s){Wy.subVectors(t,e),Xd.subVectors(n,e),$y.crossVectors(Wy,Xd);let a,o=this.direction.dot($y);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}Ss.subVectors(this.origin,e);const l=a*this.direction.dot(Xd.crossVectors(Ss,Xd));if(l<0)return null;const c=a*this.direction.dot(Wy.cross(Ss));if(c<0||l+c>o)return null;const u=-a*Ss.dot($y);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Ke{constructor(){Ke.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,n,r,s,o,a,l,c,u,h,d,f,p,g,m){const y=this.elements;return y[0]=e,y[4]=t,y[8]=n,y[12]=r,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=c,y[6]=u,y[10]=h,y[14]=d,y[3]=f,y[7]=p,y[11]=g,y[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Ke).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/il.setFromMatrixColumn(e,0).length(),s=1/il.setFromMatrixColumn(e,1).length(),o=1/il.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if("XYZ"===e.order){const d=o*u,f=o*h,p=a*u,g=a*h;t[0]=l*u,t[4]=-l*h,t[8]=c,t[1]=f+p*c,t[5]=d-g*c,t[9]=-a*l,t[2]=g-d*c,t[6]=p+f*c,t[10]=o*l}else if("YXZ"===e.order){const d=l*u,f=l*h,p=c*u,g=c*h;t[0]=d+g*a,t[4]=p*a-f,t[8]=o*c,t[1]=o*h,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=g+d*a,t[10]=o*l}else if("ZXY"===e.order){const d=l*u,f=l*h,p=c*u,g=c*h;t[0]=d-g*a,t[4]=-o*h,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=g-d*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const d=o*u,f=o*h,p=a*u,g=a*h;t[0]=l*u,t[4]=p*c-f,t[8]=d*c+g,t[1]=l*h,t[5]=g*c+d,t[9]=f*c-p,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const d=o*l,f=o*c,p=a*l,g=a*c;t[0]=l*u,t[4]=g-d*h,t[8]=p*h+f,t[1]=h,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*h+p,t[10]=d-g*h}else if("XZY"===e.order){const d=o*l,f=o*c,p=a*l,g=a*c;t[0]=l*u,t[4]=-h,t[8]=c*u,t[1]=d*h+g,t[5]=o*u,t[9]=f*h-p,t[2]=p*h-f,t[6]=a*u,t[10]=g*h+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(gB,e,mB)}lookAt(e,t,n){const r=this.elements;return Mi.subVectors(e,t),0===Mi.lengthSq()&&(Mi.z=1),Mi.normalize(),Cs.crossVectors(n,Mi),0===Cs.lengthSq()&&(1===Math.abs(n.z)?Mi.x+=1e-4:Mi.z+=1e-4,Mi.normalize(),Cs.crossVectors(n,Mi)),Cs.normalize(),Qd.crossVectors(Mi,Cs),r[0]=Cs.x,r[4]=Qd.x,r[8]=Mi.x,r[1]=Cs.y,r[5]=Qd.y,r[9]=Mi.y,r[2]=Cs.z,r[6]=Qd.z,r[10]=Mi.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[4],l=n[8],c=n[12],u=n[1],h=n[5],d=n[9],f=n[13],p=n[2],g=n[6],m=n[10],y=n[14],_=n[3],v=n[7],x=n[11],b=n[15],S=r[0],T=r[4],w=r[8],C=r[12],I=r[1],F=r[5],Z=r[9],k=r[13],L=r[2],U=r[6],G=r[10],te=r[14],z=r[3],ne=r[7],Q=r[11],B=r[15];return s[0]=o*S+a*I+l*L+c*z,s[4]=o*T+a*F+l*U+c*ne,s[8]=o*w+a*Z+l*G+c*Q,s[12]=o*C+a*k+l*te+c*B,s[1]=u*S+h*I+d*L+f*z,s[5]=u*T+h*F+d*U+f*ne,s[9]=u*w+h*Z+d*G+f*Q,s[13]=u*C+h*k+d*te+f*B,s[2]=p*S+g*I+m*L+y*z,s[6]=p*T+g*F+m*U+y*ne,s[10]=p*w+g*Z+m*G+y*Q,s[14]=p*C+g*k+m*te+y*B,s[3]=_*S+v*I+x*L+b*z,s[7]=_*T+v*F+x*U+b*ne,s[11]=_*w+v*Z+x*G+b*Q,s[15]=_*C+v*k+x*te+b*B,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],h=e[6],d=e[10],f=e[14];return e[3]*(+s*l*h-r*c*h-s*a*d+n*c*d+r*a*f-n*l*f)+e[7]*(+t*l*f-t*c*d+s*o*d-r*o*f+r*c*u-s*l*u)+e[11]*(+t*c*h-t*a*f-s*o*h+n*o*f+s*a*u-n*c*u)+e[15]*(-r*a*u-t*l*h+t*a*d+r*o*h-n*o*d+n*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],m=e[14],y=e[15],_=h*m*c-g*d*c+g*l*f-a*m*f-h*l*y+a*d*y,v=p*d*c-u*m*c-p*l*f+o*m*f+u*l*y-o*d*y,x=u*g*c-p*h*c+p*a*f-o*g*f-u*a*y+o*h*y,b=p*h*l-u*g*l-p*a*d+o*g*d+u*a*m-o*h*m,S=t*_+n*v+r*x+s*b;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/S;return e[0]=_*T,e[1]=(g*d*s-h*m*s-g*r*f+n*m*f+h*r*y-n*d*y)*T,e[2]=(a*m*s-g*l*s+g*r*c-n*m*c-a*r*y+n*l*y)*T,e[3]=(h*l*s-a*d*s-h*r*c+n*d*c+a*r*f-n*l*f)*T,e[4]=v*T,e[5]=(u*m*s-p*d*s+p*r*f-t*m*f-u*r*y+t*d*y)*T,e[6]=(p*l*s-o*m*s-p*r*c+t*m*c+o*r*y-t*l*y)*T,e[7]=(o*d*s-u*l*s+u*r*c-t*d*c-o*r*f+t*l*f)*T,e[8]=x*T,e[9]=(p*h*s-u*g*s-p*n*f+t*g*f+u*n*y-t*h*y)*T,e[10]=(o*g*s-p*a*s+p*n*c-t*g*c-o*n*y+t*a*y)*T,e[11]=(u*a*s-o*h*s-u*n*c+t*h*c+o*n*f-t*a*f)*T,e[12]=b*T,e[13]=(u*g*r-p*h*r+p*n*d-t*g*d-u*n*m+t*h*m)*T,e[14]=(p*a*r-o*g*r-p*n*l+t*g*l+o*n*m-t*a*m)*T,e[15]=(o*h*r-u*a*r+u*n*l-t*h*l-o*n*d+t*a*d)*T,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+n,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+n,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,h=a+a,d=s*c,f=s*u,p=s*h,g=o*u,m=o*h,y=a*h,_=l*c,v=l*u,x=l*h,b=n.x,S=n.y,T=n.z;return r[0]=(1-(g+y))*b,r[1]=(f+x)*b,r[2]=(p-v)*b,r[3]=0,r[4]=(f-x)*S,r[5]=(1-(d+y))*S,r[6]=(m+_)*S,r[7]=0,r[8]=(p+v)*T,r[9]=(m-_)*T,r[10]=(1-(d+g))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let s=il.set(r[0],r[1],r[2]).length();const o=il.set(r[4],r[5],r[6]).length(),a=il.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],rr.copy(this);const c=1/s,u=1/o,h=1/a;return rr.elements[0]*=c,rr.elements[1]*=c,rr.elements[2]*=c,rr.elements[4]*=u,rr.elements[5]*=u,rr.elements[6]*=u,rr.elements[8]*=h,rr.elements[9]*=h,rr.elements[10]*=h,t.setFromRotationMatrix(rr),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,r,s,o){const a=this.elements,c=2*s/(n-r),u=(t+e)/(t-e),h=(n+r)/(n-r),d=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=2*s/(t-e),a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,r,s,o){const a=this.elements,l=1/(t-e),c=1/(n-r),u=1/(o-s),h=(t+e)*l,d=(n+r)*c,f=(o+s)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const il=new E,rr=new Ke,gB=new E(0,0,0),mB=new E(1,1,1),Cs=new E,Qd=new E,Mi=new E,nE=new Ke,iE=new bi;let yB=(()=>{class i{constructor(t=0,n=0,r=0,s=i.DefaultOrder){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,s=this._order){return this._x=t,this._y=n,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],u=s[5],h=s[9],d=s[2],f=s[6],p=s[10];switch(n){case"XYZ":this._y=Math.asin(Zt(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Zt(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-d,o),this._z=0);break;case"ZXY":this._x=Math.asin(Zt(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-d,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-Zt(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(Zt(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(l,p));break;case"XZY":this._z=Math.asin(-Zt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-h,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return nE.makeRotationFromQuaternion(t),this.setFromRotationMatrix(nE,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return iE.setFromEuler(this),this.setFromQuaternion(iE,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}return i.DefaultOrder="XYZ",i.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],i})();class jy{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let vB=0;const rE=new E,rl=new bi,jr=new Ke,ef=new E,ru=new E,_B=new E,xB=new bi,sE=new E(1,0,0),oE=new E(0,1,0),aE=new E(0,0,1),wB={type:"added"},lE={type:"removed"};let ki=(()=>{class i extends Ja{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:vB++}),this.uuid=wi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=i.DefaultUp.clone();const t=new E,n=new yB,r=new bi,s=new E(1,1,1);n._onChange(function o(){r.setFromEuler(n,!1)}),r._onChange(function a(){n.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Ke},normalMatrix:{value:new ci}}),this.matrix=new Ke,this.matrixWorld=new Ke,this.matrixAutoUpdate=i.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=i.DefaultMatrixWorldAutoUpdate,this.layers=new jy,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return rl.setFromAxisAngle(t,n),this.quaternion.multiply(rl),this}rotateOnWorldAxis(t,n){return rl.setFromAxisAngle(t,n),this.quaternion.premultiply(rl),this}rotateX(t){return this.rotateOnAxis(sE,t)}rotateY(t){return this.rotateOnAxis(oE,t)}rotateZ(t){return this.rotateOnAxis(aE,t)}translateOnAxis(t,n){return rE.copy(t).applyQuaternion(this.quaternion),this.position.add(rE.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis(sE,t)}translateY(t){return this.translateOnAxis(oE,t)}translateZ(t){return this.translateOnAxis(aE,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(jr.copy(this.matrixWorld).invert())}lookAt(t,n,r){t.isVector3?ef.copy(t):ef.set(t,n,r);const s=this.parent;this.updateWorldMatrix(!0,!1),ru.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?jr.lookAt(ru,ef,this.up):jr.lookAt(ef,ru,this.up),this.quaternion.setFromRotationMatrix(jr),s&&(jr.extractRotation(s.matrixWorld),rl.setFromRotationMatrix(jr),this.quaternion.premultiply(rl.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(wB)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(lE)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const n=this.children[t];n.parent=null,n.dispatchEvent(lE)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),jr.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),jr.multiply(t.parent.matrixWorld)),t.applyMatrix4(jr),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,n);if(void 0!==a)return a}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ru,t,_B),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ru,xB,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverseVisible(t)}traverseAncestors(t){const n=this.parent;null!==n&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const n=this.children;for(let r=0,s=n.length;r<s;r++){const o=n[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,n){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===n){const s=this.children;for(let o=0,a=s.length;o<a;o++){const l=s[o];!0===l.matrixWorldAutoUpdate&&l.updateWorldMatrix(!1,!0)}}}toJSON(t){const n=void 0===t||"string"==typeof t,r={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const s={};function o(l,c){return void 0===l[c.uuid]&&(l[c.uuid]=c.toJSON(t)),c.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const c=l.shapes;if(Array.isArray(c))for(let u=0,h=c.length;u<h;u++)o(t.shapes,c[u]);else o(t.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let c=0,u=this.material.length;c<u;c++)l.push(o(t.materials,this.material[c]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++)s.animations.push(o(t.animations,this.animations[l]))}if(n){const l=a(t.geometries),c=a(t.materials),u=a(t.textures),h=a(t.images),d=a(t.shapes),f=a(t.skeletons),p=a(t.animations),g=a(t.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),u.length>0&&(r.textures=u),h.length>0&&(r.images=h),d.length>0&&(r.shapes=d),f.length>0&&(r.skeletons=f),p.length>0&&(r.animations=p),g.length>0&&(r.nodes=g)}return r.object=s,r;function a(l){const c=[];for(const u in l){const h=l[u];delete h.metadata,c.push(h)}return c}}clone(t){return(new this.constructor).copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===n)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return i.DefaultUp=new E(0,1,0),i.DefaultMatrixAutoUpdate=!0,i.DefaultMatrixWorldAutoUpdate=!0,i})();const sr=new E,qr=new E,qy=new E,Jr=new E,sl=new E,ol=new E,cE=new E,Jy=new E,Yy=new E,Zy=new E;class or{constructor(e=new E,t=new E,n=new E){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),sr.subVectors(e,t),r.cross(sr);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){sr.subVectors(r,t),qr.subVectors(n,t),qy.subVectors(e,t);const o=sr.dot(sr),a=sr.dot(qr),l=sr.dot(qy),c=qr.dot(qr),u=qr.dot(qy),h=o*c-a*a;if(0===h)return s.set(-2,-1,-1);const d=1/h,f=(c*l-a*u)*d,p=(o*u-a*l)*d;return s.set(1-f-p,p,f)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Jr),Jr.x>=0&&Jr.y>=0&&Jr.x+Jr.y<=1}static getUV(e,t,n,r,s,o,a,l){return this.getBarycoord(e,t,n,r,Jr),l.set(0,0),l.addScaledVector(s,Jr.x),l.addScaledVector(o,Jr.y),l.addScaledVector(a,Jr.z),l}static isFrontFacing(e,t,n,r){return sr.subVectors(n,t),qr.subVectors(e,t),sr.cross(qr).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return sr.subVectors(this.c,this.b),qr.subVectors(this.a,this.b),.5*sr.cross(qr).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return or.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return or.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,s){return or.getUV(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return or.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return or.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let o,a;sl.subVectors(r,n),ol.subVectors(s,n),Jy.subVectors(e,n);const l=sl.dot(Jy),c=ol.dot(Jy);if(l<=0&&c<=0)return t.copy(n);Yy.subVectors(e,r);const u=sl.dot(Yy),h=ol.dot(Yy);if(u>=0&&h<=u)return t.copy(r);const d=l*h-u*c;if(d<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(n).addScaledVector(sl,o);Zy.subVectors(e,s);const f=sl.dot(Zy),p=ol.dot(Zy);if(p>=0&&f<=p)return t.copy(s);const g=f*c-l*p;if(g<=0&&c>=0&&p<=0)return a=c/(c-p),t.copy(n).addScaledVector(ol,a);const m=u*p-f*h;if(m<=0&&h-u>=0&&f-p>=0)return cE.subVectors(s,r),a=(h-u)/(h-u+(f-p)),t.copy(r).addScaledVector(cE,a);const y=1/(m+g+d);return o=g*y,a=d*y,t.copy(n).addScaledVector(sl,o).addScaledVector(ol,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let bB=0;class al extends Ja{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:bB++}),this.uuid=wi(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class xo extends al{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new _e(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const sn=new E,tf=new ee;class bn{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)tf.fromBufferAttribute(this,t),tf.applyMatrix3(e),this.setXY(t,tf.x,tf.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)sn.fromBufferAttribute(this,t),sn.applyMatrix3(e),this.setXYZ(t,sn.x,sn.y,sn.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)sn.fromBufferAttribute(this,t),sn.applyMatrix4(e),this.setXYZ(t,sn.x,sn.y,sn.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)sn.fromBufferAttribute(this,t),sn.applyNormalMatrix(e),this.setXYZ(t,sn.x,sn.y,sn.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)sn.fromBufferAttribute(this,t),sn.transformDirection(e),this.setXYZ(t,sn.x,sn.y,sn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Gr(t,this.array)),t}setX(e,t){return this.normalized&&(t=At(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Gr(t,this.array)),t}setY(e,t){return this.normalized&&(t=At(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Gr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=At(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Gr(t,this.array)),t}setW(e,t){return this.normalized&&(t=At(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=At(t,this.array),n=At(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=At(t,this.array),n=At(n,this.array),r=At(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=At(t,this.array),n=At(n,this.array),r=At(r,this.array),s=At(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class uE extends bn{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class hE extends bn{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class we extends bn{constructor(e,t,n){super(new Float32Array(e),t,n)}}let MB=0;const zi=new Ke,Xy=new ki,ll=new E,Si=new Ka,su=new Ka,Mn=new E;class ot extends Ja{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:MB++}),this.uuid=wi(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(XD(e)?hE:uE)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const s=(new ci).getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return zi.makeRotationFromQuaternion(e),this.applyMatrix4(zi),this}rotateX(e){return zi.makeRotationX(e),this.applyMatrix4(zi),this}rotateY(e){return zi.makeRotationY(e),this.applyMatrix4(zi),this}rotateZ(e){return zi.makeRotationZ(e),this.applyMatrix4(zi),this}translate(e,t,n){return zi.makeTranslation(e,t,n),this.applyMatrix4(zi),this}scale(e,t,n){return zi.makeScale(e,t,n),this.applyMatrix4(zi),this}lookAt(e){return Xy.lookAt(e),Xy.updateMatrix(),this.applyMatrix4(Xy.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ll).negate(),this.translate(ll.x,ll.y,ll.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new we(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Ka);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new E(-1/0,-1/0,-1/0),new E(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++)Si.setFromBufferAttribute(t[n]),this.morphTargetsRelative?(Mn.addVectors(this.boundingBox.min,Si.min),this.boundingBox.expandByPoint(Mn),Mn.addVectors(this.boundingBox.max,Si.max),this.boundingBox.expandByPoint(Mn)):(this.boundingBox.expandByPoint(Si.min),this.boundingBox.expandByPoint(Si.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new nl);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new E,1/0);if(e){const n=this.boundingSphere.center;if(Si.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)su.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(Mn.addVectors(Si.min,su.min),Si.expandByPoint(Mn),Mn.addVectors(Si.max,su.max),Si.expandByPoint(Mn)):(Si.expandByPoint(su.min),Si.expandByPoint(su.max));Si.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)Mn.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(Mn));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)Mn.fromBufferAttribute(a,c),l&&(ll.fromBufferAttribute(e,c),Mn.add(ll)),r=Math.max(r,n.distanceToSquared(Mn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new bn(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let I=0;I<a;I++)c[I]=new E,u[I]=new E;const h=new E,d=new E,f=new E,p=new ee,g=new ee,m=new ee,y=new E,_=new E;function v(I,F,Z){h.fromArray(r,3*I),d.fromArray(r,3*F),f.fromArray(r,3*Z),p.fromArray(o,2*I),g.fromArray(o,2*F),m.fromArray(o,2*Z),d.sub(h),f.sub(h),g.sub(p),m.sub(p);const k=1/(g.x*m.y-m.x*g.y);!isFinite(k)||(y.copy(d).multiplyScalar(m.y).addScaledVector(f,-g.y).multiplyScalar(k),_.copy(f).multiplyScalar(g.x).addScaledVector(d,-m.x).multiplyScalar(k),c[I].add(y),c[F].add(y),c[Z].add(y),u[I].add(_),u[F].add(_),u[Z].add(_))}let x=this.groups;0===x.length&&(x=[{start:0,count:n.length}]);for(let I=0,F=x.length;I<F;++I){const Z=x[I],k=Z.start;for(let U=k,G=k+Z.count;U<G;U+=3)v(n[U+0],n[U+1],n[U+2])}const b=new E,S=new E,T=new E,w=new E;function C(I){T.fromArray(s,3*I),w.copy(T);const F=c[I];b.copy(F),b.sub(T.multiplyScalar(T.dot(F))).normalize(),S.crossVectors(w,F);const k=S.dot(u[I])<0?-1:1;l[4*I]=b.x,l[4*I+1]=b.y,l[4*I+2]=b.z,l[4*I+3]=k}for(let I=0,F=x.length;I<F;++I){const Z=x[I],k=Z.start;for(let U=k,G=k+Z.count;U<G;U+=3)C(n[U+0]),C(n[U+1]),C(n[U+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new bn(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let d=0,f=n.count;d<f;d++)n.setXYZ(d,0,0,0);const r=new E,s=new E,o=new E,a=new E,l=new E,c=new E,u=new E,h=new E;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),g=e.getX(d+1),m=e.getX(d+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,g),o.fromBufferAttribute(t,m),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,g),c.fromBufferAttribute(n,m),a.add(u),l.add(u),c.add(u),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(g,l.x,l.y,l.z),n.setXYZ(m,c.x,c.y,c.z)}else for(let d=0,f=t.count;d<f;d+=3)r.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),n.setXYZ(d+0,u.x,u.y,u.z),n.setXYZ(d+1,u.x,u.y,u.z),n.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Mn.fromBufferAttribute(e,t),Mn.normalize(),e.setXYZ(t,Mn.x,Mn.y,Mn.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,h=a.normalized,d=new c.constructor(l.length*u);let f=0,p=0;for(let g=0,m=l.length;g<m;g++){f=a.isInterleavedBufferAttribute?l[g]*a.data.stride+a.offset:l[g]*u;for(let y=0;y<u;y++)d[p++]=c[f++]}return new bn(d,u,h)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new ot,n=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],n);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,h=c.length;u<h;u++){const f=e(c[u],n);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n)e.data.attributes[l]=n[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let h=0,d=c.length;h<d;h++)u.push(c[h].toJSON(e.data));u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const u=[],h=s[c];for(let d=0,f=h.length;d<f;d++)u.push(h[d].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const h=o[c];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const dE=new Ke,cl=new Kd,Ky=new nl,Ds=new E,Es=new E,As=new E,Qy=new E,ev=new E,tv=new E,nf=new E,rf=new E,sf=new E,af=new ee,lf=new ee,cf=new ee,nv=new E,uf=new E;class Vn extends ki{constructor(e=new ot,t=new xo){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===n.boundingSphere&&n.computeBoundingSphere(),Ky.copy(n.boundingSphere),Ky.applyMatrix4(s),!1===e.ray.intersectsSphere(Ky))||(dE.copy(s).invert(),cl.copy(e.ray).applyMatrix4(dE),null!==n.boundingBox&&!1===cl.intersectsBox(n.boundingBox)))return;let o;const a=n.index,l=n.attributes.position,c=n.morphAttributes.position,u=n.morphTargetsRelative,h=n.attributes.uv,d=n.attributes.uv2,f=n.groups,p=n.drawRange;if(null!==a)if(Array.isArray(r))for(let g=0,m=f.length;g<m;g++){const y=f[g],_=r[y.materialIndex];for(let b=Math.max(y.start,p.start),S=Math.min(a.count,Math.min(y.start+y.count,p.start+p.count));b<S;b+=3){const T=a.getX(b),w=a.getX(b+1),C=a.getX(b+2);o=hf(this,_,e,cl,l,c,u,h,d,T,w,C),o&&(o.faceIndex=Math.floor(b/3),o.face.materialIndex=y.materialIndex,t.push(o))}}else for(let y=Math.max(0,p.start),_=Math.min(a.count,p.start+p.count);y<_;y+=3){const v=a.getX(y),x=a.getX(y+1),b=a.getX(y+2);o=hf(this,r,e,cl,l,c,u,h,d,v,x,b),o&&(o.faceIndex=Math.floor(y/3),t.push(o))}else if(void 0!==l)if(Array.isArray(r))for(let g=0,m=f.length;g<m;g++){const y=f[g],_=r[y.materialIndex];for(let b=Math.max(y.start,p.start),S=Math.min(l.count,Math.min(y.start+y.count,p.start+p.count));b<S;b+=3)o=hf(this,_,e,cl,l,c,u,h,d,b,b+1,b+2),o&&(o.faceIndex=Math.floor(b/3),o.face.materialIndex=y.materialIndex,t.push(o))}else for(let y=Math.max(0,p.start),_=Math.min(l.count,p.start+p.count);y<_;y+=3)o=hf(this,r,e,cl,l,c,u,h,d,y,y+1,y+2),o&&(o.faceIndex=Math.floor(y/3),t.push(o))}}function hf(i,e,t,n,r,s,o,a,l,c,u,h){Ds.fromBufferAttribute(r,c),Es.fromBufferAttribute(r,u),As.fromBufferAttribute(r,h);const d=i.morphTargetInfluences;if(s&&d){nf.set(0,0,0),rf.set(0,0,0),sf.set(0,0,0);for(let p=0,g=s.length;p<g;p++){const m=d[p],y=s[p];0!==m&&(Qy.fromBufferAttribute(y,c),ev.fromBufferAttribute(y,u),tv.fromBufferAttribute(y,h),o?(nf.addScaledVector(Qy,m),rf.addScaledVector(ev,m),sf.addScaledVector(tv,m)):(nf.addScaledVector(Qy.sub(Ds),m),rf.addScaledVector(ev.sub(Es),m),sf.addScaledVector(tv.sub(As),m)))}Ds.add(nf),Es.add(rf),As.add(sf)}i.isSkinnedMesh&&(i.boneTransform(c,Ds),i.boneTransform(u,Es),i.boneTransform(h,As));const f=function SB(i,e,t,n,r,s,o,a){let l;if(l=1===e.side?n.intersectTriangle(o,s,r,!0,a):n.intersectTriangle(r,s,o,2!==e.side,a),null===l)return null;uf.copy(a),uf.applyMatrix4(i.matrixWorld);const c=t.ray.origin.distanceTo(uf);return c<t.near||c>t.far?null:{distance:c,point:uf.clone(),object:i}}(i,e,t,n,Ds,Es,As,nv);if(f){a&&(af.fromBufferAttribute(a,c),lf.fromBufferAttribute(a,u),cf.fromBufferAttribute(a,h),f.uv=or.getUV(nv,Ds,Es,As,af,lf,cf,new ee)),l&&(af.fromBufferAttribute(l,c),lf.fromBufferAttribute(l,u),cf.fromBufferAttribute(l,h),f.uv2=or.getUV(nv,Ds,Es,As,af,lf,cf,new ee));const p={a:c,b:u,c:h,normal:new E,materialIndex:0};or.getNormal(Ds,Es,As,p.normal),f.face=p}return f}class ul extends ot{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],h=[];let d=0,f=0;function p(g,m,y,_,v,x,b,S,T,w,C){const I=x/T,F=b/w,Z=x/2,k=b/2,L=S/2,U=T+1,G=w+1;let te=0,z=0;const ne=new E;for(let Q=0;Q<G;Q++){const B=Q*F-k;for(let H=0;H<U;H++)ne[g]=(H*I-Z)*_,ne[m]=B*v,ne[y]=L,c.push(ne.x,ne.y,ne.z),ne[g]=0,ne[m]=0,ne[y]=S>0?1:-1,u.push(ne.x,ne.y,ne.z),h.push(H/T),h.push(1-Q/w),te+=1}for(let Q=0;Q<w;Q++)for(let B=0;B<T;B++){const oe=d+B+U*(Q+1),se=d+(B+1)+U*(Q+1),ue=d+(B+1)+U*Q;l.push(d+B+U*Q,oe,ue),l.push(oe,se,ue),z+=6}a.addGroup(f,z,C),f+=z,d+=te}p("z","y","x",-1,-1,n,t,e,o,s,0),p("z","y","x",1,-1,n,t,-e,o,s,1),p("x","z","y",1,1,e,n,t,r,o,2),p("x","z","y",1,-1,e,n,-t,r,o,3),p("x","y","z",1,-1,e,t,n,r,s,4),p("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new we(c,3)),this.setAttribute("normal",new we(u,3)),this.setAttribute("uv",new we(h,2))}static fromJSON(e){return new ul(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function hl(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];e[t][n]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function Qn(i){const e={};for(let t=0;t<i.length;t++){const n=hl(i[t]);for(const r in n)e[r]=n[r]}return e}function fE(i){return null===i.getRenderTarget()&&i.outputEncoding===Ht?_r:Kc}const DB={clone:hl,merge:Qn};class Ts extends al{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=hl(e.uniforms),this.uniformsGroups=function CB(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class iv extends ki{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ke,this.projectionMatrix=new Ke,this.projectionMatrixInverse=new Ke}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Rn extends iv{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Qc*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*po*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Qc*Math.atan(Math.tan(.5*po*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*po*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*n/c,r*=o.width/l,n*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class TB extends ki{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n;const r=new Rn(-90,1,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);const s=new Rn(-90,1,e,t);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),this.add(s);const o=new Rn(-90,1,e,t);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(0,1,0),this.add(o);const a=new Rn(-90,1,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);const l=new Rn(-90,1,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,1),this.add(l);const c=new Rn(-90,1,e,t);c.layers=this.layers,c.up.set(0,1,0),c.lookAt(0,0,-1),this.add(c)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[r,s,o,a,l,c]=this.children,u=e.getRenderTarget(),h=e.toneMapping,d=e.xr.enabled;e.toneMapping=0,e.xr.enabled=!1;const f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,s),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,a),e.setRenderTarget(n,4),e.render(t,l),n.texture.generateMipmaps=f,e.setRenderTarget(n,5),e.render(t,c),e.setRenderTarget(u),e.toneMapping=h,e.xr.enabled=d,n.texture.needsPMREMUpdate=!0}}class df extends ws{constructor(e,t,n,r,s,o,a,l,c,u){super(e=void 0!==e?e:[],t=void 0!==t?t:301,n,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class IB extends mo{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1};this.texture=new df([n,n,n,n,n,n],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:rn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n_uniforms={tEquirect:{value:null}},n_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",n_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new ul(5,5,5),s=new Ts({name:"CubemapFromEquirect",uniforms:hl(n_uniforms),vertexShader:n_vertexShader,fragmentShader:n_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new Vn(r,s),a=t.minFilter;return 1008===t.minFilter&&(t.minFilter=rn),new TB(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(s)}}const rv=new E,RB=new E,PB=new ci;class wo{constructor(e=new E(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=rv.subVectors(n,t).cross(RB.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(rv),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(n).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||PB.getNormalMatrix(e),r=this.coplanarPoint(rv).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const pl=new nl,ff=new E;class sv{constructor(e=new wo,t=new wo,n=new wo,r=new wo,s=new wo,o=new wo){this.planes=[e,t,n,r,s,o]}set(e,t,n,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,r=n[0],s=n[1],o=n[2],a=n[3],l=n[4],c=n[5],u=n[6],h=n[7],d=n[8],f=n[9],p=n[10],g=n[11],m=n[12],y=n[13],_=n[14],v=n[15];return t[0].setComponents(a-r,h-l,g-d,v-m).normalize(),t[1].setComponents(a+r,h+l,g+d,v+m).normalize(),t[2].setComponents(a+s,h+c,g+f,v+y).normalize(),t[3].setComponents(a-s,h-c,g-f,v-y).normalize(),t[4].setComponents(a-o,h-u,g-p,v-_).normalize(),t[5].setComponents(a+o,h+u,g+p,v+_).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),pl.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(pl)}intersectsSprite(e){return pl.center.set(0,0,0),pl.radius=.7071067811865476,pl.applyMatrix4(e.matrixWorld),this.intersectsSphere(pl)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(ff.x=r.normal.x>0?e.max.x:e.min.x,ff.y=r.normal.y>0?e.max.y:e.min.y,ff.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(ff)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function pE(){let i=null,e=!1,t=null,n=null;function r(s,o){t(s,o),n=i.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function LB(i,e){const t=e.isWebGL2,n=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),n.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=n.get(c);u&&(i.deleteBuffer(u.buffer),n.delete(c))},update:function l(c,u){if(c.isGLBufferAttribute){const d=n.get(c);return void((!d||d.version<c.version)&&n.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const h=n.get(c);void 0===h?n.set(c,function r(c,u){const h=c.array,d=c.usage,f=i.createBuffer();let p;if(i.bindBuffer(u,f),i.bufferData(u,h,d),c.onUploadCallback(),h instanceof Float32Array)p=5126;else if(h instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");p=5131}else p=5123;else if(h instanceof Int16Array)p=5122;else if(h instanceof Uint32Array)p=5125;else if(h instanceof Int32Array)p=5124;else if(h instanceof Int8Array)p=5120;else if(h instanceof Uint8Array)p=5121;else{if(!(h instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);p=5121}return{buffer:f,type:p,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version}}(c,u)):h.version<c.version&&(function s(c,u,h){const d=u.array,f=u.updateRange;i.bindBuffer(h,c),-1===f.count?i.bufferSubData(h,0,d):(t?i.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):i.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()}(h.buffer,c,u),h.version=c.version)}}}class pf extends ot{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(n),l=Math.floor(r),c=a+1,u=l+1,h=e/a,d=t/l,f=[],p=[],g=[],m=[];for(let y=0;y<u;y++){const _=y*d-o;for(let v=0;v<c;v++)p.push(v*h-s,-_,0),g.push(0,0,1),m.push(v/a),m.push(1-y/l)}for(let y=0;y<l;y++)for(let _=0;_<a;_++){const x=_+c*(y+1),b=_+1+c*(y+1),S=_+1+c*y;f.push(_+c*y,x,S),f.push(x,b,S)}this.setIndex(f),this.setAttribute("position",new we(p,3)),this.setAttribute("normal",new we(g,3)),this.setAttribute("uv",new we(m,2))}static fromJSON(e){return new pf(e.width,e.height,e.widthSegments,e.heightSegments)}}const tt={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if defined( USE_SHADOWMAP ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_COORDS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},ce={common:{diffuse:{value:new _e(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ci},uv2Transform:{value:new ci},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ee(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new _e(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new _e(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ci}},sprite:{diffuse:{value:new _e(16777215)},opacity:{value:1},center:{value:new ee(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ci}}},xr={basic:{uniforms:Qn([ce.common,ce.specularmap,ce.envmap,ce.aomap,ce.lightmap,ce.fog]),vertexShader:tt.meshbasic_vert,fragmentShader:tt.meshbasic_frag},lambert:{uniforms:Qn([ce.common,ce.specularmap,ce.envmap,ce.aomap,ce.lightmap,ce.emissivemap,ce.bumpmap,ce.normalmap,ce.displacementmap,ce.fog,ce.lights,{emissive:{value:new _e(0)}}]),vertexShader:tt.meshlambert_vert,fragmentShader:tt.meshlambert_frag},phong:{uniforms:Qn([ce.common,ce.specularmap,ce.envmap,ce.aomap,ce.lightmap,ce.emissivemap,ce.bumpmap,ce.normalmap,ce.displacementmap,ce.fog,ce.lights,{emissive:{value:new _e(0)},specular:{value:new _e(1118481)},shininess:{value:30}}]),vertexShader:tt.meshphong_vert,fragmentShader:tt.meshphong_frag},standard:{uniforms:Qn([ce.common,ce.envmap,ce.aomap,ce.lightmap,ce.emissivemap,ce.bumpmap,ce.normalmap,ce.displacementmap,ce.roughnessmap,ce.metalnessmap,ce.fog,ce.lights,{emissive:{value:new _e(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:tt.meshphysical_vert,fragmentShader:tt.meshphysical_frag},toon:{uniforms:Qn([ce.common,ce.aomap,ce.lightmap,ce.emissivemap,ce.bumpmap,ce.normalmap,ce.displacementmap,ce.gradientmap,ce.fog,ce.lights,{emissive:{value:new _e(0)}}]),vertexShader:tt.meshtoon_vert,fragmentShader:tt.meshtoon_frag},matcap:{uniforms:Qn([ce.common,ce.bumpmap,ce.normalmap,ce.displacementmap,ce.fog,{matcap:{value:null}}]),vertexShader:tt.meshmatcap_vert,fragmentShader:tt.meshmatcap_frag},points:{uniforms:Qn([ce.points,ce.fog]),vertexShader:tt.points_vert,fragmentShader:tt.points_frag},dashed:{uniforms:Qn([ce.common,ce.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:tt.linedashed_vert,fragmentShader:tt.linedashed_frag},depth:{uniforms:Qn([ce.common,ce.displacementmap]),vertexShader:tt.depth_vert,fragmentShader:tt.depth_frag},normal:{uniforms:Qn([ce.common,ce.bumpmap,ce.normalmap,ce.displacementmap,{opacity:{value:1}}]),vertexShader:tt.meshnormal_vert,fragmentShader:tt.meshnormal_frag},sprite:{uniforms:Qn([ce.sprite,ce.fog]),vertexShader:tt.sprite_vert,fragmentShader:tt.sprite_frag},background:{uniforms:{uvTransform:{value:new ci},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:tt.background_vert,fragmentShader:tt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:tt.backgroundCube_vert,fragmentShader:tt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:tt.cube_vert,fragmentShader:tt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:tt.equirect_vert,fragmentShader:tt.equirect_frag},distanceRGBA:{uniforms:Qn([ce.common,ce.displacementmap,{referencePosition:{value:new E},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:tt.distanceRGBA_vert,fragmentShader:tt.distanceRGBA_frag},shadow:{uniforms:Qn([ce.lights,ce.fog,{color:{value:new _e(0)},opacity:{value:1}}]),vertexShader:tt.shadow_vert,fragmentShader:tt.shadow_frag}};xr.physical={uniforms:Qn([xr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ee(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new _e(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ee},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new _e(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new _e(1,1,1)},specularColorMap:{value:null}}]),vertexShader:tt.meshphysical_vert,fragmentShader:tt.meshphysical_frag};const gf={r:0,b:0,g:0};function PV(i,e,t,n,r,s,o){const a=new _e(0);let c,u,l=!0===s?0:1,h=null,d=0,f=null;function g(m,y){m.getRGB(gf,fE(i)),n.buffers.color.setClear(gf.r,gf.g,gf.b,y,o)}return{getClearColor:function(){return a},setClearColor:function(m,y=1){a.set(m),l=y,g(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(m){l=m,g(a,l)},render:function p(m,y){let _=!1,v=!0===y.isScene?y.background:null;v&&v.isTexture&&(v=(y.backgroundBlurriness>0?t:e).get(v));const x=i.xr,b=x.getSession&&x.getSession();b&&"additive"===b.environmentBlendMode&&(v=null),null===v?g(a,l):v&&v.isColor&&(g(v,1),_=!0),(i.autoClear||_)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),v&&(v.isCubeTexture||306===v.mapping)?(void 0===u&&(u=new Vn(new ul(1,1,1),new Ts({name:"BackgroundCubeMaterial",uniforms:hl(xr.backgroundCube.uniforms),vertexShader:xr.backgroundCube.vertexShader,fragmentShader:xr.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(S,T,w){this.matrixWorld.copyPosition(w.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=v,u.material.uniforms.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=y.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,(h!==v||d!==v.version||f!==i.toneMapping)&&(u.material.needsUpdate=!0,h=v,d=v.version,f=i.toneMapping),u.layers.enableAll(),m.unshift(u,u.geometry,u.material,0,0,null)):v&&v.isTexture&&(void 0===c&&(c=new Vn(new pf(2,2),new Ts({name:"BackgroundMaterial",uniforms:hl(xr.background.uniforms),vertexShader:xr.background.vertexShader,fragmentShader:xr.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=v,c.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,!0===v.matrixAutoUpdate&&v.updateMatrix(),c.material.uniforms.uvTransform.value.copy(v.matrix),(h!==v||d!==v.version||f!==i.toneMapping)&&(c.material.needsUpdate=!0,h=v,d=v.version,f=i.toneMapping),c.layers.enableAll(),m.unshift(c,c.geometry,c.material,0,0,null))}}}function LV(i,e,t,n){const r=i.getParameter(34921),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),o=n.isWebGL2||null!==s,a={},l=m(null);let c=l,u=!1;function f(L){return n.isWebGL2?i.bindVertexArray(L):s.bindVertexArrayOES(L)}function p(L){return n.isWebGL2?i.deleteVertexArray(L):s.deleteVertexArrayOES(L)}function m(L){const U=[],G=[],te=[];for(let z=0;z<r;z++)U[z]=0,G[z]=0,te[z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:U,enabledAttributes:G,attributeDivisors:te,object:L,attributes:{},index:null}}function v(){const L=c.newAttributes;for(let U=0,G=L.length;U<G;U++)L[U]=0}function x(L){b(L,0)}function b(L,U){const te=c.enabledAttributes,z=c.attributeDivisors;c.newAttributes[L]=1,0===te[L]&&(i.enableVertexAttribArray(L),te[L]=1),z[L]!==U&&((n.isWebGL2?i:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](L,U),z[L]=U)}function S(){const L=c.newAttributes,U=c.enabledAttributes;for(let G=0,te=U.length;G<te;G++)U[G]!==L[G]&&(i.disableVertexAttribArray(G),U[G]=0)}function T(L,U,G,te,z,ne){!0!==n.isWebGL2||5124!==G&&5125!==G?i.vertexAttribPointer(L,U,G,te,z,ne):i.vertexAttribIPointer(L,U,G,z,ne)}function Z(){k(),u=!0,c!==l&&(c=l,f(c.object))}function k(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function h(L,U,G,te,z){let ne=!1;if(o){const Q=function g(L,U,G){const te=!0===G.wireframe;let z=a[L.id];void 0===z&&(z={},a[L.id]=z);let ne=z[U.id];void 0===ne&&(ne={},z[U.id]=ne);let Q=ne[te];return void 0===Q&&(Q=m(function d(){return n.isWebGL2?i.createVertexArray():s.createVertexArrayOES()}()),ne[te]=Q),Q}(te,G,U);c!==Q&&(c=Q,f(c.object)),ne=function y(L,U,G,te){const z=c.attributes,ne=U.attributes;let Q=0;const B=G.getAttributes();for(const H in B)if(B[H].location>=0){const se=z[H];let ue=ne[H];if(void 0===ue&&("instanceMatrix"===H&&L.instanceMatrix&&(ue=L.instanceMatrix),"instanceColor"===H&&L.instanceColor&&(ue=L.instanceColor)),void 0===se||se.attribute!==ue||ue&&se.data!==ue.data)return!0;Q++}return c.attributesNum!==Q||c.index!==te}(L,te,G,z),ne&&function _(L,U,G,te){const z={},ne=U.attributes;let Q=0;const B=G.getAttributes();for(const H in B)if(B[H].location>=0){let se=ne[H];void 0===se&&("instanceMatrix"===H&&L.instanceMatrix&&(se=L.instanceMatrix),"instanceColor"===H&&L.instanceColor&&(se=L.instanceColor));const ue={};ue.attribute=se,se&&se.data&&(ue.data=se.data),z[H]=ue,Q++}c.attributes=z,c.attributesNum=Q,c.index=te}(L,te,G,z)}else{const Q=!0===U.wireframe;(c.geometry!==te.id||c.program!==G.id||c.wireframe!==Q)&&(c.geometry=te.id,c.program=G.id,c.wireframe=Q,ne=!0)}null!==z&&t.update(z,34963),(ne||u)&&(u=!1,function w(L,U,G,te){if(!1===n.isWebGL2&&(L.isInstancedMesh||te.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;v();const z=te.attributes,ne=G.getAttributes(),Q=U.defaultAttributeValues;for(const B in ne){const H=ne[B];if(H.location>=0){let oe=z[B];if(void 0===oe&&("instanceMatrix"===B&&L.instanceMatrix&&(oe=L.instanceMatrix),"instanceColor"===B&&L.instanceColor&&(oe=L.instanceColor)),void 0!==oe){const se=oe.normalized,ue=oe.itemSize,j=t.get(oe);if(void 0===j)continue;const Ge=j.buffer,xe=j.type,Ue=j.bytesPerElement;if(oe.isInterleavedBufferAttribute){const pe=oe.data,it=pe.stride,X=oe.offset;if(pe.isInstancedInterleavedBuffer){for(let Y=0;Y<H.locationSize;Y++)b(H.location+Y,pe.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===te._maxInstanceCount&&(te._maxInstanceCount=pe.meshPerAttribute*pe.count)}else for(let Y=0;Y<H.locationSize;Y++)x(H.location+Y);i.bindBuffer(34962,Ge);for(let Y=0;Y<H.locationSize;Y++)T(H.location+Y,ue/H.locationSize,xe,se,it*Ue,(X+ue/H.locationSize*Y)*Ue)}else{if(oe.isInstancedBufferAttribute){for(let pe=0;pe<H.locationSize;pe++)b(H.location+pe,oe.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===te._maxInstanceCount&&(te._maxInstanceCount=oe.meshPerAttribute*oe.count)}else for(let pe=0;pe<H.locationSize;pe++)x(H.location+pe);i.bindBuffer(34962,Ge);for(let pe=0;pe<H.locationSize;pe++)T(H.location+pe,ue/H.locationSize,xe,se,ue*Ue,ue/H.locationSize*pe*Ue)}}else if(void 0!==Q){const se=Q[B];if(void 0!==se)switch(se.length){case 2:i.vertexAttrib2fv(H.location,se);break;case 3:i.vertexAttrib3fv(H.location,se);break;case 4:i.vertexAttrib4fv(H.location,se);break;default:i.vertexAttrib1fv(H.location,se)}}}}S()}(L,U,G,te),null!==z&&i.bindBuffer(34963,t.get(z).buffer))},reset:Z,resetDefaultState:k,dispose:function C(){Z();for(const L in a){const U=a[L];for(const G in U){const te=U[G];for(const z in te)p(te[z].object),delete te[z];delete U[G]}delete a[L]}},releaseStatesOfGeometry:function I(L){if(void 0===a[L.id])return;const U=a[L.id];for(const G in U){const te=U[G];for(const z in te)p(te[z].object),delete te[z];delete U[G]}delete a[L.id]},releaseStatesOfProgram:function F(L){for(const U in a){const G=a[U];if(void 0===G[L.id])continue;const te=G[L.id];for(const z in te)p(te[z].object),delete te[z];delete G[L.id]}},initAttributes:v,enableAttribute:x,disableUnusedAttributes:S}}function NV(i,e,t,n){const r=n.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,u){i.drawArrays(s,c,u),t.update(u,s,1)},this.renderInstances=function l(c,u,h){if(0===h)return;let d,f;if(r)d=i,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===d)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[f](s,c,u,h),t.update(u,s,h)}}function OV(i,e,t){let n;function s(T){if("highp"===T){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";T="mediump"}return"mediump"===T&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&i instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&i instanceof WebGL2ComputeRenderingContext;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,h=i.getParameter(34930),d=i.getParameter(35660),f=i.getParameter(3379),p=i.getParameter(34076),g=i.getParameter(34921),m=i.getParameter(36347),y=i.getParameter(36348),_=i.getParameter(36349),v=d>0,x=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==n)return n;if(!0===e.has("EXT_texture_filter_anisotropic")){const T=e.get("EXT_texture_filter_anisotropic");n=i.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:g,maxVertexUniforms:m,maxVaryings:y,maxFragmentUniforms:_,vertexTextures:v,floatFragmentTextures:x,floatVertexTextures:v&&x,maxSamples:o?i.getParameter(36183):0}}function FV(i){const e=this;let t=null,n=0,r=!1,s=!1;const o=new wo,a=new ci,l={value:null,needsUpdate:!1};function c(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function u(h,d,f,p){const g=null!==h?h.length:0;let m=null;if(0!==g){if(m=l.value,!0!==p||null===m){const y=f+4*g,_=d.matrixWorldInverse;a.getNormalMatrix(_),(null===m||m.length<y)&&(m=new Float32Array(y));for(let v=0,x=f;v!==g;++v,x+=4)o.copy(h[v]).applyMatrix4(_,a),o.normal.toArray(m,x),m[x+3]=o.constant}l.value=m,l.needsUpdate=!0}return e.numPlanes=g,e.numIntersection=0,m}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d,f){const p=0!==h.length||d||0!==n||r;return r=d,t=u(h,f,0),n=h.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,c()},this.setState=function(h,d,f){const p=h.clippingPlanes,g=h.clipIntersection,m=h.clipShadows,y=i.get(h);if(!r||null===p||0===p.length||s&&!m)s?u(null):c();else{const _=s?0:n,v=4*_;let x=y.clippingState||null;l.value=x,x=u(p,d,v,f);for(let b=0;b!==v;++b)x[b]=t[b];y.clippingState=x,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=_}}}function kV(i){let e=new WeakMap;function t(o,a){return 303===a?o.mapping=301:304===a&&(o.mapping=302),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function n(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(303===a||304===a){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new IB(l.height/2);return c.fromEquirectangularTexture(i,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class ov extends iv{constructor(e=-1,t=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,o=n+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const gE=[.125,.215,.35,.446,.526,.582],av=new ov,mE=new _e;let lv=null;const Mo=(1+Math.sqrt(5))/2,ml=1/Mo,yE=[new E(1,1,1),new E(-1,1,1),new E(1,1,-1),new E(-1,1,-1),new E(0,Mo,ml),new E(0,Mo,-ml),new E(ml,0,Mo),new E(-ml,0,Mo),new E(Mo,ml,0),new E(-Mo,ml,0)];class vE{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){lv=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=wE(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=xE(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(lv),e.scissorTest=!1,mf(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),lv=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:rn,minFilter:rn,generateMipmaps:!1,type:Xc,format:Fi,encoding:ho,depthBuffer:!1},r=_E(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=_E(e,t,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function zV(i){const e=[],t=[],n=[];let r=i;const s=i-4+1+gE.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>i-4?l=gE[o-i+4-1]:0===o&&(l=0),n.push(l);const c=1/(a-2),u=-c,h=1+c,d=[u,u,h,u,h,h,u,u,h,h,u,h],f=6,p=6,g=3,m=2,y=1,_=new Float32Array(g*p*f),v=new Float32Array(m*p*f),x=new Float32Array(y*p*f);for(let S=0;S<f;S++){const T=S%3*2/3-1,w=S>2?0:-1;_.set([T,w,0,T+2/3,w,0,T+2/3,w+1,0,T,w,0,T+2/3,w+1,0,T,w+1,0],g*p*S),v.set(d,m*p*S),x.set([S,S,S,S,S,S],y*p*S)}const b=new ot;b.setAttribute("position",new bn(_,g)),b.setAttribute("uv",new bn(v,m)),b.setAttribute("faceIndex",new bn(x,y)),e.push(b),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}(s)),this._blurMaterial=function BV(i,e,t){const n=new Float32Array(20),r=new E(0,1,0);return new Ts({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new Vn(this._lodPlanes[0],e);this._renderer.compile(t,av)}_sceneToCubeUV(e,t,n,r){const a=new Rn(90,1,t,n),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,d=u.toneMapping;u.getClearColor(mE),u.toneMapping=0,u.autoClear=!1;const f=new xo({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),p=new Vn(new ul,f);let g=!1;const m=e.background;m?m.isColor&&(f.color.copy(m),e.background=null,g=!0):(f.color.copy(mE),g=!0);for(let y=0;y<6;y++){const _=y%3;0===_?(a.up.set(0,l[y],0),a.lookAt(c[y],0,0)):1===_?(a.up.set(0,0,l[y]),a.lookAt(0,c[y],0)):(a.up.set(0,l[y],0),a.lookAt(0,0,c[y]));const v=this._cubeSize;mf(r,_*v,y>2?v:0,v,v),u.setRenderTarget(r),g&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=d,u.autoClear=h,e.background=m}_textureToCubeUV(e,t){const n=this._renderer,r=301===e.mapping||302===e.mapping;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=wE()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=xE());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Vn(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;mf(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(o,av)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,yE[(r-1)%yE.length])}t.autoClear=n}_blur(e,t,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const h=new Vn(this._lodPlanes[r],c),d=c.uniforms,f=this._sizeLods[n]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,g=s/p,m=isFinite(s)?1+Math.floor(3*g):20;m>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${m} samples when the maximum is set to 20`);const y=[];let _=0;for(let T=0;T<20;++T){const w=T/g,C=Math.exp(-w*w/2);y.push(C),0===T?_+=C:T<m&&(_+=2*C)}for(let T=0;T<y.length;T++)y[T]=y[T]/_;d.envMap.value=e.texture,d.samples.value=m,d.weights.value=y,d.latitudinal.value="latitudinal"===o,a&&(d.poleAxis.value=a);const{_lodMax:v}=this;d.dTheta.value=p,d.mipInt.value=v-n;const x=this._sizeLods[r];mf(t,3*x*(r>v-4?r-v+4:0),4*(this._cubeSize-x),3*x,2*x),l.setRenderTarget(t),l.render(h,av)}}function _E(i,e,t){const n=new mo(i,e,t);return n.texture.mapping=306,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function mf(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function xE(){return new Ts({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function wE(){return new Ts({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function UV(i){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function n(a){if(a&&a.isTexture){const l=a.mapping,c=303===l||304===l,u=301===l||302===l;if(c||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let h=e.get(a);return null===t&&(t=new vE(i)),h=c?t.fromEquirectangular(a,h):t.fromCubemap(a,h),e.set(a,h),h.texture}if(e.has(a))return e.get(a).texture;{const h=a.image;if(c&&h&&h.height>0||u&&h&&function r(a){let l=0;for(let u=0;u<6;u++)void 0!==a[u]&&l++;return 6===l}(h)){null===t&&(t=new vE(i));const d=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function VV(i){const e={};function t(n){if(void 0!==e[n])return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return{has:function(n){return null!==t(n)},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const r=t(n);return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function HV(i,e,t,n){const r={},s=new WeakMap;function o(h){const d=h.target;null!==d.index&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",o),delete r[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),n.releaseStatesOfGeometry(d),!0===d.isInstancedBufferGeometry&&delete d._maxInstanceCount,t.memory.geometries--}function c(h){const d=[],f=h.index,p=h.attributes.position;let g=0;if(null!==f){const _=f.array;g=f.version;for(let v=0,x=_.length;v<x;v+=3){const b=_[v+0],S=_[v+1],T=_[v+2];d.push(b,S,S,T,T,b)}}else{g=p.version;for(let v=0,x=p.array.length/3-1;v<x;v+=3){const b=v+0,S=v+1,T=v+2;d.push(b,S,S,T,T,b)}}const m=new(XD(d)?hE:uE)(d,1);m.version=g;const y=s.get(h);y&&e.remove(y),s.set(h,m)}return{get:function a(h,d){return!0===r[d.id]||(d.addEventListener("dispose",o),r[d.id]=!0,t.memory.geometries++),d},update:function l(h){const d=h.attributes;for(const p in d)e.update(d[p],34962);const f=h.morphAttributes;for(const p in f){const g=f[p];for(let m=0,y=g.length;m<y;m++)e.update(g[m],34962)}},getWireframeAttribute:function u(h){const d=s.get(h);if(d){const f=h.index;null!==f&&d.version<f.version&&c(h)}else c(h);return s.get(h)}}}function GV(i,e,t,n){const r=n.isWebGL2;let s,a,l;this.setMode=function o(d){s=d},this.setIndex=function c(d){a=d.type,l=d.bytesPerElement},this.render=function u(d,f){i.drawElements(s,f,a,d*l),t.update(f,s,1)},this.renderInstances=function h(d,f,p){if(0===p)return;let g,m;if(r)g=i,m="drawElementsInstanced";else if(g=e.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",null===g)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");g[m](s,f,a,d*l,p),t.update(f,s,p)}}function WV(i){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function n(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function $V(i,e){return i[0]-e[0]}function jV(i,e){return Math.abs(e[1])-Math.abs(i[1])}function qV(i,e,t){const n={},r=new Float32Array(8),s=new WeakMap,o=new Ct,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,u,h,d){const f=c.morphTargetInfluences;if(!0===e.isWebGL2){const p=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,g=void 0!==p?p.length:0;let m=s.get(u);if(void 0===m||m.count!==g){let U=function(){k.dispose(),s.delete(u),u.removeEventListener("dispose",U)};void 0!==m&&m.texture.dispose();const v=void 0!==u.morphAttributes.position,x=void 0!==u.morphAttributes.normal,b=void 0!==u.morphAttributes.color,S=u.morphAttributes.position||[],T=u.morphAttributes.normal||[],w=u.morphAttributes.color||[];let C=0;!0===v&&(C=1),!0===x&&(C=2),!0===b&&(C=3);let I=u.attributes.position.count*C,F=1;I>e.maxTextureSize&&(F=Math.ceil(I/e.maxTextureSize),I=e.maxTextureSize);const Z=new Float32Array(I*F*4*g),k=new zy(Z,I,F,g);k.type=xs,k.needsUpdate=!0;const L=4*C;for(let G=0;G<g;G++){const te=S[G],z=T[G],ne=w[G],Q=I*F*4*G;for(let B=0;B<te.count;B++){const H=B*L;!0===v&&(o.fromBufferAttribute(te,B),Z[Q+H+0]=o.x,Z[Q+H+1]=o.y,Z[Q+H+2]=o.z,Z[Q+H+3]=0),!0===x&&(o.fromBufferAttribute(z,B),Z[Q+H+4]=o.x,Z[Q+H+5]=o.y,Z[Q+H+6]=o.z,Z[Q+H+7]=0),!0===b&&(o.fromBufferAttribute(ne,B),Z[Q+H+8]=o.x,Z[Q+H+9]=o.y,Z[Q+H+10]=o.z,Z[Q+H+11]=4===ne.itemSize?o.w:1)}}m={count:g,texture:k,size:new ee(I,F)},s.set(u,m),u.addEventListener("dispose",U)}let y=0;for(let v=0;v<f.length;v++)y+=f[v];const _=u.morphTargetsRelative?1:1-y;d.getUniforms().setValue(i,"morphTargetBaseInfluence",_),d.getUniforms().setValue(i,"morphTargetInfluences",f),d.getUniforms().setValue(i,"morphTargetsTexture",m.texture,t),d.getUniforms().setValue(i,"morphTargetsTextureSize",m.size)}else{const p=void 0===f?0:f.length;let g=n[u.id];if(void 0===g||g.length!==p){g=[];for(let x=0;x<p;x++)g[x]=[x,0];n[u.id]=g}for(let x=0;x<p;x++){const b=g[x];b[0]=x,b[1]=f[x]}g.sort(jV);for(let x=0;x<8;x++)x<p&&g[x][1]?(a[x][0]=g[x][0],a[x][1]=g[x][1]):(a[x][0]=Number.MAX_SAFE_INTEGER,a[x][1]=0);a.sort($V);const m=u.morphAttributes.position,y=u.morphAttributes.normal;let _=0;for(let x=0;x<8;x++){const b=a[x],S=b[0],T=b[1];S!==Number.MAX_SAFE_INTEGER&&T?(m&&u.getAttribute("morphTarget"+x)!==m[S]&&u.setAttribute("morphTarget"+x,m[S]),y&&u.getAttribute("morphNormal"+x)!==y[S]&&u.setAttribute("morphNormal"+x,y[S]),r[x]=T,_+=T):(m&&!0===u.hasAttribute("morphTarget"+x)&&u.deleteAttribute("morphTarget"+x),y&&!0===u.hasAttribute("morphNormal"+x)&&u.deleteAttribute("morphNormal"+x),r[x]=0)}const v=u.morphTargetsRelative?1:1-_;d.getUniforms().setValue(i,"morphTargetBaseInfluence",v),d.getUniforms().setValue(i,"morphTargetInfluences",r)}}}}function JV(i,e,t,n){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=n.render.frame,h=e.get(l,l.geometry);return r.get(h)!==c&&(e.update(h),r.set(h,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),null!==l.instanceColor&&t.update(l.instanceColor,34962)),h},dispose:function o(){r=new WeakMap}}}const bE=new ws,ME=new zy,SE=new eE,CE=new df,DE=[],EE=[],AE=new Float32Array(16),TE=new Float32Array(9),IE=new Float32Array(4);function yl(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=DE[r];if(void 0===s&&(s=new Float32Array(r),DE[r]=s),0!==e){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,i[o].toArray(s,a)}return s}function yn(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function vn(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function yf(i,e){let t=EE[e];void 0===t&&(t=new Int32Array(e),EE[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function YV(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function ZV(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(yn(t,e))return;i.uniform2fv(this.addr,e),vn(t,e)}}function XV(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(yn(t,e))return;i.uniform3fv(this.addr,e),vn(t,e)}}function KV(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(yn(t,e))return;i.uniform4fv(this.addr,e),vn(t,e)}}function QV(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(yn(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),vn(t,e)}else{if(yn(t,n))return;IE.set(n),i.uniformMatrix2fv(this.addr,!1,IE),vn(t,n)}}function eH(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(yn(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),vn(t,e)}else{if(yn(t,n))return;TE.set(n),i.uniformMatrix3fv(this.addr,!1,TE),vn(t,n)}}function tH(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(yn(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),vn(t,e)}else{if(yn(t,n))return;AE.set(n),i.uniformMatrix4fv(this.addr,!1,AE),vn(t,n)}}function nH(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function iH(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(yn(t,e))return;i.uniform2iv(this.addr,e),vn(t,e)}}function rH(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(yn(t,e))return;i.uniform3iv(this.addr,e),vn(t,e)}}function sH(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(yn(t,e))return;i.uniform4iv(this.addr,e),vn(t,e)}}function oH(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function aH(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(yn(t,e))return;i.uniform2uiv(this.addr,e),vn(t,e)}}function lH(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(yn(t,e))return;i.uniform3uiv(this.addr,e),vn(t,e)}}function cH(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(yn(t,e))return;i.uniform4uiv(this.addr,e),vn(t,e)}}function uH(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2D(e||bE,r)}function hH(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||SE,r)}function dH(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||CE,r)}function fH(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||ME,r)}function gH(i,e){i.uniform1fv(this.addr,e)}function mH(i,e){const t=yl(e,this.size,2);i.uniform2fv(this.addr,t)}function yH(i,e){const t=yl(e,this.size,3);i.uniform3fv(this.addr,t)}function vH(i,e){const t=yl(e,this.size,4);i.uniform4fv(this.addr,t)}function _H(i,e){const t=yl(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function xH(i,e){const t=yl(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function wH(i,e){const t=yl(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function bH(i,e){i.uniform1iv(this.addr,e)}function MH(i,e){i.uniform2iv(this.addr,e)}function SH(i,e){i.uniform3iv(this.addr,e)}function CH(i,e){i.uniform4iv(this.addr,e)}function DH(i,e){i.uniform1uiv(this.addr,e)}function EH(i,e){i.uniform2uiv(this.addr,e)}function AH(i,e){i.uniform3uiv(this.addr,e)}function TH(i,e){i.uniform4uiv(this.addr,e)}function IH(i,e,t){const n=this.cache,r=e.length,s=yf(t,r);yn(n,s)||(i.uniform1iv(this.addr,s),vn(n,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||bE,s[o])}function RH(i,e,t){const n=this.cache,r=e.length,s=yf(t,r);yn(n,s)||(i.uniform1iv(this.addr,s),vn(n,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||SE,s[o])}function PH(i,e,t){const n=this.cache,r=e.length,s=yf(t,r);yn(n,s)||(i.uniform1iv(this.addr,s),vn(n,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||CE,s[o])}function LH(i,e,t){const n=this.cache,r=e.length,s=yf(t,r);yn(n,s)||(i.uniform1iv(this.addr,s),vn(n,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||ME,s[o])}class OH{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function pH(i){switch(i){case 5126:return YV;case 35664:return ZV;case 35665:return XV;case 35666:return KV;case 35674:return QV;case 35675:return eH;case 35676:return tH;case 5124:case 35670:return nH;case 35667:case 35671:return iH;case 35668:case 35672:return rH;case 35669:case 35673:return sH;case 5125:return oH;case 36294:return aH;case 36295:return lH;case 36296:return cH;case 35678:case 36198:case 36298:case 36306:case 35682:return uH;case 35679:case 36299:case 36307:return hH;case 35680:case 36300:case 36308:case 36293:return dH;case 36289:case 36303:case 36311:case 36292:return fH}}(t.type)}}class FH{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function NH(i){switch(i){case 5126:return gH;case 35664:return mH;case 35665:return yH;case 35666:return vH;case 35674:return _H;case 35675:return xH;case 35676:return wH;case 5124:case 35670:return bH;case 35667:case 35671:return MH;case 35668:case 35672:return SH;case 35669:case 35673:return CH;case 5125:return DH;case 36294:return EH;case 36295:return AH;case 36296:return TH;case 35678:case 36198:case 36298:case 36306:case 35682:return IH;case 35679:case 36299:case 36307:return RH;case 35680:case 36300:case 36308:case 36293:return PH;case 36289:case 36303:case 36311:case 36292:return LH}}(t.type)}}class kH{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],n)}}}const uv=/(\w+)(\])?(\[|\.)?/g;function RE(i,e){i.seq.push(e),i.map[e.id]=e}function zH(i,e,t){const n=i.name,r=n.length;for(uv.lastIndex=0;;){const s=uv.exec(n),o=uv.lastIndex;let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&o+2===r){RE(t,void 0===c?new OH(a,i,e):new FH(a,i,e));break}{let h=t.map[a];void 0===h&&(h=new kH(a),RE(t,h)),t=h}}}class vf{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,35718);for(let r=0;r<n;++r){const s=e.getActiveUniform(t,r);zH(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,n,r){const s=this.map[t];void 0!==s&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=n[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&n.push(o)}return n}}function PE(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}let BH=0;function LE(i,e,t){const n=i.getShaderParameter(e,35713),r=i.getShaderInfoLog(e).trim();if(n&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function UH(i,e){const t=i.split("\n"),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;n.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return n.join("\n")}(i.getShaderSource(e),o)}return r}function HH(i,e){const t=function VH(i){switch(i){case ho:return["Linear","( value )"];case Ht:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}(e);return"vec4 "+i+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function GH(i,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="OptimizedCineon";break;case 4:t="ACESFilmic";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function ou(i){return""!==i}function NE(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function OE(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const qH=/^[ \t]*#include +<([\w\d./]+)>/gm;function hv(i){return i.replace(qH,JH)}function JH(i,e){const t=tt[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return hv(t)}const YH=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function FE(i){return i.replace(YH,ZH)}function ZH(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function kE(i){let e="precision "+i.precision+" float;\nprecision "+i.precision+" int;";return"highp"===i.precision?e+="\n#define HIGH_PRECISION":"mediump"===i.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===i.precision&&(e+="\n#define LOW_PRECISION"),e}function nG(i,e,t,n){const r=i.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function XH(i){let e="SHADOWMAP_TYPE_BASIC";return 1===i.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===i.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===i.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function KH(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function QH(i){let e="ENVMAP_MODE_REFLECTION";return i.envMap&&302===i.envMapMode&&(e="ENVMAP_MODE_REFRACTION"),e}(t),h=function eG(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),d=function tG(i){const e=i.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}(t),f=t.isWebGL2?"":function WH(i){return[i.extensionDerivatives||i.envMapCubeUVHeight||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||"physical"===i.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ou).join("\n")}(t),p=function $H(i){const e=[];for(const t in i){const n=i[t];!1!==n&&e.push("#define "+t+" "+n)}return e.join("\n")}(s),g=r.createProgram();let m,y,_=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(m=[p].filter(ou).join("\n"),m.length>0&&(m+="\n"),y=[f,p].filter(ou).join("\n"),y.length>0&&(y+="\n")):(m=[kE(t),"#define SHADER_NAME "+t.shaderName,p,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ou).join("\n"),y=[f,kE(t),"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?tt.tonemapping_pars_fragment:"",0!==t.toneMapping?GH("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",tt.encodings_pars_fragment,HH("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(ou).join("\n")),o=hv(o),o=NE(o,t),o=OE(o,t),a=hv(a),a=NE(a,t),a=OE(a,t),o=FE(o),a=FE(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(_="#version 300 es\n",m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,y=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const x=_+y+a,b=PE(r,35633,_+m+o),S=PE(r,35632,x);if(r.attachShader(g,b),r.attachShader(g,S),void 0!==t.index0AttributeName?r.bindAttribLocation(g,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(g,0,"position"),r.linkProgram(g),i.debug.checkShaderErrors){const C=r.getProgramInfoLog(g).trim(),I=r.getShaderInfoLog(b).trim(),F=r.getShaderInfoLog(S).trim();let Z=!0,k=!0;if(!1===r.getProgramParameter(g,35714)){Z=!1;const L=LE(r,b,"vertex"),U=LE(r,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(g,35715)+"\n\nProgram Info Log: "+C+"\n"+L+"\n"+U)}else""!==C?console.warn("THREE.WebGLProgram: Program Info Log:",C):(""===I||""===F)&&(k=!1);k&&(this.diagnostics={runnable:Z,programLog:C,vertexShader:{log:I,prefix:m},fragmentShader:{log:F,prefix:y}})}let T,w;return r.deleteShader(b),r.deleteShader(S),this.getUniforms=function(){return void 0===T&&(T=new vf(r,g)),T},this.getAttributes=function(){return void 0===w&&(w=function jH(i,e){const t={},n=i.getProgramParameter(e,35721);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),o=s.name;let a=1;35674===s.type&&(a=2),35675===s.type&&(a=3),35676===s.type&&(a=4),t[o]={type:s.type,location:i.getAttribLocation(e,o),locationSize:a}}return t}(r,g)),w},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(g),this.program=void 0},this.name=t.shaderName,this.id=BH++,this.cacheKey=e,this.usedTimes=1,this.program=g,this.vertexShader=b,this.fragmentShader=S,this}let iG=0;class rG{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new sG(e),t.set(e,n)),n}}class sG{constructor(e){this.id=iG++,this.code=e,this.usedTimes=0}}function oG(i,e,t,n,r,s,o){const a=new jy,l=new rG,c=[],u=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function g(w,C,I,F,Z){const k=F.fog,L=Z.geometry,G=(w.isMeshStandardMaterial?t:e).get(w.envMap||(w.isMeshStandardMaterial?F.environment:null)),te=G&&306===G.mapping?G.image.height:null,z=p[w.type];null!==w.precision&&(f=r.getMaxPrecision(w.precision),f!==w.precision&&console.warn("THREE.WebGLProgram.getParameters:",w.precision,"not supported, using",f,"instead."));const ne=L.morphAttributes.position||L.morphAttributes.normal||L.morphAttributes.color,Q=void 0!==ne?ne.length:0;let H,oe,se,ue,B=0;if(void 0!==L.morphAttributes.position&&(B=1),void 0!==L.morphAttributes.normal&&(B=2),void 0!==L.morphAttributes.color&&(B=3),z){const it=xr[z];H=it.vertexShader,oe=it.fragmentShader}else H=w.vertexShader,oe=w.fragmentShader,l.update(w),se=l.getVertexShaderID(w),ue=l.getFragmentShaderID(w);const j=i.getRenderTarget(),xe=w.clearcoat>0,Ue=w.iridescence>0;return{isWebGL2:u,shaderID:z,shaderName:w.type,vertexShader:H,fragmentShader:oe,defines:w.defines,customVertexShaderID:se,customFragmentShaderID:ue,isRawShaderMaterial:!0===w.isRawShaderMaterial,glslVersion:w.glslVersion,precision:f,instancing:!0===Z.isInstancedMesh,instancingColor:!0===Z.isInstancedMesh&&null!==Z.instanceColor,supportsVertexTextures:d,outputEncoding:null===j?i.outputEncoding:!0===j.isXRRenderTarget?j.texture.encoding:ho,map:!!w.map,matcap:!!w.matcap,envMap:!!G,envMapMode:G&&G.mapping,envMapCubeUVHeight:te,lightMap:!!w.lightMap,aoMap:!!w.aoMap,emissiveMap:!!w.emissiveMap,bumpMap:!!w.bumpMap,normalMap:!!w.normalMap,objectSpaceNormalMap:1===w.normalMapType,tangentSpaceNormalMap:0===w.normalMapType,decodeVideoTexture:!!w.map&&!0===w.map.isVideoTexture&&w.map.encoding===Ht,clearcoat:xe,clearcoatMap:xe&&!!w.clearcoatMap,clearcoatRoughnessMap:xe&&!!w.clearcoatRoughnessMap,clearcoatNormalMap:xe&&!!w.clearcoatNormalMap,iridescence:Ue,iridescenceMap:Ue&&!!w.iridescenceMap,iridescenceThicknessMap:Ue&&!!w.iridescenceThicknessMap,displacementMap:!!w.displacementMap,roughnessMap:!!w.roughnessMap,metalnessMap:!!w.metalnessMap,specularMap:!!w.specularMap,specularIntensityMap:!!w.specularIntensityMap,specularColorMap:!!w.specularColorMap,opaque:!1===w.transparent&&1===w.blending,alphaMap:!!w.alphaMap,alphaTest:w.alphaTest>0,gradientMap:!!w.gradientMap,sheen:w.sheen>0,sheenColorMap:!!w.sheenColorMap,sheenRoughnessMap:!!w.sheenRoughnessMap,transmission:w.transmission>0,transmissionMap:!!w.transmissionMap,thicknessMap:!!w.thicknessMap,combine:w.combine,vertexTangents:!!w.normalMap&&!!L.attributes.tangent,vertexColors:w.vertexColors,vertexAlphas:!0===w.vertexColors&&!!L.attributes.color&&4===L.attributes.color.itemSize,vertexUvs:!!(w.map||w.bumpMap||w.normalMap||w.specularMap||w.alphaMap||w.emissiveMap||w.roughnessMap||w.metalnessMap||w.clearcoatMap||w.clearcoatRoughnessMap||w.clearcoatNormalMap||w.iridescenceMap||w.iridescenceThicknessMap||w.displacementMap||w.transmissionMap||w.thicknessMap||w.specularIntensityMap||w.specularColorMap||w.sheenColorMap||w.sheenRoughnessMap),uvsVertexOnly:!(w.map||w.bumpMap||w.normalMap||w.specularMap||w.alphaMap||w.emissiveMap||w.roughnessMap||w.metalnessMap||w.clearcoatNormalMap||w.iridescenceMap||w.iridescenceThicknessMap||w.transmission>0||w.transmissionMap||w.thicknessMap||w.specularIntensityMap||w.specularColorMap||w.sheen>0||w.sheenColorMap||w.sheenRoughnessMap||!w.displacementMap),fog:!!k,useFog:!0===w.fog,fogExp2:k&&k.isFogExp2,flatShading:!!w.flatShading,sizeAttenuation:w.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===Z.isSkinnedMesh,morphTargets:void 0!==L.morphAttributes.position,morphNormals:void 0!==L.morphAttributes.normal,morphColors:void 0!==L.morphAttributes.color,morphTargetsCount:Q,morphTextureStride:B,numDirLights:C.directional.length,numPointLights:C.point.length,numSpotLights:C.spot.length,numSpotLightMaps:C.spotLightMap.length,numRectAreaLights:C.rectArea.length,numHemiLights:C.hemi.length,numDirLightShadows:C.directionalShadowMap.length,numPointLightShadows:C.pointShadowMap.length,numSpotLightShadows:C.spotShadowMap.length,numSpotLightShadowsWithMaps:C.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:w.dithering,shadowMapEnabled:i.shadowMap.enabled&&I.length>0,shadowMapType:i.shadowMap.type,toneMapping:w.toneMapped?i.toneMapping:0,physicallyCorrectLights:i.physicallyCorrectLights,premultipliedAlpha:w.premultipliedAlpha,doubleSided:2===w.side,flipSided:1===w.side,useDepthPacking:!!w.depthPacking,depthPacking:w.depthPacking||0,index0AttributeName:w.index0AttributeName,extensionDerivatives:w.extensions&&w.extensions.derivatives,extensionFragDepth:w.extensions&&w.extensions.fragDepth,extensionDrawBuffers:w.extensions&&w.extensions.drawBuffers,extensionShaderTextureLOD:w.extensions&&w.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||n.has("EXT_shader_texture_lod"),customProgramCacheKey:w.customProgramCacheKey()}},getProgramCacheKey:function m(w){const C=[];if(w.shaderID?C.push(w.shaderID):(C.push(w.customVertexShaderID),C.push(w.customFragmentShaderID)),void 0!==w.defines)for(const I in w.defines)C.push(I),C.push(w.defines[I]);return!1===w.isRawShaderMaterial&&(function y(w,C){w.push(C.precision),w.push(C.outputEncoding),w.push(C.envMapMode),w.push(C.envMapCubeUVHeight),w.push(C.combine),w.push(C.vertexUvs),w.push(C.fogExp2),w.push(C.sizeAttenuation),w.push(C.morphTargetsCount),w.push(C.morphAttributeCount),w.push(C.numDirLights),w.push(C.numPointLights),w.push(C.numSpotLights),w.push(C.numSpotLightMaps),w.push(C.numHemiLights),w.push(C.numRectAreaLights),w.push(C.numDirLightShadows),w.push(C.numPointLightShadows),w.push(C.numSpotLightShadows),w.push(C.numSpotLightShadowsWithMaps),w.push(C.shadowMapType),w.push(C.toneMapping),w.push(C.numClippingPlanes),w.push(C.numClipIntersection),w.push(C.depthPacking)}(C,w),function _(w,C){a.disableAll(),C.isWebGL2&&a.enable(0),C.supportsVertexTextures&&a.enable(1),C.instancing&&a.enable(2),C.instancingColor&&a.enable(3),C.map&&a.enable(4),C.matcap&&a.enable(5),C.envMap&&a.enable(6),C.lightMap&&a.enable(7),C.aoMap&&a.enable(8),C.emissiveMap&&a.enable(9),C.bumpMap&&a.enable(10),C.normalMap&&a.enable(11),C.objectSpaceNormalMap&&a.enable(12),C.tangentSpaceNormalMap&&a.enable(13),C.clearcoat&&a.enable(14),C.clearcoatMap&&a.enable(15),C.clearcoatRoughnessMap&&a.enable(16),C.clearcoatNormalMap&&a.enable(17),C.iridescence&&a.enable(18),C.iridescenceMap&&a.enable(19),C.iridescenceThicknessMap&&a.enable(20),C.displacementMap&&a.enable(21),C.specularMap&&a.enable(22),C.roughnessMap&&a.enable(23),C.metalnessMap&&a.enable(24),C.gradientMap&&a.enable(25),C.alphaMap&&a.enable(26),C.alphaTest&&a.enable(27),C.vertexColors&&a.enable(28),C.vertexAlphas&&a.enable(29),C.vertexUvs&&a.enable(30),C.vertexTangents&&a.enable(31),C.uvsVertexOnly&&a.enable(32),w.push(a.mask),a.disableAll(),C.fog&&a.enable(0),C.useFog&&a.enable(1),C.flatShading&&a.enable(2),C.logarithmicDepthBuffer&&a.enable(3),C.skinning&&a.enable(4),C.morphTargets&&a.enable(5),C.morphNormals&&a.enable(6),C.morphColors&&a.enable(7),C.premultipliedAlpha&&a.enable(8),C.shadowMapEnabled&&a.enable(9),C.physicallyCorrectLights&&a.enable(10),C.doubleSided&&a.enable(11),C.flipSided&&a.enable(12),C.useDepthPacking&&a.enable(13),C.dithering&&a.enable(14),C.specularIntensityMap&&a.enable(15),C.specularColorMap&&a.enable(16),C.transmission&&a.enable(17),C.transmissionMap&&a.enable(18),C.thicknessMap&&a.enable(19),C.sheen&&a.enable(20),C.sheenColorMap&&a.enable(21),C.sheenRoughnessMap&&a.enable(22),C.decodeVideoTexture&&a.enable(23),C.opaque&&a.enable(24),w.push(a.mask)}(C,w),C.push(i.outputEncoding)),C.push(w.customProgramCacheKey),C.join()},getUniforms:function v(w){const C=p[w.type];let I;return I=C?DB.clone(xr[C].uniforms):w.uniforms,I},acquireProgram:function x(w,C){let I;for(let F=0,Z=c.length;F<Z;F++){const k=c[F];if(k.cacheKey===C){I=k,++I.usedTimes;break}}return void 0===I&&(I=new nG(i,C,w,s),c.push(I)),I},releaseProgram:function b(w){if(0==--w.usedTimes){const C=c.indexOf(w);c[C]=c[c.length-1],c.pop(),w.destroy()}},releaseShaderCache:function S(w){l.remove(w)},programs:c,dispose:function T(){l.dispose()}}}function aG(){let i=new WeakMap;return{get:function e(s){let o=i.get(s);return void 0===o&&(o={},i.set(s,o)),o},remove:function t(s){i.delete(s)},update:function n(s,o,a){i.get(s)[o]=a},dispose:function r(){i=new WeakMap}}}function lG(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function zE(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function BE(){const i=[];let e=0;const t=[],n=[],r=[];function o(h,d,f,p,g,m){let y=i[e];return void 0===y?(y={id:h.id,object:h,geometry:d,material:f,groupOrder:p,renderOrder:h.renderOrder,z:g,group:m},i[e]=y):(y.id=h.id,y.object=h,y.geometry=d,y.material=f,y.groupOrder=p,y.renderOrder=h.renderOrder,y.z=g,y.group=m),e++,y}return{opaque:t,transmissive:n,transparent:r,init:function s(){e=0,t.length=0,n.length=0,r.length=0},push:function a(h,d,f,p,g,m){const y=o(h,d,f,p,g,m);f.transmission>0?n.push(y):!0===f.transparent?r.push(y):t.push(y)},unshift:function l(h,d,f,p,g,m){const y=o(h,d,f,p,g,m);f.transmission>0?n.unshift(y):!0===f.transparent?r.unshift(y):t.unshift(y)},finish:function u(){for(let h=e,d=i.length;h<d;h++){const f=i[h];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function c(h,d){t.length>1&&t.sort(h||lG),n.length>1&&n.sort(d||zE),r.length>1&&r.sort(d||zE)}}}function cG(){let i=new WeakMap;return{get:function e(n,r){const s=i.get(n);let o;return void 0===s?(o=new BE,i.set(n,[o])):r>=s.length?(o=new BE,s.push(o)):o=s[r],o},dispose:function t(){i=new WeakMap}}}function uG(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new E,color:new _e};break;case"SpotLight":t={position:new E,direction:new E,color:new _e,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new E,color:new _e,distance:0,decay:0};break;case"HemisphereLight":t={direction:new E,skyColor:new _e,groundColor:new _e};break;case"RectAreaLight":t={color:new _e,position:new E,halfWidth:new E,halfHeight:new E}}return i[e.id]=t,t}}}let dG=0;function fG(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function pG(i,e){const t=new uG,n=function hG(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ee};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ee,shadowCameraNear:1,shadowCameraFar:1e3}}return i[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)r.probe.push(new E);const s=new E,o=new Ke,a=new Ke;return{setup:function l(u,h){let d=0,f=0,p=0;for(let F=0;F<9;F++)r.probe[F].set(0,0,0);let g=0,m=0,y=0,_=0,v=0,x=0,b=0,S=0,T=0,w=0;u.sort(fG);const C=!0!==h?Math.PI:1;for(let F=0,Z=u.length;F<Z;F++){const k=u[F],L=k.color,U=k.intensity,G=k.distance,te=k.shadow&&k.shadow.map?k.shadow.map.texture:null;if(k.isAmbientLight)d+=L.r*U*C,f+=L.g*U*C,p+=L.b*U*C;else if(k.isLightProbe)for(let z=0;z<9;z++)r.probe[z].addScaledVector(k.sh.coefficients[z],U);else if(k.isDirectionalLight){const z=t.get(k);if(z.color.copy(k.color).multiplyScalar(k.intensity*C),k.castShadow){const ne=k.shadow,Q=n.get(k);Q.shadowBias=ne.bias,Q.shadowNormalBias=ne.normalBias,Q.shadowRadius=ne.radius,Q.shadowMapSize=ne.mapSize,r.directionalShadow[g]=Q,r.directionalShadowMap[g]=te,r.directionalShadowMatrix[g]=k.shadow.matrix,x++}r.directional[g]=z,g++}else if(k.isSpotLight){const z=t.get(k);z.position.setFromMatrixPosition(k.matrixWorld),z.color.copy(L).multiplyScalar(U*C),z.distance=G,z.coneCos=Math.cos(k.angle),z.penumbraCos=Math.cos(k.angle*(1-k.penumbra)),z.decay=k.decay,r.spot[y]=z;const ne=k.shadow;if(k.map&&(r.spotLightMap[T]=k.map,T++,ne.updateMatrices(k),k.castShadow&&w++),r.spotLightMatrix[y]=ne.matrix,k.castShadow){const Q=n.get(k);Q.shadowBias=ne.bias,Q.shadowNormalBias=ne.normalBias,Q.shadowRadius=ne.radius,Q.shadowMapSize=ne.mapSize,r.spotShadow[y]=Q,r.spotShadowMap[y]=te,S++}y++}else if(k.isRectAreaLight){const z=t.get(k);z.color.copy(L).multiplyScalar(U),z.halfWidth.set(.5*k.width,0,0),z.halfHeight.set(0,.5*k.height,0),r.rectArea[_]=z,_++}else if(k.isPointLight){const z=t.get(k);if(z.color.copy(k.color).multiplyScalar(k.intensity*C),z.distance=k.distance,z.decay=k.decay,k.castShadow){const ne=k.shadow,Q=n.get(k);Q.shadowBias=ne.bias,Q.shadowNormalBias=ne.normalBias,Q.shadowRadius=ne.radius,Q.shadowMapSize=ne.mapSize,Q.shadowCameraNear=ne.camera.near,Q.shadowCameraFar=ne.camera.far,r.pointShadow[m]=Q,r.pointShadowMap[m]=te,r.pointShadowMatrix[m]=k.shadow.matrix,b++}r.point[m]=z,m++}else if(k.isHemisphereLight){const z=t.get(k);z.skyColor.copy(k.color).multiplyScalar(U*C),z.groundColor.copy(k.groundColor).multiplyScalar(U*C),r.hemi[v]=z,v++}}_>0&&(e.isWebGL2||!0===i.has("OES_texture_float_linear")?(r.rectAreaLTC1=ce.LTC_FLOAT_1,r.rectAreaLTC2=ce.LTC_FLOAT_2):!0===i.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=ce.LTC_HALF_1,r.rectAreaLTC2=ce.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;const I=r.hash;(I.directionalLength!==g||I.pointLength!==m||I.spotLength!==y||I.rectAreaLength!==_||I.hemiLength!==v||I.numDirectionalShadows!==x||I.numPointShadows!==b||I.numSpotShadows!==S||I.numSpotMaps!==T)&&(r.directional.length=g,r.spot.length=y,r.rectArea.length=_,r.point.length=m,r.hemi.length=v,r.directionalShadow.length=x,r.directionalShadowMap.length=x,r.pointShadow.length=b,r.pointShadowMap.length=b,r.spotShadow.length=S,r.spotShadowMap.length=S,r.directionalShadowMatrix.length=x,r.pointShadowMatrix.length=b,r.spotLightMatrix.length=S+T-w,r.spotLightMap.length=T,r.numSpotLightShadowsWithMaps=w,I.directionalLength=g,I.pointLength=m,I.spotLength=y,I.rectAreaLength=_,I.hemiLength=v,I.numDirectionalShadows=x,I.numPointShadows=b,I.numSpotShadows=S,I.numSpotMaps=T,r.version=dG++)},setupView:function c(u,h){let d=0,f=0,p=0,g=0,m=0;const y=h.matrixWorldInverse;for(let _=0,v=u.length;_<v;_++){const x=u[_];if(x.isDirectionalLight){const b=r.directional[d];b.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(y),d++}else if(x.isSpotLight){const b=r.spot[p];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(y),b.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(y),p++}else if(x.isRectAreaLight){const b=r.rectArea[g];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(y),a.identity(),o.copy(x.matrixWorld),o.premultiply(y),a.extractRotation(o),b.halfWidth.set(.5*x.width,0,0),b.halfHeight.set(0,.5*x.height,0),b.halfWidth.applyMatrix4(a),b.halfHeight.applyMatrix4(a),g++}else if(x.isPointLight){const b=r.point[f];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(y),f++}else if(x.isHemisphereLight){const b=r.hemi[m];b.direction.setFromMatrixPosition(x.matrixWorld),b.direction.transformDirection(y),m++}}},state:r}}function UE(i,e){const t=new pG(i,e),n=[],r=[];return{init:function s(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:t},setupLights:function l(h){t.setup(n,h)},setupLightsView:function c(h){t.setupView(n,h)},pushLight:function o(h){n.push(h)},pushShadow:function a(h){r.push(h)}}}function gG(i,e){let t=new WeakMap;return{get:function n(s,o=0){const a=t.get(s);let l;return void 0===a?(l=new UE(i,e),t.set(s,[l])):o>=a.length?(l=new UE(i,e),a.push(l)):l=a[o],l},dispose:function r(){t=new WeakMap}}}class VE extends al{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class HE extends al{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new E,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function vG(i,e,t){let n=new sv;const r=new ee,s=new ee,o=new Ct,a=new VE({depthPacking:3201}),l=new HE,c={},u=t.maxTextureSize,h={0:1,1:0,2:2},d=new Ts({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ee},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new ot;p.setAttribute("position",new bn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const g=new Vn(p,d),m=this;function y(x,b){const S=e.update(g);d.defines.VSM_SAMPLES!==x.blurSamples&&(d.defines.VSM_SAMPLES=x.blurSamples,f.defines.VSM_SAMPLES=x.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),null===x.mapPass&&(x.mapPass=new mo(r.x,r.y)),d.uniforms.shadow_pass.value=x.map.texture,d.uniforms.resolution.value=x.mapSize,d.uniforms.radius.value=x.radius,i.setRenderTarget(x.mapPass),i.clear(),i.renderBufferDirect(b,null,S,d,g,null),f.uniforms.shadow_pass.value=x.mapPass.texture,f.uniforms.resolution.value=x.mapSize,f.uniforms.radius.value=x.radius,i.setRenderTarget(x.map),i.clear(),i.renderBufferDirect(b,null,S,f,g,null)}function _(x,b,S,T,w,C){let I=null;const F=!0===S.isPointLight?x.customDistanceMaterial:x.customDepthMaterial;if(I=void 0!==F?F:!0===S.isPointLight?l:a,i.localClippingEnabled&&!0===b.clipShadows&&Array.isArray(b.clippingPlanes)&&0!==b.clippingPlanes.length||b.displacementMap&&0!==b.displacementScale||b.alphaMap&&b.alphaTest>0||b.map&&b.alphaTest>0){const Z=I.uuid,k=b.uuid;let L=c[Z];void 0===L&&(L={},c[Z]=L);let U=L[k];void 0===U&&(U=I.clone(),L[k]=U),I=U}return I.visible=b.visible,I.wireframe=b.wireframe,I.side=3===C?null!==b.shadowSide?b.shadowSide:b.side:null!==b.shadowSide?b.shadowSide:h[b.side],I.alphaMap=b.alphaMap,I.alphaTest=b.alphaTest,I.map=b.map,I.clipShadows=b.clipShadows,I.clippingPlanes=b.clippingPlanes,I.clipIntersection=b.clipIntersection,I.displacementMap=b.displacementMap,I.displacementScale=b.displacementScale,I.displacementBias=b.displacementBias,I.wireframeLinewidth=b.wireframeLinewidth,I.linewidth=b.linewidth,!0===S.isPointLight&&!0===I.isMeshDistanceMaterial&&(I.referencePosition.setFromMatrixPosition(S.matrixWorld),I.nearDistance=T,I.farDistance=w),I}function v(x,b,S,T,w){if(!1===x.visible)return;if(x.layers.test(b.layers)&&(x.isMesh||x.isLine||x.isPoints)&&(x.castShadow||x.receiveShadow&&3===w)&&(!x.frustumCulled||n.intersectsObject(x))){x.modelViewMatrix.multiplyMatrices(S.matrixWorldInverse,x.matrixWorld);const F=e.update(x),Z=x.material;if(Array.isArray(Z)){const k=F.groups;for(let L=0,U=k.length;L<U;L++){const G=k[L],te=Z[G.materialIndex];if(te&&te.visible){const z=_(x,te,T,S.near,S.far,w);i.renderBufferDirect(S,null,F,z,x,G)}}}else if(Z.visible){const k=_(x,Z,T,S.near,S.far,w);i.renderBufferDirect(S,null,F,k,x,null)}}const I=x.children;for(let F=0,Z=I.length;F<Z;F++)v(I[F],b,S,T,w)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(x,b,S){if(!1===m.enabled||!1===m.autoUpdate&&!1===m.needsUpdate||0===x.length)return;const T=i.getRenderTarget(),w=i.getActiveCubeFace(),C=i.getActiveMipmapLevel(),I=i.state;I.setBlending(0),I.buffers.color.setClear(1,1,1,1),I.buffers.depth.setTest(!0),I.setScissorTest(!1);for(let F=0,Z=x.length;F<Z;F++){const k=x[F],L=k.shadow;if(void 0===L){console.warn("THREE.WebGLShadowMap:",k,"has no shadow.");continue}if(!1===L.autoUpdate&&!1===L.needsUpdate)continue;r.copy(L.mapSize);const U=L.getFrameExtents();r.multiply(U),s.copy(L.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/U.x),r.x=s.x*U.x,L.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/U.y),r.y=s.y*U.y,L.mapSize.y=s.y)),null===L.map&&(L.map=new mo(r.x,r.y,3!==this.type?{minFilter:gn,magFilter:gn}:{}),L.map.texture.name=k.name+".shadowMap",L.camera.updateProjectionMatrix()),i.setRenderTarget(L.map),i.clear();const G=L.getViewportCount();for(let te=0;te<G;te++){const z=L.getViewport(te);o.set(s.x*z.x,s.y*z.y,s.x*z.z,s.y*z.w),I.viewport(o),L.updateMatrices(k,te),n=L.getFrustum(),v(b,S,L.camera,k,this.type)}!0!==L.isPointLightShadow&&3===this.type&&y(L,S),L.needsUpdate=!1}m.needsUpdate=!1,i.setRenderTarget(T,w,C)}}function _G(i,e,t){const n=t.isWebGL2,a=new function r(){let P=!1;const $=new Ct;let ie=null;const ve=new Ct(0,0,0,0);return{setMask:function(Se){ie!==Se&&!P&&(i.colorMask(Se,Se,Se,Se),ie=Se)},setLocked:function(Se){P=Se},setClear:function(Se,Mt,Cn,Hn,ko){!0===ko&&(Se*=Hn,Mt*=Hn,Cn*=Hn),$.set(Se,Mt,Cn,Hn),!1===ve.equals($)&&(i.clearColor(Se,Mt,Cn,Hn),ve.copy($))},reset:function(){P=!1,ie=null,ve.set(-1,0,0,0)}}},l=new function s(){let P=!1,$=null,ie=null,ve=null;return{setTest:function(Se){Se?Ge(2929):xe(2929)},setMask:function(Se){$!==Se&&!P&&(i.depthMask(Se),$=Se)},setFunc:function(Se){if(ie!==Se){switch(Se){case 0:i.depthFunc(512);break;case 1:i.depthFunc(519);break;case 2:i.depthFunc(513);break;case 3:default:i.depthFunc(515);break;case 4:i.depthFunc(514);break;case 5:i.depthFunc(518);break;case 6:i.depthFunc(516);break;case 7:i.depthFunc(517)}ie=Se}},setLocked:function(Se){P=Se},setClear:function(Se){ve!==Se&&(i.clearDepth(Se),ve=Se)},reset:function(){P=!1,$=null,ie=null,ve=null}}},c=new function o(){let P=!1,$=null,ie=null,ve=null,Se=null,Mt=null,Cn=null,Hn=null,ko=null;return{setTest:function(zt){P||(zt?Ge(2960):xe(2960))},setMask:function(zt){$!==zt&&!P&&(i.stencilMask(zt),$=zt)},setFunc:function(zt,is,Gi){(ie!==zt||ve!==is||Se!==Gi)&&(i.stencilFunc(zt,is,Gi),ie=zt,ve=is,Se=Gi)},setOp:function(zt,is,Gi){(Mt!==zt||Cn!==is||Hn!==Gi)&&(i.stencilOp(zt,is,Gi),Mt=zt,Cn=is,Hn=Gi)},setLocked:function(zt){P=zt},setClear:function(zt){ko!==zt&&(i.clearStencil(zt),ko=zt)},reset:function(){P=!1,$=null,ie=null,ve=null,Se=null,Mt=null,Cn=null,Hn=null,ko=null}}},u=new WeakMap,h=new WeakMap;let d={},f={},p=new WeakMap,g=[],m=null,y=!1,_=null,v=null,x=null,b=null,S=null,T=null,w=null,C=!1,I=null,F=null,Z=null,k=null,L=null;const U=i.getParameter(35661);let G=!1,te=0;const z=i.getParameter(7938);-1!==z.indexOf("WebGL")?(te=parseFloat(/^WebGL (\d)/.exec(z)[1]),G=te>=1):-1!==z.indexOf("OpenGL ES")&&(te=parseFloat(/^OpenGL ES (\d)/.exec(z)[1]),G=te>=2);let ne=null,Q={};const B=i.getParameter(3088),H=i.getParameter(2978),oe=(new Ct).fromArray(B),se=(new Ct).fromArray(H);function ue(P,$,ie){const ve=new Uint8Array(4),Se=i.createTexture();i.bindTexture(P,Se),i.texParameteri(P,10241,9728),i.texParameteri(P,10240,9728);for(let Mt=0;Mt<ie;Mt++)i.texImage2D($+Mt,0,6408,1,1,0,6408,5121,ve);return Se}const j={};function Ge(P){!0!==d[P]&&(i.enable(P),d[P]=!0)}function xe(P){!1!==d[P]&&(i.disable(P),d[P]=!1)}j[3553]=ue(3553,3553,1),j[34067]=ue(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Ge(2929),l.setFunc(3),de(!1),Je(1),Ge(2884),le(0);const X={100:32774,101:32778,102:32779};if(n)X[103]=32775,X[104]=32776;else{const P=e.get("EXT_blend_minmax");null!==P&&(X[103]=P.MIN_EXT,X[104]=P.MAX_EXT)}const Y={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function le(P,$,ie,ve,Se,Mt,Cn,Hn){if(0!==P){if(!1===y&&(Ge(3042),y=!0),5===P)Se=Se||$,Mt=Mt||ie,Cn=Cn||ve,($!==v||Se!==S)&&(i.blendEquationSeparate(X[$],X[Se]),v=$,S=Se),(ie!==x||ve!==b||Mt!==T||Cn!==w)&&(i.blendFuncSeparate(Y[ie],Y[ve],Y[Mt],Y[Cn]),x=ie,b=ve,T=Mt,w=Cn),_=P,C=!1;else if(P!==_||Hn!==C){if((100!==v||100!==S)&&(i.blendEquation(32774),v=100,S=100),Hn)switch(P){case 1:i.blendFuncSeparate(1,771,1,771);break;case 2:i.blendFunc(1,1);break;case 3:i.blendFuncSeparate(0,769,0,1);break;case 4:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",P)}else switch(P){case 1:i.blendFuncSeparate(770,771,1,771);break;case 2:i.blendFunc(770,1);break;case 3:i.blendFuncSeparate(0,769,0,1);break;case 4:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",P)}x=null,b=null,T=null,w=null,_=P,C=Hn}}else!0===y&&(xe(3042),y=!1)}function de(P){I!==P&&(i.frontFace(P?2304:2305),I=P)}function Je(P){0!==P?(Ge(2884),P!==F&&i.cullFace(1===P?1029:2===P?1028:1032)):xe(2884),F=P}function Le(P,$,ie){P?(Ge(32823),(k!==$||L!==ie)&&(i.polygonOffset($,ie),k=$,L=ie)):xe(32823)}return{buffers:{color:a,depth:l,stencil:c},enable:Ge,disable:xe,bindFramebuffer:function Ue(P,$){return f[P]!==$&&(i.bindFramebuffer(P,$),f[P]=$,n&&(36009===P&&(f[36160]=$),36160===P&&(f[36009]=$)),!0)},drawBuffers:function pe(P,$){let ie=g,ve=!1;if(P)if(ie=p.get($),void 0===ie&&(ie=[],p.set($,ie)),P.isWebGLMultipleRenderTargets){const Se=P.texture;if(ie.length!==Se.length||36064!==ie[0]){for(let Mt=0,Cn=Se.length;Mt<Cn;Mt++)ie[Mt]=36064+Mt;ie.length=Se.length,ve=!0}}else 36064!==ie[0]&&(ie[0]=36064,ve=!0);else 1029!==ie[0]&&(ie[0]=1029,ve=!0);ve&&(t.isWebGL2?i.drawBuffers(ie):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(ie))},useProgram:function it(P){return m!==P&&(i.useProgram(P),m=P,!0)},setBlending:le,setMaterial:function be(P,$){2===P.side?xe(2884):Ge(2884);let ie=1===P.side;$&&(ie=!ie),de(ie),1===P.blending&&!1===P.transparent?le(0):le(P.blending,P.blendEquation,P.blendSrc,P.blendDst,P.blendEquationAlpha,P.blendSrcAlpha,P.blendDstAlpha,P.premultipliedAlpha),l.setFunc(P.depthFunc),l.setTest(P.depthTest),l.setMask(P.depthWrite),a.setMask(P.colorWrite);const ve=P.stencilWrite;c.setTest(ve),ve&&(c.setMask(P.stencilWriteMask),c.setFunc(P.stencilFunc,P.stencilRef,P.stencilFuncMask),c.setOp(P.stencilFail,P.stencilZFail,P.stencilZPass)),Le(P.polygonOffset,P.polygonOffsetFactor,P.polygonOffsetUnits),!0===P.alphaToCoverage?Ge(32926):xe(32926)},setFlipSided:de,setCullFace:Je,setLineWidth:function Fe(P){P!==Z&&(G&&i.lineWidth(P),Z=P)},setPolygonOffset:Le,setScissorTest:function Ot(P){P?Ge(3089):xe(3089)},activeTexture:function St(P){void 0===P&&(P=33984+U-1),ne!==P&&(i.activeTexture(P),ne=P)},bindTexture:function A(P,$,ie){void 0===ie&&(ie=null===ne?33984+U-1:ne);let ve=Q[ie];void 0===ve&&(ve={type:void 0,texture:void 0},Q[ie]=ve),(ve.type!==P||ve.texture!==$)&&(ne!==ie&&(i.activeTexture(ie),ne=ie),i.bindTexture(P,$||j[P]),ve.type=P,ve.texture=$)},unbindTexture:function M(){const P=Q[ne];void 0!==P&&void 0!==P.type&&(i.bindTexture(P.type,null),P.type=void 0,P.texture=void 0)},compressedTexImage2D:function V(){try{i.compressedTexImage2D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},compressedTexImage3D:function re(){try{i.compressedTexImage3D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},texImage2D:function Be(){try{i.texImage2D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},texImage3D:function Me(){try{i.texImage3D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},updateUBOMapping:function mt(P,$){let ie=h.get($);void 0===ie&&(ie=new WeakMap,h.set($,ie));let ve=ie.get(P);void 0===ve&&(ve=i.getUniformBlockIndex($,P.name),ie.set(P,ve))},uniformBlockBinding:function kt(P,$){const ve=h.get($).get(P);u.get(P)!==ve&&(i.uniformBlockBinding($,ve,P.__bindingPointIndex),u.set(P,ve))},texStorage2D:function J(){try{i.texStorage2D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},texStorage3D:function Ce(){try{i.texStorage3D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},texSubImage2D:function ae(){try{i.texSubImage2D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},texSubImage3D:function ge(){try{i.texSubImage3D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},compressedTexSubImage2D:function We(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},compressedTexSubImage3D:function me(){try{i.compressedTexSubImage3D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},scissor:function ke(P){!1===oe.equals(P)&&(i.scissor(P.x,P.y,P.z,P.w),oe.copy(P))},viewport:function De(P){!1===se.equals(P)&&(i.viewport(P.x,P.y,P.z,P.w),se.copy(P))},reset:function Sn(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),!0===n&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),d={},ne=null,Q={},f={},p=new WeakMap,g=[],m=null,y=!1,_=null,v=null,x=null,b=null,S=null,T=null,w=null,C=!1,I=null,F=null,Z=null,k=null,L=null,oe.set(0,0,i.canvas.width,i.canvas.height),se.set(0,0,i.canvas.width,i.canvas.height),a.reset(),l.reset(),c.reset()}}}function xG(i,e,t,n,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let g;const m=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function _(A,M){return y?new OffscreenCanvas(A,M):tu("canvas")}function v(A,M,V,re){let ae=1;if((A.width>re||A.height>re)&&(ae=re/Math.max(A.width,A.height)),ae<1||!0===M){if(typeof HTMLImageElement<"u"&&A instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&A instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&A instanceof ImageBitmap){const ge=M?Wd:Math.floor,We=ge(ae*A.width),me=ge(ae*A.height);void 0===g&&(g=_(We,me));const J=V?_(We,me):g;return J.width=We,J.height=me,J.getContext("2d").drawImage(A,0,0,We,me),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+A.width+"x"+A.height+") to ("+We+"x"+me+")."),J}return"data"in A&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+A.width+"x"+A.height+")."),A}return A}function x(A){return Ly(A.width)&&Ly(A.height)}function S(A,M){return A.generateMipmaps&&M&&A.minFilter!==gn&&A.minFilter!==rn}function T(A){i.generateMipmap(A)}function w(A,M,V,re,ae=!1){if(!1===a)return M;if(null!==A){if(void 0!==i[A])return i[A];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+A+"'")}let ge=M;return 6403===M&&(5126===V&&(ge=33326),5131===V&&(ge=33325),5121===V&&(ge=33321)),33319===M&&(5126===V&&(ge=33328),5131===V&&(ge=33327),5121===V&&(ge=33323)),6408===M&&(5126===V&&(ge=34836),5131===V&&(ge=34842),5121===V&&(ge=re===Ht&&!1===ae?35907:32856),32819===V&&(ge=32854),32820===V&&(ge=32855)),(33325===ge||33326===ge||33327===ge||33328===ge||34842===ge||34836===ge)&&e.get("EXT_color_buffer_float"),ge}function C(A,M,V){return!0===S(A,V)||A.isFramebufferTexture&&A.minFilter!==gn&&A.minFilter!==rn?Math.log2(Math.max(M.width,M.height))+1:void 0!==A.mipmaps&&A.mipmaps.length>0?A.mipmaps.length:A.isCompressedTexture&&Array.isArray(A.image)?M.mipmaps.length:1}function I(A){return A===gn||1004===A||1005===A?9728:9729}function F(A){const M=A.target;M.removeEventListener("dispose",F),function k(A){const M=n.get(A);if(void 0===M.__webglInit)return;const V=A.source,re=m.get(V);if(re){const ae=re[M.__cacheKey];ae.usedTimes--,0===ae.usedTimes&&L(A),0===Object.keys(re).length&&m.delete(V)}n.remove(A)}(M),M.isVideoTexture&&p.delete(M)}function Z(A){const M=A.target;M.removeEventListener("dispose",Z),function U(A){const M=A.texture,V=n.get(A),re=n.get(M);if(void 0!==re.__webglTexture&&(i.deleteTexture(re.__webglTexture),o.memory.textures--),A.depthTexture&&A.depthTexture.dispose(),A.isWebGLCubeRenderTarget)for(let ae=0;ae<6;ae++)i.deleteFramebuffer(V.__webglFramebuffer[ae]),V.__webglDepthbuffer&&i.deleteRenderbuffer(V.__webglDepthbuffer[ae]);else{if(i.deleteFramebuffer(V.__webglFramebuffer),V.__webglDepthbuffer&&i.deleteRenderbuffer(V.__webglDepthbuffer),V.__webglMultisampledFramebuffer&&i.deleteFramebuffer(V.__webglMultisampledFramebuffer),V.__webglColorRenderbuffer)for(let ae=0;ae<V.__webglColorRenderbuffer.length;ae++)V.__webglColorRenderbuffer[ae]&&i.deleteRenderbuffer(V.__webglColorRenderbuffer[ae]);V.__webglDepthRenderbuffer&&i.deleteRenderbuffer(V.__webglDepthRenderbuffer)}if(A.isWebGLMultipleRenderTargets)for(let ae=0,ge=M.length;ae<ge;ae++){const We=n.get(M[ae]);We.__webglTexture&&(i.deleteTexture(We.__webglTexture),o.memory.textures--),n.remove(M[ae])}n.remove(M),n.remove(A)}(M)}function L(A){const M=n.get(A);i.deleteTexture(M.__webglTexture),delete m.get(A.source)[M.__cacheKey],o.memory.textures--}let G=0;function Q(A,M){const V=n.get(A);if(A.isVideoTexture&&function Ot(A){const M=o.render.frame;p.get(A)!==M&&(p.set(A,M),A.update())}(A),!1===A.isRenderTargetTexture&&A.version>0&&V.__version!==A.version){const re=A.image;if(null===re)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==re.complete)return void xe(V,A,M);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(3553,V.__webglTexture,33984+M)}const se={1e3:10497,[Xn]:33071,1002:33648},ue={[gn]:9728,1004:9984,1005:9986,[rn]:9729,1007:9985,1008:9987};function j(A,M,V){if(V?(i.texParameteri(A,10242,se[M.wrapS]),i.texParameteri(A,10243,se[M.wrapT]),(32879===A||35866===A)&&i.texParameteri(A,32882,se[M.wrapR]),i.texParameteri(A,10240,ue[M.magFilter]),i.texParameteri(A,10241,ue[M.minFilter])):(i.texParameteri(A,10242,33071),i.texParameteri(A,10243,33071),(32879===A||35866===A)&&i.texParameteri(A,32882,33071),(M.wrapS!==Xn||M.wrapT!==Xn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(A,10240,I(M.magFilter)),i.texParameteri(A,10241,I(M.minFilter)),M.minFilter!==gn&&M.minFilter!==rn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const re=e.get("EXT_texture_filter_anisotropic");if(M.type===xs&&!1===e.has("OES_texture_float_linear")||!1===a&&M.type===Xc&&!1===e.has("OES_texture_half_float_linear"))return;(M.anisotropy>1||n.get(M).__currentAnisotropy)&&(i.texParameterf(A,re.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(M.anisotropy,r.getMaxAnisotropy())),n.get(M).__currentAnisotropy=M.anisotropy)}}function Ge(A,M){let V=!1;void 0===A.__webglInit&&(A.__webglInit=!0,M.addEventListener("dispose",F));const re=M.source;let ae=m.get(re);void 0===ae&&(ae={},m.set(re,ae));const ge=function ne(A){const M=[];return M.push(A.wrapS),M.push(A.wrapT),M.push(A.wrapR||0),M.push(A.magFilter),M.push(A.minFilter),M.push(A.anisotropy),M.push(A.internalFormat),M.push(A.format),M.push(A.type),M.push(A.generateMipmaps),M.push(A.premultiplyAlpha),M.push(A.flipY),M.push(A.unpackAlignment),M.push(A.encoding),M.join()}(M);if(ge!==A.__cacheKey){void 0===ae[ge]&&(ae[ge]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,V=!0),ae[ge].usedTimes++;const We=ae[A.__cacheKey];void 0!==We&&(ae[A.__cacheKey].usedTimes--,0===We.usedTimes&&L(M)),A.__cacheKey=ge,A.__webglTexture=ae[ge].texture}return V}function xe(A,M,V){let re=3553;(M.isDataArrayTexture||M.isCompressedArrayTexture)&&(re=35866),M.isData3DTexture&&(re=32879);const ae=Ge(A,M),ge=M.source;t.bindTexture(re,A.__webglTexture,33984+V);const We=n.get(ge);if(ge.version!==We.__version||!0===ae){t.activeTexture(33984+V),i.pixelStorei(37440,M.flipY),i.pixelStorei(37441,M.premultiplyAlpha),i.pixelStorei(3317,M.unpackAlignment),i.pixelStorei(37443,0);const me=function b(A){return!a&&(A.wrapS!==Xn||A.wrapT!==Xn||A.minFilter!==gn&&A.minFilter!==rn)}(M)&&!1===x(M.image);let J=v(M.image,me,!1,u);J=St(M,J);const Ce=x(J)||a,Be=s.convert(M.format,M.encoding);let De,Me=s.convert(M.type),ke=w(M.internalFormat,Be,Me,M.encoding,M.isVideoTexture);j(re,M,Ce);const mt=M.mipmaps,kt=a&&!0!==M.isVideoTexture,Sn=void 0===We.__version||!0===ae,P=C(M,J,Ce);if(M.isDepthTexture)ke=6402,a?ke=M.type===xs?36012:M.type===co?33190:M.type===Wa?35056:33189:M.type===xs&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),M.format===uo&&6402===ke&&1012!==M.type&&M.type!==co&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),M.type=co,Me=s.convert(M.type)),M.format===$a&&6402===ke&&(ke=34041,M.type!==Wa&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),M.type=Wa,Me=s.convert(M.type))),Sn&&(kt?t.texStorage2D(3553,1,ke,J.width,J.height):t.texImage2D(3553,0,ke,J.width,J.height,0,Be,Me,null));else if(M.isDataTexture)if(mt.length>0&&Ce){kt&&Sn&&t.texStorage2D(3553,P,ke,mt[0].width,mt[0].height);for(let $=0,ie=mt.length;$<ie;$++)De=mt[$],kt?t.texSubImage2D(3553,$,0,0,De.width,De.height,Be,Me,De.data):t.texImage2D(3553,$,ke,De.width,De.height,0,Be,Me,De.data);M.generateMipmaps=!1}else kt?(Sn&&t.texStorage2D(3553,P,ke,J.width,J.height),t.texSubImage2D(3553,0,0,0,J.width,J.height,Be,Me,J.data)):t.texImage2D(3553,0,ke,J.width,J.height,0,Be,Me,J.data);else if(M.isCompressedTexture)if(M.isCompressedArrayTexture){kt&&Sn&&t.texStorage3D(35866,P,ke,mt[0].width,mt[0].height,J.depth);for(let $=0,ie=mt.length;$<ie;$++)De=mt[$],M.format!==Fi?null!==Be?kt?t.compressedTexSubImage3D(35866,$,0,0,0,De.width,De.height,J.depth,Be,De.data,0,0):t.compressedTexImage3D(35866,$,ke,De.width,De.height,J.depth,0,De.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):kt?t.texSubImage3D(35866,$,0,0,0,De.width,De.height,J.depth,Be,Me,De.data):t.texImage3D(35866,$,ke,De.width,De.height,J.depth,0,Be,Me,De.data)}else{kt&&Sn&&t.texStorage2D(3553,P,ke,mt[0].width,mt[0].height);for(let $=0,ie=mt.length;$<ie;$++)De=mt[$],M.format!==Fi?null!==Be?kt?t.compressedTexSubImage2D(3553,$,0,0,De.width,De.height,Be,De.data):t.compressedTexImage2D(3553,$,ke,De.width,De.height,0,De.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):kt?t.texSubImage2D(3553,$,0,0,De.width,De.height,Be,Me,De.data):t.texImage2D(3553,$,ke,De.width,De.height,0,Be,Me,De.data)}else if(M.isDataArrayTexture)kt?(Sn&&t.texStorage3D(35866,P,ke,J.width,J.height,J.depth),t.texSubImage3D(35866,0,0,0,0,J.width,J.height,J.depth,Be,Me,J.data)):t.texImage3D(35866,0,ke,J.width,J.height,J.depth,0,Be,Me,J.data);else if(M.isData3DTexture)kt?(Sn&&t.texStorage3D(32879,P,ke,J.width,J.height,J.depth),t.texSubImage3D(32879,0,0,0,0,J.width,J.height,J.depth,Be,Me,J.data)):t.texImage3D(32879,0,ke,J.width,J.height,J.depth,0,Be,Me,J.data);else if(M.isFramebufferTexture){if(Sn)if(kt)t.texStorage2D(3553,P,ke,J.width,J.height);else{let $=J.width,ie=J.height;for(let ve=0;ve<P;ve++)t.texImage2D(3553,ve,ke,$,ie,0,Be,Me,null),$>>=1,ie>>=1}}else if(mt.length>0&&Ce){kt&&Sn&&t.texStorage2D(3553,P,ke,mt[0].width,mt[0].height);for(let $=0,ie=mt.length;$<ie;$++)De=mt[$],kt?t.texSubImage2D(3553,$,0,0,Be,Me,De):t.texImage2D(3553,$,ke,Be,Me,De);M.generateMipmaps=!1}else kt?(Sn&&t.texStorage2D(3553,P,ke,J.width,J.height),t.texSubImage2D(3553,0,0,0,Be,Me,J)):t.texImage2D(3553,0,ke,Be,Me,J);S(M,Ce)&&T(re),We.__version=ge.version,M.onUpdate&&M.onUpdate(M)}A.__version=M.version}function pe(A,M,V,re,ae){const ge=s.convert(V.format,V.encoding),We=s.convert(V.type),me=w(V.internalFormat,ge,We,V.encoding);n.get(M).__hasExternalTextures||(32879===ae||35866===ae?t.texImage3D(ae,0,me,M.width,M.height,M.depth,0,ge,We,null):t.texImage2D(ae,0,me,M.width,M.height,0,ge,We,null)),t.bindFramebuffer(36160,A),Le(M)?d.framebufferTexture2DMultisampleEXT(36160,re,ae,n.get(V).__webglTexture,0,Fe(M)):(3553===ae||ae>=34069&&ae<=34074)&&i.framebufferTexture2D(36160,re,ae,n.get(V).__webglTexture,0),t.bindFramebuffer(36160,null)}function it(A,M,V){if(i.bindRenderbuffer(36161,A),M.depthBuffer&&!M.stencilBuffer){let re=33189;if(V||Le(M)){const ae=M.depthTexture;ae&&ae.isDepthTexture&&(ae.type===xs?re=36012:ae.type===co&&(re=33190));const ge=Fe(M);Le(M)?d.renderbufferStorageMultisampleEXT(36161,ge,re,M.width,M.height):i.renderbufferStorageMultisample(36161,ge,re,M.width,M.height)}else i.renderbufferStorage(36161,re,M.width,M.height);i.framebufferRenderbuffer(36160,36096,36161,A)}else if(M.depthBuffer&&M.stencilBuffer){const re=Fe(M);V&&!1===Le(M)?i.renderbufferStorageMultisample(36161,re,35056,M.width,M.height):Le(M)?d.renderbufferStorageMultisampleEXT(36161,re,35056,M.width,M.height):i.renderbufferStorage(36161,34041,M.width,M.height),i.framebufferRenderbuffer(36160,33306,36161,A)}else{const re=!0===M.isWebGLMultipleRenderTargets?M.texture:[M.texture];for(let ae=0;ae<re.length;ae++){const ge=re[ae],We=s.convert(ge.format,ge.encoding),me=s.convert(ge.type),J=w(ge.internalFormat,We,me,ge.encoding),Ce=Fe(M);V&&!1===Le(M)?i.renderbufferStorageMultisample(36161,Ce,J,M.width,M.height):Le(M)?d.renderbufferStorageMultisampleEXT(36161,Ce,J,M.width,M.height):i.renderbufferStorage(36161,J,M.width,M.height)}}i.bindRenderbuffer(36161,null)}function Y(A){const M=n.get(A),V=!0===A.isWebGLCubeRenderTarget;if(A.depthTexture&&!M.__autoAllocateDepthBuffer){if(V)throw new Error("target.depthTexture not supported in Cube render targets");!function X(A,M){if(M&&M.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,A),!M.depthTexture||!M.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(M.depthTexture).__webglTexture||M.depthTexture.image.width!==M.width||M.depthTexture.image.height!==M.height)&&(M.depthTexture.image.width=M.width,M.depthTexture.image.height=M.height,M.depthTexture.needsUpdate=!0),Q(M.depthTexture,0);const re=n.get(M.depthTexture).__webglTexture,ae=Fe(M);if(M.depthTexture.format===uo)Le(M)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,re,0,ae):i.framebufferTexture2D(36160,36096,3553,re,0);else{if(M.depthTexture.format!==$a)throw new Error("Unknown depthTexture format");Le(M)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,re,0,ae):i.framebufferTexture2D(36160,33306,3553,re,0)}}(M.__webglFramebuffer,A)}else if(V){M.__webglDepthbuffer=[];for(let re=0;re<6;re++)t.bindFramebuffer(36160,M.__webglFramebuffer[re]),M.__webglDepthbuffer[re]=i.createRenderbuffer(),it(M.__webglDepthbuffer[re],A,!1)}else t.bindFramebuffer(36160,M.__webglFramebuffer),M.__webglDepthbuffer=i.createRenderbuffer(),it(M.__webglDepthbuffer,A,!1);t.bindFramebuffer(36160,null)}function Fe(A){return Math.min(h,A.samples)}function Le(A){const M=n.get(A);return a&&A.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==M.__useRenderToTexture}function St(A,M){const V=A.encoding,re=A.format,ae=A.type;return!0===A.isCompressedTexture||!0===A.isVideoTexture||1035===A.format||V!==ho&&(V===Ht?!1===a?!0===e.has("EXT_sRGB")&&re===Fi?(A.format=1035,A.minFilter=rn,A.generateMipmaps=!1):M=QD.sRGBToLinear(M):(re!==Fi||ae!==lo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",V)),M}this.allocateTextureUnit=function z(){const A=G;return A>=l&&console.warn("THREE.WebGLTextures: Trying to use "+A+" texture units while this GPU supports only "+l),G+=1,A},this.resetTextureUnits=function te(){G=0},this.setTexture2D=Q,this.setTexture2DArray=function B(A,M){const V=n.get(A);A.version>0&&V.__version!==A.version?xe(V,A,M):t.bindTexture(35866,V.__webglTexture,33984+M)},this.setTexture3D=function H(A,M){const V=n.get(A);A.version>0&&V.__version!==A.version?xe(V,A,M):t.bindTexture(32879,V.__webglTexture,33984+M)},this.setTextureCube=function oe(A,M){const V=n.get(A);A.version>0&&V.__version!==A.version?function Ue(A,M,V){if(6!==M.image.length)return;const re=Ge(A,M),ae=M.source;t.bindTexture(34067,A.__webglTexture,33984+V);const ge=n.get(ae);if(ae.version!==ge.__version||!0===re){t.activeTexture(33984+V),i.pixelStorei(37440,M.flipY),i.pixelStorei(37441,M.premultiplyAlpha),i.pixelStorei(3317,M.unpackAlignment),i.pixelStorei(37443,0);const We=M.isCompressedTexture||M.image[0].isCompressedTexture,me=M.image[0]&&M.image[0].isDataTexture,J=[];for(let $=0;$<6;$++)J[$]=We||me?me?M.image[$].image:M.image[$]:v(M.image[$],!1,!0,c),J[$]=St(M,J[$]);const Ce=J[0],Be=x(Ce)||a,Me=s.convert(M.format,M.encoding),ke=s.convert(M.type),De=w(M.internalFormat,Me,ke,M.encoding),mt=a&&!0!==M.isVideoTexture,kt=void 0===ge.__version||!0===re;let P,Sn=C(M,Ce,Be);if(j(34067,M,Be),We){mt&&kt&&t.texStorage2D(34067,Sn,De,Ce.width,Ce.height);for(let $=0;$<6;$++){P=J[$].mipmaps;for(let ie=0;ie<P.length;ie++){const ve=P[ie];M.format!==Fi?null!==Me?mt?t.compressedTexSubImage2D(34069+$,ie,0,0,ve.width,ve.height,Me,ve.data):t.compressedTexImage2D(34069+$,ie,De,ve.width,ve.height,0,ve.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):mt?t.texSubImage2D(34069+$,ie,0,0,ve.width,ve.height,Me,ke,ve.data):t.texImage2D(34069+$,ie,De,ve.width,ve.height,0,Me,ke,ve.data)}}}else{P=M.mipmaps,mt&&kt&&(P.length>0&&Sn++,t.texStorage2D(34067,Sn,De,J[0].width,J[0].height));for(let $=0;$<6;$++)if(me){mt?t.texSubImage2D(34069+$,0,0,0,J[$].width,J[$].height,Me,ke,J[$].data):t.texImage2D(34069+$,0,De,J[$].width,J[$].height,0,Me,ke,J[$].data);for(let ie=0;ie<P.length;ie++){const Se=P[ie].image[$].image;mt?t.texSubImage2D(34069+$,ie+1,0,0,Se.width,Se.height,Me,ke,Se.data):t.texImage2D(34069+$,ie+1,De,Se.width,Se.height,0,Me,ke,Se.data)}}else{mt?t.texSubImage2D(34069+$,0,0,0,Me,ke,J[$]):t.texImage2D(34069+$,0,De,Me,ke,J[$]);for(let ie=0;ie<P.length;ie++){const ve=P[ie];mt?t.texSubImage2D(34069+$,ie+1,0,0,Me,ke,ve.image[$]):t.texImage2D(34069+$,ie+1,De,Me,ke,ve.image[$])}}}S(M,Be)&&T(34067),ge.__version=ae.version,M.onUpdate&&M.onUpdate(M)}A.__version=M.version}(V,A,M):t.bindTexture(34067,V.__webglTexture,33984+M)},this.rebindTextures=function le(A,M,V){const re=n.get(A);void 0!==M&&pe(re.__webglFramebuffer,A,A.texture,36064,3553),void 0!==V&&Y(A)},this.setupRenderTarget=function be(A){const M=A.texture,V=n.get(A),re=n.get(M);A.addEventListener("dispose",Z),!0!==A.isWebGLMultipleRenderTargets&&(void 0===re.__webglTexture&&(re.__webglTexture=i.createTexture()),re.__version=M.version,o.memory.textures++);const ae=!0===A.isWebGLCubeRenderTarget,ge=!0===A.isWebGLMultipleRenderTargets,We=x(A)||a;if(ae){V.__webglFramebuffer=[];for(let me=0;me<6;me++)V.__webglFramebuffer[me]=i.createFramebuffer()}else{if(V.__webglFramebuffer=i.createFramebuffer(),ge)if(r.drawBuffers){const me=A.texture;for(let J=0,Ce=me.length;J<Ce;J++){const Be=n.get(me[J]);void 0===Be.__webglTexture&&(Be.__webglTexture=i.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&A.samples>0&&!1===Le(A)){const me=ge?M:[M];V.__webglMultisampledFramebuffer=i.createFramebuffer(),V.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,V.__webglMultisampledFramebuffer);for(let J=0;J<me.length;J++){const Ce=me[J];V.__webglColorRenderbuffer[J]=i.createRenderbuffer(),i.bindRenderbuffer(36161,V.__webglColorRenderbuffer[J]);const Be=s.convert(Ce.format,Ce.encoding),Me=s.convert(Ce.type),ke=w(Ce.internalFormat,Be,Me,Ce.encoding,!0===A.isXRRenderTarget),De=Fe(A);i.renderbufferStorageMultisample(36161,De,ke,A.width,A.height),i.framebufferRenderbuffer(36160,36064+J,36161,V.__webglColorRenderbuffer[J])}i.bindRenderbuffer(36161,null),A.depthBuffer&&(V.__webglDepthRenderbuffer=i.createRenderbuffer(),it(V.__webglDepthRenderbuffer,A,!0)),t.bindFramebuffer(36160,null)}}if(ae){t.bindTexture(34067,re.__webglTexture),j(34067,M,We);for(let me=0;me<6;me++)pe(V.__webglFramebuffer[me],A,M,36064,34069+me);S(M,We)&&T(34067),t.unbindTexture()}else if(ge){const me=A.texture;for(let J=0,Ce=me.length;J<Ce;J++){const Be=me[J],Me=n.get(Be);t.bindTexture(3553,Me.__webglTexture),j(3553,Be,We),pe(V.__webglFramebuffer,A,Be,36064+J,3553),S(Be,We)&&T(3553)}t.unbindTexture()}else{let me=3553;(A.isWebGL3DRenderTarget||A.isWebGLArrayRenderTarget)&&(a?me=A.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(me,re.__webglTexture),j(me,M,We),pe(V.__webglFramebuffer,A,M,36064,me),S(M,We)&&T(me),t.unbindTexture()}A.depthBuffer&&Y(A)},this.updateRenderTargetMipmap=function de(A){const M=x(A)||a,V=!0===A.isWebGLMultipleRenderTargets?A.texture:[A.texture];for(let re=0,ae=V.length;re<ae;re++){const ge=V[re];if(S(ge,M)){const We=A.isWebGLCubeRenderTarget?34067:3553,me=n.get(ge).__webglTexture;t.bindTexture(We,me),T(We),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Je(A){if(a&&A.samples>0&&!1===Le(A)){const M=A.isWebGLMultipleRenderTargets?A.texture:[A.texture],V=A.width,re=A.height;let ae=16384;const ge=[],We=A.stencilBuffer?33306:36096,me=n.get(A),J=!0===A.isWebGLMultipleRenderTargets;if(J)for(let Ce=0;Ce<M.length;Ce++)t.bindFramebuffer(36160,me.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+Ce,36161,null),t.bindFramebuffer(36160,me.__webglFramebuffer),i.framebufferTexture2D(36009,36064+Ce,3553,null,0);t.bindFramebuffer(36008,me.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,me.__webglFramebuffer);for(let Ce=0;Ce<M.length;Ce++){ge.push(36064+Ce),A.depthBuffer&&ge.push(We);const Be=void 0!==me.__ignoreDepthValues&&me.__ignoreDepthValues;if(!1===Be&&(A.depthBuffer&&(ae|=256),A.stencilBuffer&&(ae|=1024)),J&&i.framebufferRenderbuffer(36008,36064,36161,me.__webglColorRenderbuffer[Ce]),!0===Be&&(i.invalidateFramebuffer(36008,[We]),i.invalidateFramebuffer(36009,[We])),J){const Me=n.get(M[Ce]).__webglTexture;i.framebufferTexture2D(36009,36064,3553,Me,0)}i.blitFramebuffer(0,0,V,re,0,0,V,re,ae,9728),f&&i.invalidateFramebuffer(36008,ge)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),J)for(let Ce=0;Ce<M.length;Ce++){t.bindFramebuffer(36160,me.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+Ce,36161,me.__webglColorRenderbuffer[Ce]);const Be=n.get(M[Ce]).__webglTexture;t.bindFramebuffer(36160,me.__webglFramebuffer),i.framebufferTexture2D(36009,36064+Ce,3553,Be,0)}t.bindFramebuffer(36009,me.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=Y,this.setupFrameBufferTexture=pe,this.useMultisampledRTT=Le}function wG(i,e,t){const n=t.isWebGL2;return{convert:function r(s,o=null){let a;if(s===lo)return 5121;if(1017===s)return 32819;if(1018===s)return 32820;if(1010===s)return 5120;if(1011===s)return 5122;if(1012===s)return 5123;if(1013===s)return 5124;if(s===co)return 5125;if(s===xs)return 5126;if(s===Xc)return n?5131:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===s)return 6406;if(s===Fi)return 6408;if(1024===s)return 6409;if(1025===s)return 6410;if(s===uo)return 6402;if(s===$a)return 34041;if(1022===s)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(1035===s)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1028===s)return 6403;if(1029===s)return 36244;if(1030===s)return 33319;if(1031===s)return 33320;if(1033===s)return 36249;if(33776===s||33777===s||33778===s||33779===s)if(o===Ht){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(33776===s)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(33776===s)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===s)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===s)return o===Ht?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===s)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===s)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return o===Ht?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===s)return o===Ht?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}return s===Wa?n?34042:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==i[s]?i[s]:null}}}class bG extends Rn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class au extends ki{constructor(){super(),this.isGroup=!0,this.type="Group"}}const MG={type:"move"};class dv{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new au,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new au,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new E,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new E),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new au,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new E,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new E),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(c&&e.hand){o=!0;for(const g of e.hand.values()){const m=t.getJointPose(g,n),y=this._getHandJoint(c,g);null!==m&&(y.matrix.fromArray(m.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.jointRadius=m.radius),y.visible=null!==m}const d=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),f=.02,p=.005;c.inputState.pinching&&d>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&d<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(MG)))}return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new au;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class SG extends ws{constructor(e,t,n,r,s,o,a,l,c,u){if((u=void 0!==u?u:uo)!==uo&&u!==$a)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&u===uo&&(n=co),void 0===n&&u===$a&&(n=Wa),super(null,r,s,o,a,l,u,n,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:gn,this.minFilter=void 0!==l?l:gn,this.flipY=!1,this.generateMipmaps=!1}}class CG extends Ja{constructor(e,t){super();const n=this;let r=null,s=1,o=null,a="local-floor",l=null,c=null,u=null,h=null,d=null,f=null;const p=t.getContextAttributes();let g=null,m=null;const y=[],_=[],v=new Set,x=new Map,b=new Rn;b.layers.enable(1),b.viewport=new Ct;const S=new Rn;S.layers.enable(2),S.viewport=new Ct;const T=[b,S],w=new bG;w.layers.enable(1),w.layers.enable(2);let C=null,I=null;function F(B){const H=_.indexOf(B.inputSource);if(-1===H)return;const oe=y[H];void 0!==oe&&oe.dispatchEvent({type:B.type,data:B.inputSource})}function Z(){r.removeEventListener("select",F),r.removeEventListener("selectstart",F),r.removeEventListener("selectend",F),r.removeEventListener("squeeze",F),r.removeEventListener("squeezestart",F),r.removeEventListener("squeezeend",F),r.removeEventListener("end",Z),r.removeEventListener("inputsourceschange",k);for(let B=0;B<y.length;B++){const H=_[B];null!==H&&(_[B]=null,y[B].disconnect(H))}C=null,I=null,e.setRenderTarget(g),d=null,h=null,u=null,r=null,m=null,Q.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function k(B){for(let H=0;H<B.removed.length;H++){const oe=B.removed[H],se=_.indexOf(oe);se>=0&&(_[se]=null,y[se].disconnect(oe))}for(let H=0;H<B.added.length;H++){const oe=B.added[H];let se=_.indexOf(oe);if(-1===se){for(let j=0;j<y.length;j++){if(j>=_.length){_.push(oe),se=j;break}if(null===_[j]){_[j]=oe,se=j;break}}if(-1===se)break}const ue=y[se];ue&&ue.connect(oe)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(B){let H=y[B];return void 0===H&&(H=new dv,y[B]=H),H.getTargetRaySpace()},this.getControllerGrip=function(B){let H=y[B];return void 0===H&&(H=new dv,y[B]=H),H.getGripSpace()},this.getHand=function(B){let H=y[B];return void 0===H&&(H=new dv,y[B]=H),H.getHandSpace()},this.setFramebufferScaleFactor=function(B){s=B,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(B){a=B,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||o},this.setReferenceSpace=function(B){l=B},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return u},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=function(){var B=function tz(i){return function(){var e=this,t=arguments;return new Promise(function(n,r){var s=i.apply(e,t);function o(l){pD(s,n,r,o,a,"next",l)}function a(l){pD(s,n,r,o,a,"throw",l)}o(void 0)})}}(function*(H){if(r=H,null!==r){if(g=e.getRenderTarget(),r.addEventListener("select",F),r.addEventListener("selectstart",F),r.addEventListener("selectend",F),r.addEventListener("squeeze",F),r.addEventListener("squeezestart",F),r.addEventListener("squeezeend",F),r.addEventListener("end",Z),r.addEventListener("inputsourceschange",k),!0!==p.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)d=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||p.antialias,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:d}),m=new mo(d.framebufferWidth,d.framebufferHeight,{format:Fi,type:lo,encoding:e.outputEncoding,stencilBuffer:p.stencil});else{let oe=null,se=null,ue=null;p.depth&&(ue=p.stencil?35056:33190,oe=p.stencil?$a:uo,se=p.stencil?Wa:co);const j={colorFormat:32856,depthFormat:ue,scaleFactor:s};u=new XRWebGLBinding(r,t),h=u.createProjectionLayer(j),r.updateRenderState({layers:[h]}),m=new mo(h.textureWidth,h.textureHeight,{format:Fi,type:lo,depthTexture:new SG(h.textureWidth,h.textureHeight,se,void 0,void 0,void 0,void 0,void 0,void 0,oe),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0}),e.properties.get(m).__ignoreDepthValues=h.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(1),l=null,o=yield r.requestReferenceSpace(a),Q.setContext(r),Q.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(H){return B.apply(this,arguments)}}();const L=new E,U=new E;function te(B,H){null===H?B.matrixWorld.copy(B.matrix):B.matrixWorld.multiplyMatrices(H.matrixWorld,B.matrix),B.matrixWorldInverse.copy(B.matrixWorld).invert()}this.updateCamera=function(B){if(null===r)return;w.near=S.near=b.near=B.near,w.far=S.far=b.far=B.far,(C!==w.near||I!==w.far)&&(r.updateRenderState({depthNear:w.near,depthFar:w.far}),C=w.near,I=w.far);const H=B.parent,oe=w.cameras;te(w,H);for(let ue=0;ue<oe.length;ue++)te(oe[ue],H);w.matrixWorld.decompose(w.position,w.quaternion,w.scale),B.matrix.copy(w.matrix),B.matrix.decompose(B.position,B.quaternion,B.scale);const se=B.children;for(let ue=0,j=se.length;ue<j;ue++)se[ue].updateMatrixWorld(!0);2===oe.length?function G(B,H,oe){L.setFromMatrixPosition(H.matrixWorld),U.setFromMatrixPosition(oe.matrixWorld);const se=L.distanceTo(U),ue=H.projectionMatrix.elements,j=oe.projectionMatrix.elements,Ge=ue[14]/(ue[10]-1),xe=ue[14]/(ue[10]+1),Ue=(ue[9]+1)/ue[5],pe=(ue[9]-1)/ue[5],it=(ue[8]-1)/ue[0],X=(j[8]+1)/j[0],Y=Ge*it,le=Ge*X,be=se/(-it+X),de=be*-it;H.matrixWorld.decompose(B.position,B.quaternion,B.scale),B.translateX(de),B.translateZ(be),B.matrixWorld.compose(B.position,B.quaternion,B.scale),B.matrixWorldInverse.copy(B.matrixWorld).invert();const Je=Ge+be,Fe=xe+be;B.projectionMatrix.makePerspective(Y-de,le+(se-de),Ue*xe/Fe*Je,pe*xe/Fe*Je,Je,Fe)}(w,b,S):w.projectionMatrix.copy(b.projectionMatrix)},this.getCamera=function(){return w},this.getFoveation=function(){return null!==h?h.fixedFoveation:null!==d?d.fixedFoveation:void 0},this.setFoveation=function(B){null!==h&&(h.fixedFoveation=B),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=B)},this.getPlanes=function(){return v};let z=null;const Q=new pE;Q.setAnimationLoop(function ne(B,H){if(c=H.getViewerPose(l||o),f=H,null!==c){const oe=c.views;null!==d&&(e.setRenderTargetFramebuffer(m,d.framebuffer),e.setRenderTarget(m));let se=!1;oe.length!==w.cameras.length&&(w.cameras.length=0,se=!0);for(let ue=0;ue<oe.length;ue++){const j=oe[ue];let Ge=null;if(null!==d)Ge=d.getViewport(j);else{const Ue=u.getViewSubImage(h,j);Ge=Ue.viewport,0===ue&&(e.setRenderTargetTextures(m,Ue.colorTexture,h.ignoreDepthValues?void 0:Ue.depthStencilTexture),e.setRenderTarget(m))}let xe=T[ue];void 0===xe&&(xe=new Rn,xe.layers.enable(ue),xe.viewport=new Ct,T[ue]=xe),xe.matrix.fromArray(j.transform.matrix),xe.projectionMatrix.fromArray(j.projectionMatrix),xe.viewport.set(Ge.x,Ge.y,Ge.width,Ge.height),0===ue&&w.matrix.copy(xe.matrix),!0===se&&w.cameras.push(xe)}}for(let oe=0;oe<y.length;oe++){const se=_[oe],ue=y[oe];null!==se&&void 0!==ue&&ue.update(se,H,l||o)}if(z&&z(B,H),H.detectedPlanes){n.dispatchEvent({type:"planesdetected",data:H.detectedPlanes});let oe=null;for(const se of v)H.detectedPlanes.has(se)||(null===oe&&(oe=[]),oe.push(se));if(null!==oe)for(const se of oe)v.delete(se),x.delete(se),n.dispatchEvent({type:"planeremoved",data:se});for(const se of H.detectedPlanes)if(v.has(se)){const ue=x.get(se);se.lastChangedTime>ue&&(x.set(se,se.lastChangedTime),n.dispatchEvent({type:"planechanged",data:se}))}else v.add(se),x.set(se,H.lastChangedTime),n.dispatchEvent({type:"planeadded",data:se})}f=null}),this.setAnimationLoop=function(B){z=B},this.dispose=function(){}}}function DG(i,e){function r(g,m){g.opacity.value=m.opacity,m.color&&g.diffuse.value.copy(m.color),m.emissive&&g.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(g.map.value=m.map),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.bumpMap&&(g.bumpMap.value=m.bumpMap,g.bumpScale.value=m.bumpScale,1===m.side&&(g.bumpScale.value*=-1)),m.displacementMap&&(g.displacementMap.value=m.displacementMap,g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap),m.normalMap&&(g.normalMap.value=m.normalMap,g.normalScale.value.copy(m.normalScale),1===m.side&&g.normalScale.value.negate()),m.specularMap&&(g.specularMap.value=m.specularMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);const y=e.get(m).envMap;if(y&&(g.envMap.value=y,g.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1,g.reflectivity.value=m.reflectivity,g.ior.value=m.ior,g.refractionRatio.value=m.refractionRatio),m.lightMap){g.lightMap.value=m.lightMap;const x=!0!==i.physicallyCorrectLights?Math.PI:1;g.lightMapIntensity.value=m.lightMapIntensity*x}let _,v;m.aoMap&&(g.aoMap.value=m.aoMap,g.aoMapIntensity.value=m.aoMapIntensity),m.map?_=m.map:m.specularMap?_=m.specularMap:m.displacementMap?_=m.displacementMap:m.normalMap?_=m.normalMap:m.bumpMap?_=m.bumpMap:m.roughnessMap?_=m.roughnessMap:m.metalnessMap?_=m.metalnessMap:m.alphaMap?_=m.alphaMap:m.emissiveMap?_=m.emissiveMap:m.clearcoatMap?_=m.clearcoatMap:m.clearcoatNormalMap?_=m.clearcoatNormalMap:m.clearcoatRoughnessMap?_=m.clearcoatRoughnessMap:m.iridescenceMap?_=m.iridescenceMap:m.iridescenceThicknessMap?_=m.iridescenceThicknessMap:m.specularIntensityMap?_=m.specularIntensityMap:m.specularColorMap?_=m.specularColorMap:m.transmissionMap?_=m.transmissionMap:m.thicknessMap?_=m.thicknessMap:m.sheenColorMap?_=m.sheenColorMap:m.sheenRoughnessMap&&(_=m.sheenRoughnessMap),void 0!==_&&(_.isWebGLRenderTarget&&(_=_.texture),!0===_.matrixAutoUpdate&&_.updateMatrix(),g.uvTransform.value.copy(_.matrix)),m.aoMap?v=m.aoMap:m.lightMap&&(v=m.lightMap),void 0!==v&&(v.isWebGLRenderTarget&&(v=v.texture),!0===v.matrixAutoUpdate&&v.updateMatrix(),g.uv2Transform.value.copy(v.matrix))}return{refreshFogUniforms:function t(g,m){m.color.getRGB(g.fogColor.value,fE(i)),m.isFog?(g.fogNear.value=m.near,g.fogFar.value=m.far):m.isFogExp2&&(g.fogDensity.value=m.density)},refreshMaterialUniforms:function n(g,m,y,_,v){m.isMeshBasicMaterial||m.isMeshLambertMaterial?r(g,m):m.isMeshToonMaterial?(r(g,m),function u(g,m){m.gradientMap&&(g.gradientMap.value=m.gradientMap)}(g,m)):m.isMeshPhongMaterial?(r(g,m),function c(g,m){g.specular.value.copy(m.specular),g.shininess.value=Math.max(m.shininess,1e-4)}(g,m)):m.isMeshStandardMaterial?(r(g,m),function h(g,m){g.roughness.value=m.roughness,g.metalness.value=m.metalness,m.roughnessMap&&(g.roughnessMap.value=m.roughnessMap),m.metalnessMap&&(g.metalnessMap.value=m.metalnessMap),e.get(m).envMap&&(g.envMapIntensity.value=m.envMapIntensity)}(g,m),m.isMeshPhysicalMaterial&&function d(g,m,y){g.ior.value=m.ior,m.sheen>0&&(g.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),g.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(g.sheenColorMap.value=m.sheenColorMap),m.sheenRoughnessMap&&(g.sheenRoughnessMap.value=m.sheenRoughnessMap)),m.clearcoat>0&&(g.clearcoat.value=m.clearcoat,g.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(g.clearcoatMap.value=m.clearcoatMap),m.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap),m.clearcoatNormalMap&&(g.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),g.clearcoatNormalMap.value=m.clearcoatNormalMap,1===m.side&&g.clearcoatNormalScale.value.negate())),m.iridescence>0&&(g.iridescence.value=m.iridescence,g.iridescenceIOR.value=m.iridescenceIOR,g.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(g.iridescenceMap.value=m.iridescenceMap),m.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=m.iridescenceThicknessMap)),m.transmission>0&&(g.transmission.value=m.transmission,g.transmissionSamplerMap.value=y.texture,g.transmissionSamplerSize.value.set(y.width,y.height),m.transmissionMap&&(g.transmissionMap.value=m.transmissionMap),g.thickness.value=m.thickness,m.thicknessMap&&(g.thicknessMap.value=m.thicknessMap),g.attenuationDistance.value=m.attenuationDistance,g.attenuationColor.value.copy(m.attenuationColor)),g.specularIntensity.value=m.specularIntensity,g.specularColor.value.copy(m.specularColor),m.specularIntensityMap&&(g.specularIntensityMap.value=m.specularIntensityMap),m.specularColorMap&&(g.specularColorMap.value=m.specularColorMap)}(g,m,v)):m.isMeshMatcapMaterial?(r(g,m),function f(g,m){m.matcap&&(g.matcap.value=m.matcap)}(g,m)):m.isMeshDepthMaterial?r(g,m):m.isMeshDistanceMaterial?(r(g,m),function p(g,m){g.referencePosition.value.copy(m.referencePosition),g.nearDistance.value=m.nearDistance,g.farDistance.value=m.farDistance}(g,m)):m.isMeshNormalMaterial?r(g,m):m.isLineBasicMaterial?(function s(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity}(g,m),m.isLineDashedMaterial&&function o(g,m){g.dashSize.value=m.dashSize,g.totalSize.value=m.dashSize+m.gapSize,g.scale.value=m.scale}(g,m)):m.isPointsMaterial?function a(g,m,y,_){let v;g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.size.value=m.size*y,g.scale.value=.5*_,m.map&&(g.map.value=m.map),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest),m.map?v=m.map:m.alphaMap&&(v=m.alphaMap),void 0!==v&&(!0===v.matrixAutoUpdate&&v.updateMatrix(),g.uvTransform.value.copy(v.matrix))}(g,m,y,_):m.isSpriteMaterial?function l(g,m){let y;g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.rotation.value=m.rotation,m.map&&(g.map.value=m.map),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest),m.map?y=m.map:m.alphaMap&&(y=m.alphaMap),void 0!==y&&(!0===y.matrixAutoUpdate&&y.updateMatrix(),g.uvTransform.value.copy(y.matrix))}(g,m):m.isShadowMaterial?(g.color.value.copy(m.color),g.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}}}function EG(i,e,t,n){let r={},s={},o=[];const a=t.isWebGL2?i.getParameter(35375):0;function f(_,v,x){const b=_.value;if(void 0===x[v])return x[v]="number"==typeof b?b:b.clone(),!0;if("number"==typeof b){if(x[v]!==b)return x[v]=b,!0}else{const S=x[v];if(!1===S.equals(b))return S.copy(b),!0}return!1}function g(_){const v=_.value,x={boundary:0,storage:0};return"number"==typeof v?(x.boundary=4,x.storage=4):v.isVector2?(x.boundary=8,x.storage=8):v.isVector3||v.isColor?(x.boundary=16,x.storage=12):v.isVector4?(x.boundary=16,x.storage=16):v.isMatrix3?(x.boundary=48,x.storage=48):v.isMatrix4?(x.boundary=64,x.storage=64):v.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",v),x}function m(_){const v=_.target;v.removeEventListener("dispose",m);const x=o.indexOf(v.__bindingPointIndex);o.splice(x,1),i.deleteBuffer(r[v.id]),delete r[v.id],delete s[v.id]}return{bind:function l(_,v){n.uniformBlockBinding(_,v.program)},update:function c(_,v){let x=r[_.id];void 0===x&&(function p(_){const v=_.uniforms;let x=0;let S=0;for(let T=0,w=v.length;T<w;T++){const C=v[T],I=g(C);if(C.__data=new Float32Array(I.storage/Float32Array.BYTES_PER_ELEMENT),C.__offset=x,T>0){S=x%16;const F=16-S;0!==S&&F-I.boundary<0&&(x+=16-S,C.__offset=x)}x+=I.storage}S=x%16,S>0&&(x+=16-S),_.__size=x,_.__cache={}}(_),x=function u(_){const v=function h(){for(let _=0;_<a;_++)if(-1===o.indexOf(_))return o.push(_),_;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();_.__bindingPointIndex=v;const x=i.createBuffer(),b=_.__size,S=_.usage;return i.bindBuffer(35345,x),i.bufferData(35345,b,S),i.bindBuffer(35345,null),i.bindBufferBase(35345,v,x),x}(_),r[_.id]=x,_.addEventListener("dispose",m)),n.updateUBOMapping(_,v.program);const S=e.render.frame;s[_.id]!==S&&(function d(_){const x=_.uniforms,b=_.__cache;i.bindBuffer(35345,r[_.id]);for(let S=0,T=x.length;S<T;S++){const w=x[S];if(!0===f(w,S,b)){const C=w.value,I=w.__offset;"number"==typeof C?(w.__data[0]=C,i.bufferSubData(35345,I,w.__data)):(w.value.isMatrix3?(w.__data[0]=w.value.elements[0],w.__data[1]=w.value.elements[1],w.__data[2]=w.value.elements[2],w.__data[3]=w.value.elements[0],w.__data[4]=w.value.elements[3],w.__data[5]=w.value.elements[4],w.__data[6]=w.value.elements[5],w.__data[7]=w.value.elements[0],w.__data[8]=w.value.elements[6],w.__data[9]=w.value.elements[7],w.__data[10]=w.value.elements[8],w.__data[11]=w.value.elements[0]):C.toArray(w.__data),i.bufferSubData(35345,I,w.__data))}}i.bindBuffer(35345,null)}(_),s[_.id]=S)},dispose:function y(){for(const _ in r)i.deleteBuffer(r[_]);o=[],r={},s={}}}}function TG(i={}){this.isWebGLRenderer=!0;const e=void 0!==i.canvas?i.canvas:function AG(){const i=tu("canvas");return i.style.display="block",i}(),t=void 0!==i.context?i.context:null,n=void 0===i.depth||i.depth,r=void 0===i.stencil||i.stencil,s=void 0!==i.antialias&&i.antialias,o=void 0===i.premultipliedAlpha||i.premultipliedAlpha,a=void 0!==i.preserveDrawingBuffer&&i.preserveDrawingBuffer,l=void 0!==i.powerPreference?i.powerPreference:"default",c=void 0!==i.failIfMajorPerformanceCaveat&&i.failIfMajorPerformanceCaveat;let u;u=null!==t?t.getContextAttributes().alpha:void 0!==i.alpha&&i.alpha;let h=null,d=null;const f=[],p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=ho,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const g=this;let m=!1,y=0,_=0,v=null,x=-1,b=null;const S=new Ct,T=new Ct;let w=null,C=e.width,I=e.height,F=1,Z=null,k=null;const L=new Ct(0,0,C,I),U=new Ct(0,0,C,I);let G=!1;const te=new sv;let z=!1,ne=!1,Q=null;const B=new Ke,H=new ee,oe=new E,se={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ue(){return null===v?F:1}let xe,Ue,pe,it,X,Y,le,be,de,Je,Fe,Le,Ot,St,A,M,V,re,ae,ge,We,me,J,Ce,j=t;function Ge(D,O){for(let W=0;W<D.length;W++){const q=e.getContext(D[W],O);if(null!==q)return q}return null}try{const D={alpha:!0,depth:n,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r147"),e.addEventListener("webglcontextlost",ke,!1),e.addEventListener("webglcontextrestored",De,!1),e.addEventListener("webglcontextcreationerror",mt,!1),null===j){const O=["webgl2","webgl","experimental-webgl"];if(!0===g.isWebGL1Renderer&&O.shift(),j=Ge(O,D),null===j)throw Ge(O)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===j.getShaderPrecisionFormat&&(j.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(D){throw console.error("THREE.WebGLRenderer: "+D.message),D}function Be(){xe=new VV(j),Ue=new OV(j,xe,i),xe.init(Ue),me=new wG(j,xe,Ue),pe=new _G(j,xe,Ue),it=new WV,X=new aG,Y=new xG(j,xe,pe,X,Ue,me,it),le=new kV(g),be=new UV(g),de=new LB(j,Ue),J=new LV(j,xe,de,Ue),Je=new HV(j,de,it,J),Fe=new JV(j,Je,de,it),ae=new qV(j,Ue,Y),M=new FV(X),Le=new oG(g,le,be,xe,Ue,J,M),Ot=new DG(g,X),St=new cG,A=new gG(xe,Ue),re=new PV(g,le,be,pe,Fe,u,o),V=new vG(g,Fe,Ue),Ce=new EG(j,it,Ue,pe),ge=new NV(j,xe,it,Ue),We=new GV(j,xe,it,Ue),it.programs=Le.programs,g.capabilities=Ue,g.extensions=xe,g.properties=X,g.renderLists=St,g.shadowMap=V,g.state=pe,g.info=it}Be();const Me=new CG(g,j);function ke(D){D.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),m=!0}function De(){console.log("THREE.WebGLRenderer: Context Restored."),m=!1;const D=it.autoReset,O=V.enabled,W=V.autoUpdate,N=V.needsUpdate,q=V.type;Be(),it.autoReset=D,V.enabled=O,V.autoUpdate=W,V.needsUpdate=N,V.type=q}function mt(D){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",D.statusMessage)}function kt(D){const O=D.target;O.removeEventListener("dispose",kt),function Sn(D){(function P(D){const O=X.get(D).programs;void 0!==O&&(O.forEach(function(W){Le.releaseProgram(W)}),D.isShaderMaterial&&Le.releaseShaderCache(D))})(D),X.remove(D)}(O)}this.xr=Me,this.getContext=function(){return j},this.getContextAttributes=function(){return j.getContextAttributes()},this.forceContextLoss=function(){const D=xe.get("WEBGL_lose_context");D&&D.loseContext()},this.forceContextRestore=function(){const D=xe.get("WEBGL_lose_context");D&&D.restoreContext()},this.getPixelRatio=function(){return F},this.setPixelRatio=function(D){void 0!==D&&(F=D,this.setSize(C,I,!1))},this.getSize=function(D){return D.set(C,I)},this.setSize=function(D,O,W){Me.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(C=D,I=O,e.width=Math.floor(D*F),e.height=Math.floor(O*F),!1!==W&&(e.style.width=D+"px",e.style.height=O+"px"),this.setViewport(0,0,D,O))},this.getDrawingBufferSize=function(D){return D.set(C*F,I*F).floor()},this.setDrawingBufferSize=function(D,O,W){C=D,I=O,F=W,e.width=Math.floor(D*W),e.height=Math.floor(O*W),this.setViewport(0,0,D,O)},this.getCurrentViewport=function(D){return D.copy(S)},this.getViewport=function(D){return D.copy(L)},this.setViewport=function(D,O,W,N){D.isVector4?L.set(D.x,D.y,D.z,D.w):L.set(D,O,W,N),pe.viewport(S.copy(L).multiplyScalar(F).floor())},this.getScissor=function(D){return D.copy(U)},this.setScissor=function(D,O,W,N){D.isVector4?U.set(D.x,D.y,D.z,D.w):U.set(D,O,W,N),pe.scissor(T.copy(U).multiplyScalar(F).floor())},this.getScissorTest=function(){return G},this.setScissorTest=function(D){pe.setScissorTest(G=D)},this.setOpaqueSort=function(D){Z=D},this.setTransparentSort=function(D){k=D},this.getClearColor=function(D){return D.copy(re.getClearColor())},this.setClearColor=function(){re.setClearColor.apply(re,arguments)},this.getClearAlpha=function(){return re.getClearAlpha()},this.setClearAlpha=function(){re.setClearAlpha.apply(re,arguments)},this.clear=function(D=!0,O=!0,W=!0){let N=0;D&&(N|=16384),O&&(N|=256),W&&(N|=1024),j.clear(N)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ke,!1),e.removeEventListener("webglcontextrestored",De,!1),e.removeEventListener("webglcontextcreationerror",mt,!1),St.dispose(),A.dispose(),X.dispose(),le.dispose(),be.dispose(),Fe.dispose(),J.dispose(),Ce.dispose(),Le.dispose(),Me.dispose(),Me.removeEventListener("sessionstart",ve),Me.removeEventListener("sessionend",Se),Q&&(Q.dispose(),Q=null),Mt.stop()},this.renderBufferDirect=function(D,O,W,N,q,Ie){null===O&&(O=se);const Ye=q.isMesh&&q.matrixWorld.determinant()<0,rt=function vj(D,O,W,N,q){!0!==O.isScene&&(O=se),Y.resetTextureUnits();const Ie=O.fog,rt=null===v?g.outputEncoding:!0===v.isXRRenderTarget?v.texture.encoding:ho,at=(N.isMeshStandardMaterial?be:le).get(N.envMap||(N.isMeshStandardMaterial?O.environment:null)),yt=!0===N.vertexColors&&!!W.attributes.color&&4===W.attributes.color.itemSize,dt=!!N.normalMap&&!!W.attributes.tangent,ft=!!W.morphAttributes.position,an=!!W.morphAttributes.normal,Di=!!W.morphAttributes.color,rs=N.toneMapped?g.toneMapping:0,zo=W.morphAttributes.position||W.morphAttributes.normal||W.morphAttributes.color,ln=void 0!==zo?zo.length:0,pt=X.get(N),k_=d.state.lights;!0!==z||!0!==ne&&D===b||M.setState(N,D,D===b&&N.id===x);let Dn=!1;N.version===pt.__version?(pt.needsLights&&pt.lightsStateVersion!==k_.state.version||pt.outputEncoding!==rt||q.isInstancedMesh&&!1===pt.instancing||!q.isInstancedMesh&&!0===pt.instancing||q.isSkinnedMesh&&!1===pt.skinning||!q.isSkinnedMesh&&!0===pt.skinning||pt.envMap!==at||!0===N.fog&&pt.fog!==Ie||void 0!==pt.numClippingPlanes&&(pt.numClippingPlanes!==M.numPlanes||pt.numIntersection!==M.numIntersection)||pt.vertexAlphas!==yt||pt.vertexTangents!==dt||pt.morphTargets!==ft||pt.morphNormals!==an||pt.morphColors!==Di||pt.toneMapping!==rs||!0===Ue.isWebGL2&&pt.morphTargetsCount!==ln)&&(Dn=!0):(Dn=!0,pt.__version=N.version);let Bo=pt.currentProgram;!0===Dn&&(Bo=Gi(N,O,q));let gT=!1,Lu=!1,z_=!1;const ni=Bo.getUniforms(),Uo=pt.uniforms;if(pe.useProgram(Bo.program)&&(gT=!0,Lu=!0,z_=!0),N.id!==x&&(x=N.id,Lu=!0),gT||b!==D){if(ni.setValue(j,"projectionMatrix",D.projectionMatrix),Ue.logarithmicDepthBuffer&&ni.setValue(j,"logDepthBufFC",2/(Math.log(D.far+1)/Math.LN2)),b!==D&&(b=D,Lu=!0,z_=!0),N.isShaderMaterial||N.isMeshPhongMaterial||N.isMeshToonMaterial||N.isMeshStandardMaterial||N.envMap){const Ei=ni.map.cameraPosition;void 0!==Ei&&Ei.setValue(j,oe.setFromMatrixPosition(D.matrixWorld))}(N.isMeshPhongMaterial||N.isMeshToonMaterial||N.isMeshLambertMaterial||N.isMeshBasicMaterial||N.isMeshStandardMaterial||N.isShaderMaterial)&&ni.setValue(j,"isOrthographic",!0===D.isOrthographicCamera),(N.isMeshPhongMaterial||N.isMeshToonMaterial||N.isMeshLambertMaterial||N.isMeshBasicMaterial||N.isMeshStandardMaterial||N.isShaderMaterial||N.isShadowMaterial||q.isSkinnedMesh)&&ni.setValue(j,"viewMatrix",D.matrixWorldInverse)}if(q.isSkinnedMesh){ni.setOptional(j,q,"bindMatrix"),ni.setOptional(j,q,"bindMatrixInverse");const Ei=q.skeleton;Ei&&(Ue.floatVertexTextures?(null===Ei.boneTexture&&Ei.computeBoneTexture(),ni.setValue(j,"boneTexture",Ei.boneTexture,Y),ni.setValue(j,"boneTextureSize",Ei.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const B_=W.morphAttributes;if((void 0!==B_.position||void 0!==B_.normal||void 0!==B_.color&&!0===Ue.isWebGL2)&&ae.update(q,W,N,Bo),(Lu||pt.receiveShadow!==q.receiveShadow)&&(pt.receiveShadow=q.receiveShadow,ni.setValue(j,"receiveShadow",q.receiveShadow)),N.isMeshGouraudMaterial&&null!==N.envMap&&(Uo.envMap.value=at,Uo.flipEnvMap.value=at.isCubeTexture&&!1===at.isRenderTargetTexture?-1:1),Lu&&(ni.setValue(j,"toneMappingExposure",g.toneMappingExposure),pt.needsLights&&function _j(D,O){D.ambientLightColor.needsUpdate=O,D.lightProbe.needsUpdate=O,D.directionalLights.needsUpdate=O,D.directionalLightShadows.needsUpdate=O,D.pointLights.needsUpdate=O,D.pointLightShadows.needsUpdate=O,D.spotLights.needsUpdate=O,D.spotLightShadows.needsUpdate=O,D.rectAreaLights.needsUpdate=O,D.hemisphereLights.needsUpdate=O}(Uo,z_),Ie&&!0===N.fog&&Ot.refreshFogUniforms(Uo,Ie),Ot.refreshMaterialUniforms(Uo,N,F,I,Q),vf.upload(j,pt.uniformsList,Uo,Y)),N.isShaderMaterial&&!0===N.uniformsNeedUpdate&&(vf.upload(j,pt.uniformsList,Uo,Y),N.uniformsNeedUpdate=!1),N.isSpriteMaterial&&ni.setValue(j,"center",q.center),ni.setValue(j,"modelViewMatrix",q.modelViewMatrix),ni.setValue(j,"normalMatrix",q.normalMatrix),ni.setValue(j,"modelMatrix",q.matrixWorld),N.isShaderMaterial||N.isRawShaderMaterial){const Ei=N.uniformsGroups;for(let U_=0,wj=Ei.length;U_<wj;U_++)if(Ue.isWebGL2){const mT=Ei[U_];Ce.update(mT,Bo),Ce.bind(mT,Bo)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Bo}(D,O,W,N,q);pe.setMaterial(N,Ye);let at=W.index,yt=1;!0===N.wireframe&&(at=Je.getWireframeAttribute(W),yt=2);const dt=W.drawRange,ft=W.attributes.position;let an=dt.start*yt,Di=(dt.start+dt.count)*yt;null!==Ie&&(an=Math.max(an,Ie.start*yt),Di=Math.min(Di,(Ie.start+Ie.count)*yt)),null!==at?(an=Math.max(an,0),Di=Math.min(Di,at.count)):null!=ft&&(an=Math.max(an,0),Di=Math.min(Di,ft.count));const rs=Di-an;if(rs<0||rs===1/0)return;J.setup(q,N,rt,W,at);let zo,ln=ge;if(null!==at&&(zo=de.get(at),ln=We,ln.setIndex(zo)),q.isMesh)!0===N.wireframe?(pe.setLineWidth(N.wireframeLinewidth*ue()),ln.setMode(1)):ln.setMode(4);else if(q.isLine){let pt=N.linewidth;void 0===pt&&(pt=1),pe.setLineWidth(pt*ue()),ln.setMode(q.isLineSegments?1:q.isLineLoop?2:3)}else q.isPoints?ln.setMode(0):q.isSprite&&ln.setMode(4);if(q.isInstancedMesh)ln.renderInstances(an,rs,q.count);else if(W.isInstancedBufferGeometry){const k_=Math.min(W.instanceCount,void 0!==W._maxInstanceCount?W._maxInstanceCount:1/0);ln.renderInstances(an,rs,k_)}else ln.render(an,rs)},this.compile=function(D,O){function W(N,q,Ie){!0===N.transparent&&2===N.side?(N.side=1,N.needsUpdate=!0,Gi(N,q,Ie),N.side=0,N.needsUpdate=!0,Gi(N,q,Ie),N.side=2):Gi(N,q,Ie)}d=A.get(D),d.init(),p.push(d),D.traverseVisible(function(N){N.isLight&&N.layers.test(O.layers)&&(d.pushLight(N),N.castShadow&&d.pushShadow(N))}),d.setupLights(g.physicallyCorrectLights),D.traverse(function(N){const q=N.material;if(q)if(Array.isArray(q))for(let Ie=0;Ie<q.length;Ie++)W(q[Ie],D,N);else W(q,D,N)}),p.pop(),d=null};let $=null;function ve(){Mt.stop()}function Se(){Mt.start()}const Mt=new pE;function Cn(D,O,W,N){if(!1===D.visible)return;if(D.layers.test(O.layers))if(D.isGroup)W=D.renderOrder;else if(D.isLOD)!0===D.autoUpdate&&D.update(O);else if(D.isLight)d.pushLight(D),D.castShadow&&d.pushShadow(D);else if(D.isSprite){if(!D.frustumCulled||te.intersectsSprite(D)){N&&oe.setFromMatrixPosition(D.matrixWorld).applyMatrix4(B);const Ye=Fe.update(D),rt=D.material;rt.visible&&h.push(D,Ye,rt,W,oe.z,null)}}else if((D.isMesh||D.isLine||D.isPoints)&&(D.isSkinnedMesh&&D.skeleton.frame!==it.render.frame&&(D.skeleton.update(),D.skeleton.frame=it.render.frame),!D.frustumCulled||te.intersectsObject(D))){N&&oe.setFromMatrixPosition(D.matrixWorld).applyMatrix4(B);const Ye=Fe.update(D),rt=D.material;if(Array.isArray(rt)){const at=Ye.groups;for(let yt=0,dt=at.length;yt<dt;yt++){const ft=at[yt],an=rt[ft.materialIndex];an&&an.visible&&h.push(D,Ye,an,W,oe.z,ft)}}else rt.visible&&h.push(D,Ye,rt,W,oe.z,null)}const Ie=D.children;for(let Ye=0,rt=Ie.length;Ye<rt;Ye++)Cn(Ie[Ye],O,W,N)}function Hn(D,O,W,N){const q=D.opaque,Ie=D.transmissive,Ye=D.transparent;d.setupLightsView(W),Ie.length>0&&function ko(D,O,W){const N=Ue.isWebGL2;null===Q&&(Q=new mo(1,1,{generateMipmaps:!0,type:xe.has("EXT_color_buffer_half_float")?Xc:lo,minFilter:1008,samples:N&&!0===s?4:0})),g.getDrawingBufferSize(H),N?Q.setSize(H.x,H.y):Q.setSize(Wd(H.x),Wd(H.y));const q=g.getRenderTarget();g.setRenderTarget(Q),g.clear();const Ie=g.toneMapping;g.toneMapping=0,zt(D,O,W),g.toneMapping=Ie,Y.updateMultisampleRenderTarget(Q),Y.updateRenderTargetMipmap(Q),g.setRenderTarget(q)}(q,O,W),N&&pe.viewport(S.copy(N)),q.length>0&&zt(q,O,W),Ie.length>0&&zt(Ie,O,W),Ye.length>0&&zt(Ye,O,W),pe.buffers.depth.setTest(!0),pe.buffers.depth.setMask(!0),pe.buffers.color.setMask(!0),pe.setPolygonOffset(!1)}function zt(D,O,W){const N=!0===O.isScene?O.overrideMaterial:null;for(let q=0,Ie=D.length;q<Ie;q++){const Ye=D[q],rt=Ye.object,at=Ye.geometry,yt=null===N?Ye.material:N,dt=Ye.group;rt.layers.test(W.layers)&&is(rt,O,W,at,yt,dt)}}function is(D,O,W,N,q,Ie){D.onBeforeRender(g,O,W,N,q,Ie),D.modelViewMatrix.multiplyMatrices(W.matrixWorldInverse,D.matrixWorld),D.normalMatrix.getNormalMatrix(D.modelViewMatrix),q.onBeforeRender(g,O,W,N,D,Ie),!0===q.transparent&&2===q.side?(q.side=1,q.needsUpdate=!0,g.renderBufferDirect(W,O,N,q,D,Ie),q.side=0,q.needsUpdate=!0,g.renderBufferDirect(W,O,N,q,D,Ie),q.side=2):g.renderBufferDirect(W,O,N,q,D,Ie),D.onAfterRender(g,O,W,N,q,Ie)}function Gi(D,O,W){!0!==O.isScene&&(O=se);const N=X.get(D),q=d.state.lights,Ye=q.state.version,rt=Le.getParameters(D,q.state,d.state.shadowsArray,O,W),at=Le.getProgramCacheKey(rt);let yt=N.programs;N.environment=D.isMeshStandardMaterial?O.environment:null,N.fog=O.fog,N.envMap=(D.isMeshStandardMaterial?be:le).get(D.envMap||N.environment),void 0===yt&&(D.addEventListener("dispose",kt),yt=new Map,N.programs=yt);let dt=yt.get(at);if(void 0!==dt){if(N.currentProgram===dt&&N.lightsStateVersion===Ye)return pT(D,rt),dt}else rt.uniforms=Le.getUniforms(D),D.onBuild(W,rt,g),D.onBeforeCompile(rt,g),dt=Le.acquireProgram(rt,at),yt.set(at,dt),N.uniforms=rt.uniforms;const ft=N.uniforms;(!D.isShaderMaterial&&!D.isRawShaderMaterial||!0===D.clipping)&&(ft.clippingPlanes=M.uniform),pT(D,rt),N.needsLights=function xj(D){return D.isMeshLambertMaterial||D.isMeshToonMaterial||D.isMeshPhongMaterial||D.isMeshStandardMaterial||D.isShadowMaterial||D.isShaderMaterial&&!0===D.lights}(D),N.lightsStateVersion=Ye,N.needsLights&&(ft.ambientLightColor.value=q.state.ambient,ft.lightProbe.value=q.state.probe,ft.directionalLights.value=q.state.directional,ft.directionalLightShadows.value=q.state.directionalShadow,ft.spotLights.value=q.state.spot,ft.spotLightShadows.value=q.state.spotShadow,ft.rectAreaLights.value=q.state.rectArea,ft.ltc_1.value=q.state.rectAreaLTC1,ft.ltc_2.value=q.state.rectAreaLTC2,ft.pointLights.value=q.state.point,ft.pointLightShadows.value=q.state.pointShadow,ft.hemisphereLights.value=q.state.hemi,ft.directionalShadowMap.value=q.state.directionalShadowMap,ft.directionalShadowMatrix.value=q.state.directionalShadowMatrix,ft.spotShadowMap.value=q.state.spotShadowMap,ft.spotLightMatrix.value=q.state.spotLightMatrix,ft.spotLightMap.value=q.state.spotLightMap,ft.pointShadowMap.value=q.state.pointShadowMap,ft.pointShadowMatrix.value=q.state.pointShadowMatrix);const an=dt.getUniforms(),Di=vf.seqWithValue(an.seq,ft);return N.currentProgram=dt,N.uniformsList=Di,dt}function pT(D,O){const W=X.get(D);W.outputEncoding=O.outputEncoding,W.instancing=O.instancing,W.skinning=O.skinning,W.morphTargets=O.morphTargets,W.morphNormals=O.morphNormals,W.morphColors=O.morphColors,W.morphTargetsCount=O.morphTargetsCount,W.numClippingPlanes=O.numClippingPlanes,W.numIntersection=O.numClipIntersection,W.vertexAlphas=O.vertexAlphas,W.vertexTangents=O.vertexTangents,W.toneMapping=O.toneMapping}Mt.setAnimationLoop(function ie(D){$&&$(D)}),typeof self<"u"&&Mt.setContext(self),this.setAnimationLoop=function(D){$=D,Me.setAnimationLoop(D),null===D?Mt.stop():Mt.start()},Me.addEventListener("sessionstart",ve),Me.addEventListener("sessionend",Se),this.render=function(D,O){if(void 0===O||!0===O.isCamera){if(!0!==m){if(!0===D.matrixWorldAutoUpdate&&D.updateMatrixWorld(),null===O.parent&&!0===O.matrixWorldAutoUpdate&&O.updateMatrixWorld(),!0===Me.enabled&&!0===Me.isPresenting&&(!0===Me.cameraAutoUpdate&&Me.updateCamera(O),O=Me.getCamera()),!0===D.isScene&&D.onBeforeRender(g,D,O,v),d=A.get(D,p.length),d.init(),p.push(d),B.multiplyMatrices(O.projectionMatrix,O.matrixWorldInverse),te.setFromProjectionMatrix(B),ne=this.localClippingEnabled,z=M.init(this.clippingPlanes,ne,O),h=St.get(D,f.length),h.init(),f.push(h),Cn(D,O,0,g.sortObjects),h.finish(),!0===g.sortObjects&&h.sort(Z,k),!0===z&&M.beginShadows(),V.render(d.state.shadowsArray,D,O),!0===z&&M.endShadows(),!0===this.info.autoReset&&this.info.reset(),re.render(h,D),d.setupLights(g.physicallyCorrectLights),O.isArrayCamera){const N=O.cameras;for(let q=0,Ie=N.length;q<Ie;q++){const Ye=N[q];Hn(h,D,Ye,Ye.viewport)}}else Hn(h,D,O);null!==v&&(Y.updateMultisampleRenderTarget(v),Y.updateRenderTargetMipmap(v)),!0===D.isScene&&D.onAfterRender(g,D,O),J.resetDefaultState(),x=-1,b=null,p.pop(),d=p.length>0?p[p.length-1]:null,f.pop(),h=f.length>0?f[f.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return v},this.setRenderTargetTextures=function(D,O,W){X.get(D.texture).__webglTexture=O,X.get(D.depthTexture).__webglTexture=W;const N=X.get(D);N.__hasExternalTextures=!0,N.__hasExternalTextures&&(N.__autoAllocateDepthBuffer=void 0===W,N.__autoAllocateDepthBuffer||!0===xe.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),N.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(D,O){const W=X.get(D);W.__webglFramebuffer=O,W.__useDefaultFramebuffer=void 0===O},this.setRenderTarget=function(D,O=0,W=0){v=D,y=O,_=W;let N=!0,q=null,Ie=!1,Ye=!1;if(D){const at=X.get(D);void 0!==at.__useDefaultFramebuffer?(pe.bindFramebuffer(36160,null),N=!1):void 0===at.__webglFramebuffer?Y.setupRenderTarget(D):at.__hasExternalTextures&&Y.rebindTextures(D,X.get(D.texture).__webglTexture,X.get(D.depthTexture).__webglTexture);const yt=D.texture;(yt.isData3DTexture||yt.isDataArrayTexture||yt.isCompressedArrayTexture)&&(Ye=!0);const dt=X.get(D).__webglFramebuffer;D.isWebGLCubeRenderTarget?(q=dt[O],Ie=!0):q=Ue.isWebGL2&&D.samples>0&&!1===Y.useMultisampledRTT(D)?X.get(D).__webglMultisampledFramebuffer:dt,S.copy(D.viewport),T.copy(D.scissor),w=D.scissorTest}else S.copy(L).multiplyScalar(F).floor(),T.copy(U).multiplyScalar(F).floor(),w=G;if(pe.bindFramebuffer(36160,q)&&Ue.drawBuffers&&N&&pe.drawBuffers(D,q),pe.viewport(S),pe.scissor(T),pe.setScissorTest(w),Ie){const at=X.get(D.texture);j.framebufferTexture2D(36160,36064,34069+O,at.__webglTexture,W)}else if(Ye){const at=X.get(D.texture);j.framebufferTextureLayer(36160,36064,at.__webglTexture,W||0,O||0)}x=-1},this.readRenderTargetPixels=function(D,O,W,N,q,Ie,Ye){if(!D||!D.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let rt=X.get(D).__webglFramebuffer;if(D.isWebGLCubeRenderTarget&&void 0!==Ye&&(rt=rt[Ye]),rt){pe.bindFramebuffer(36160,rt);try{const at=D.texture,yt=at.format,dt=at.type;if(yt!==Fi&&me.convert(yt)!==j.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ft=dt===Xc&&(xe.has("EXT_color_buffer_half_float")||Ue.isWebGL2&&xe.has("EXT_color_buffer_float"));if(!(dt===lo||me.convert(dt)===j.getParameter(35738)||dt===xs&&(Ue.isWebGL2||xe.has("OES_texture_float")||xe.has("WEBGL_color_buffer_float"))||ft))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");O>=0&&O<=D.width-N&&W>=0&&W<=D.height-q&&j.readPixels(O,W,N,q,me.convert(yt),me.convert(dt),Ie)}finally{const at=null!==v?X.get(v).__webglFramebuffer:null;pe.bindFramebuffer(36160,at)}}},this.copyFramebufferToTexture=function(D,O,W=0){const N=Math.pow(2,-W),q=Math.floor(O.image.width*N),Ie=Math.floor(O.image.height*N);Y.setTexture2D(O,0),j.copyTexSubImage2D(3553,W,0,0,D.x,D.y,q,Ie),pe.unbindTexture()},this.copyTextureToTexture=function(D,O,W,N=0){const q=O.image.width,Ie=O.image.height,Ye=me.convert(W.format),rt=me.convert(W.type);Y.setTexture2D(W,0),j.pixelStorei(37440,W.flipY),j.pixelStorei(37441,W.premultiplyAlpha),j.pixelStorei(3317,W.unpackAlignment),O.isDataTexture?j.texSubImage2D(3553,N,D.x,D.y,q,Ie,Ye,rt,O.image.data):O.isCompressedTexture?j.compressedTexSubImage2D(3553,N,D.x,D.y,O.mipmaps[0].width,O.mipmaps[0].height,Ye,O.mipmaps[0].data):j.texSubImage2D(3553,N,D.x,D.y,Ye,rt,O.image),0===N&&W.generateMipmaps&&j.generateMipmap(3553),pe.unbindTexture()},this.copyTextureToTexture3D=function(D,O,W,N,q=0){if(g.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Ie=D.max.x-D.min.x+1,Ye=D.max.y-D.min.y+1,rt=D.max.z-D.min.z+1,at=me.convert(N.format),yt=me.convert(N.type);let dt;if(N.isData3DTexture)Y.setTexture3D(N,0),dt=32879;else{if(!N.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Y.setTexture2DArray(N,0),dt=35866}j.pixelStorei(37440,N.flipY),j.pixelStorei(37441,N.premultiplyAlpha),j.pixelStorei(3317,N.unpackAlignment);const ft=j.getParameter(3314),an=j.getParameter(32878),Di=j.getParameter(3316),rs=j.getParameter(3315),zo=j.getParameter(32877),ln=W.isCompressedTexture?W.mipmaps[0]:W.image;j.pixelStorei(3314,ln.width),j.pixelStorei(32878,ln.height),j.pixelStorei(3316,D.min.x),j.pixelStorei(3315,D.min.y),j.pixelStorei(32877,D.min.z),W.isDataTexture||W.isData3DTexture?j.texSubImage3D(dt,q,O.x,O.y,O.z,Ie,Ye,rt,at,yt,ln.data):W.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),j.compressedTexSubImage3D(dt,q,O.x,O.y,O.z,Ie,Ye,rt,at,ln.data)):j.texSubImage3D(dt,q,O.x,O.y,O.z,Ie,Ye,rt,at,yt,ln),j.pixelStorei(3314,ft),j.pixelStorei(32878,an),j.pixelStorei(3316,Di),j.pixelStorei(3315,rs),j.pixelStorei(32877,zo),0===q&&N.generateMipmaps&&j.generateMipmap(dt),pe.unbindTexture()},this.initTexture=function(D){D.isCubeTexture?Y.setTextureCube(D,0):D.isData3DTexture?Y.setTexture3D(D,0):D.isDataArrayTexture||D.isCompressedArrayTexture?Y.setTexture2DArray(D,0):Y.setTexture2D(D,0),pe.unbindTexture()},this.resetState=function(){y=0,_=0,v=null,pe.reset(),J.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class GE extends TG{}GE.prototype.isWebGL1Renderer=!0;class WE extends ki{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class mu extends ot{constructor(e=1,t=1,n=1,r=8,s=1,o=!1,a=0,l=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const u=[],h=[],d=[],f=[];let p=0;const g=[],m=n/2;let y=0;function v(x){const b=p,S=new ee,T=new E;let w=0;const C=!0===x?e:t,I=!0===x?1:-1;for(let Z=1;Z<=r;Z++)h.push(0,m*I,0),d.push(0,I,0),f.push(.5,.5),p++;const F=p;for(let Z=0;Z<=r;Z++){const L=Z/r*l+a,U=Math.cos(L),G=Math.sin(L);T.x=C*G,T.y=m*I,T.z=C*U,h.push(T.x,T.y,T.z),d.push(0,I,0),S.x=.5*U+.5,S.y=.5*G*I+.5,f.push(S.x,S.y),p++}for(let Z=0;Z<r;Z++){const k=b+Z,L=F+Z;!0===x?u.push(L,L+1,k):u.push(L+1,L,k),w+=3}c.addGroup(y,w,!0===x?1:2),y+=w}(function _(){const x=new E,b=new E;let S=0;const T=(t-e)/n;for(let w=0;w<=s;w++){const C=[],I=w/s,F=I*(t-e)+e;for(let Z=0;Z<=r;Z++){const k=Z/r,L=k*l+a,U=Math.sin(L),G=Math.cos(L);b.x=F*U,b.y=-I*n+m,b.z=F*G,h.push(b.x,b.y,b.z),x.set(U,T,G).normalize(),d.push(x.x,x.y,x.z),f.push(k,1-I),C.push(p++)}g.push(C)}for(let w=0;w<r;w++)for(let C=0;C<s;C++){const F=g[C+1][w],Z=g[C+1][w+1],k=g[C][w+1];u.push(g[C][w],F,k),u.push(F,Z,k),S+=6}c.addGroup(y,S,0),y+=S})(),!1===o&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(u),this.setAttribute("position",new we(h,3)),this.setAttribute("normal",new we(d,3)),this.setAttribute("uv",new we(f,2))}static fromJSON(e){return new mu(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Rf extends mu{constructor(e=1,t=1,n=8,r=1,s=!1,o=0,a=2*Math.PI){super(0,e,t,n,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new Rf(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class E3 extends al{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ee(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}function Bi(i,e,t){return Uv(i)?new i.constructor(i.subarray(e,void 0!==t?t:i.length)):i.slice(e,t)}function Do(i,e,t){return!i||!t&&i.constructor===e?i:"number"==typeof e.BYTES_PER_ELEMENT?new e(i):Array.prototype.slice.call(i)}function Uv(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}class Uf{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=n+2;;){if(void 0===r){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(s=r,r=t[++n],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(n=2,s=a);for(let l=n-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(r=s,s=t[--n-1],e>=s)break t}o=n,n=0}}for(;n<o;){const a=n+o>>>1;e<t[a]?o=a:n=a+1}if(r=t[n],s=t[n-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=n[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class RW extends Uf{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,n){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:s=e,a=2*t-n;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=n}if(void 0===l)switch(this.getSettings_().endingEnd){case 2401:o=e,l=2*n-t;break;case 2402:o=1,l=n+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(n-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-n),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(n-t)/(r-t),g=p*p,m=g*p,y=-d*m+2*d*g-d*p,_=(1+d)*m+(-1.5-2*d)*g+(-.5+d)*p+1,v=(-1-f)*m+(1.5+f)*g+.5*p,x=f*m-f*g;for(let b=0;b!==a;++b)s[b]=y*o[u+b]+_*o[c+b]+v*o[l+b]+x*o[h+b];return s}}class T3 extends Uf{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(n-t)/(r-t),h=1-u;for(let d=0;d!==a;++d)s[d]=o[c+d]*h+o[l+d]*u;return s}}class PW extends Uf{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class br{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Do(t,this.TimeBufferType),this.values=Do(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Do(e.times,Array),values:Do(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new PW(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new T3(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new RW(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let s=0,o=r-1;for(;s!==r&&n[s]<e;)++s;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Bi(n,s,o),this.values=Bi(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=n[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&Uv(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=Bi(this.times),t=Bi(this.values),n=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const h=a*n,d=h-n,f=h+n;for(let p=0;p!==n;++p){const g=t[h+p];if(g!==t[d+p]||g!==t[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const h=a*n,d=o*n;for(let f=0;f!==n;++f)t[d+f]=t[h+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*n,l=o*n,c=0;c!==n;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=Bi(e,0,o),this.values=Bi(t,0,o*n)):(this.times=e,this.values=t),this}clone(){const e=Bi(this.times,0),t=Bi(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}br.prototype.TimeBufferType=Float32Array,br.prototype.ValueBufferType=Float32Array,br.prototype.DefaultInterpolation=2301;class Cl extends br{}Cl.prototype.ValueTypeName="bool",Cl.prototype.ValueBufferType=Array,Cl.prototype.DefaultInterpolation=2300,Cl.prototype.InterpolantFactoryMethodLinear=void 0,Cl.prototype.InterpolantFactoryMethodSmooth=void 0;(class I3 extends br{}).prototype.ValueTypeName="color";(class Vf extends br{}).prototype.ValueTypeName="number";class LW extends Uf{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(n-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)bi.slerpFlat(s,0,o,c-a,o,c,l);return s}}class xu extends br{InterpolantFactoryMethodLinear(e){return new LW(this.times,this.values,this.getValueSize(),e)}}xu.prototype.ValueTypeName="quaternion",xu.prototype.DefaultInterpolation=2301,xu.prototype.InterpolantFactoryMethodSmooth=void 0;class Dl extends br{}Dl.prototype.ValueTypeName="string",Dl.prototype.ValueBufferType=Array,Dl.prototype.DefaultInterpolation=2300,Dl.prototype.InterpolantFactoryMethodLinear=void 0,Dl.prototype.InterpolantFactoryMethodSmooth=void 0;(class Hf extends br{}).prototype.ValueTypeName="vector";class kW extends Error{constructor(e,t){super(e),this.response=t}}const jv="\\[\\]\\.:\\/",n$=new RegExp("["+jv+"]","g"),qv="[^"+jv+"]",i$="[^"+jv.replace("\\.","")+"]",l$=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",qv)+/(WCOD+)?/.source.replace("WCOD",i$)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",qv)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",qv)+"$"),c$=["material","materials","bones","map"];class u${constructor(e,t,n){const r=n||Lt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}let Lt=(()=>{class i{constructor(t,n,r){this.path=n,this.parsedPath=r||i.parseTrackName(n),this.node=i.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,r){return t&&t.isAnimationObjectGroup?new i.Composite(t,n,r):new i(t,n,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(n$,"")}static parseTrackName(t){const n=l$.exec(t);if(null===n)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==c$.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,n){if(void 0===n||""===n||"."===n||-1===n||n===t.name||n===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(n);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===n||l.uuid===n)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[n++]=r[s]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++]}_setValue_array_setNeedsUpdate(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node;const n=this.parsedPath,r=n.objectName,s=n.propertyName;let o=n.propertyIndex;if(t||(t=i.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let u=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let h=0;h<t.length;h++)if(t[h].name===u){u=h;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return i.Composite=u$,i})();Lt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Lt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Lt.prototype.GetterByBindingType=[Lt.prototype._getValue_direct,Lt.prototype._getValue_array,Lt.prototype._getValue_arrayElement,Lt.prototype._getValue_toArray],Lt.prototype.SetterByBindingTypeAndVersioning=[[Lt.prototype._setValue_direct,Lt.prototype._setValue_direct_setNeedsUpdate,Lt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Lt.prototype._setValue_array,Lt.prototype._setValue_array_setNeedsUpdate,Lt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Lt.prototype._setValue_arrayElement,Lt.prototype._setValue_arrayElement_setNeedsUpdate,Lt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Lt.prototype._setValue_fromArray,Lt.prototype._setValue_fromArray_setNeedsUpdate,Lt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1),typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"147"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="147");class tA{constructor(e,t,n,r,s){this.sender=e,this.receiver=t,this.message=n,this.delay=r,this.data=s}toJSON(){return{type:this.constructor.name,sender:this.sender.uuid,receiver:this.receiver.uuid,message:this.message,delay:this.delay,data:this.data}}fromJSON(e){return this.sender=e.sender,this.receiver=e.receiver,this.message=e.message,this.delay=e.delay,this.data=e.data,this}resolveReferences(e){return this.sender=e.get(this.sender),this.receiver=e.get(this.receiver),this}}class Ft{static setLevel(e){Kf=e}static log(...e){Kf<=Ft.LEVEL.LOG&&console.log(...e)}static warn(...e){Kf<=Ft.LEVEL.WARN&&console.warn(...e)}static error(...e){Kf<=Ft.LEVEL.ERROR&&console.error(...e)}}Ft.LEVEL=Object.freeze({LOG:0,WARN:1,ERROR:2,SILENT:3});let Kf=Ft.LEVEL.WARN;class v${constructor(){this.delayedTelegrams=new Array}deliver(e){const t=e.receiver;return!1===t.handleMessage(e)&&Ft.warn("YUKA.MessageDispatcher: Message not handled by receiver: %o",t),this}dispatch(e,t,n,r,s){const o=new tA(e,t,n,r,s);return r<=0?this.deliver(o):this.delayedTelegrams.push(o),this}dispatchDelayedMessages(e){let t=this.delayedTelegrams.length;for(;t--;){const n=this.delayedTelegrams[t];n.delay-=e,n.delay<=0&&(this.deliver(n),this.delayedTelegrams.pop())}return this}clear(){return this.delayedTelegrams.length=0,this}toJSON(){const e={type:this.constructor.name,delayedTelegrams:new Array};for(let t=0,n=this.delayedTelegrams.length;t<n;t++)e.delayedTelegrams.push(this.delayedTelegrams[t].toJSON());return e}fromJSON(e){this.clear();const t=e.delayedTelegrams;for(let n=0,r=t.length;n<r;n++){const s=t[n],o=(new tA).fromJSON(s);this.delayedTelegrams.push(o)}return this}resolveReferences(e){const t=this.delayedTelegrams;for(let n=0,r=t.length;n<r;n++)t[n].resolveReferences(e);return this}}const Pn=new Array;for(let i=0;i<256;i++)Pn[i]=(i<16?"0":"")+i.toString(16);class ti{static area(e,t,n){return(n.x-e.x)*(t.z-e.z)-(t.x-e.x)*(n.z-e.z)}static argmax(e){const t=Math.max(...e),n=[];for(let r=0,s=e.length;r<s;r++)e[r]===t&&n.push(r);return n}static choice(e,t=null){const n=Math.random();if(null===t)return e[Math.floor(Math.random()*e.length)];{let r=0;const s=e.map((o,a)=>(r+=t[a],r)).findIndex(o=>o>=n);return e[s]}}static clamp(e,t,n){return Math.max(t,Math.min(n,e))}static generateUUID(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Pn[255&e]+Pn[e>>8&255]+Pn[e>>16&255]+Pn[e>>24&255]+"-"+Pn[255&t]+Pn[t>>8&255]+"-"+Pn[t>>16&15|64]+Pn[t>>24&255]+"-"+Pn[63&n|128]+Pn[n>>8&255]+"-"+Pn[n>>16&255]+Pn[n>>24&255]+Pn[255&r]+Pn[r>>8&255]+Pn[r>>16&255]+Pn[r>>24&255]).toUpperCase()}static randFloat(e,t){return e+Math.random()*(t-e)}static randInt(e,t){return e+Math.floor(Math.random()*(t-e+1))}}class R{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}set(e,t,n){return this.x=e,this.y=t,this.z=n,this}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}clone(){return(new this.constructor).copy(this)}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.x/=e,this.y/=e,this.z/=e,this}divideVectors(e,t){return this.x=e.x/t.x,this.y=e.y/t.y,this.z=e.z/t.z,this}reflect(e){return this.sub(_$.copy(e).multiplyScalar(2*this.dot(e)))}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}cross(e){const t=this.x,n=this.y,r=this.z;return this.x=n*e.z-r*e.y,this.y=r*e.x-t*e.z,this.z=t*e.y-n*e.x,this}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}angleTo(e){const t=Math.sqrt(this.squaredLength()*e.squaredLength());if(0===t)return 0;const n=this.dot(e)/t;return Math.acos(ti.clamp(n,-1,1))}length(){return Math.sqrt(this.squaredLength())}squaredLength(){return this.dot(this)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}distanceTo(e){return Math.sqrt(this.squaredDistanceTo(e))}squaredDistanceTo(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){const n=this.y-e.y,r=this.z-e.z;return Math.abs(this.x-e.x)+Math.abs(n)+Math.abs(r)}normalize(){return this.divideScalar(this.length()||1)}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyRotation(e){const t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*n,u=l*n+a*t-s*r,h=l*r+s*n-o*t,d=-s*t-o*n-a*r;return this.x=c*l+d*-s+u*-a-h*-o,this.y=u*l+d*-o+h*-s-c*-a,this.z=h*l+d*-a+c*-o-u*-s,this}extractPositionFromMatrix(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}fromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}fromMatrix4Column(e,t){return this.fromArray(e.elements,4*t)}fromSpherical(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}fromArray(e,t=0){return this.x=e[t+0],this.y=e[t+1],this.z=e[t+2],this}toArray(e,t=0){return e[t+0]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}}const _$=new R,nA=new R(0,1,0),iA=new R,bu=new R,rA=new R,sA=new R,Xv=[2,2,1],Kv=[1,0,0];class Po{constructor(){this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,n,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[3]=t,u[6]=n,u[1]=r,u[4]=s,u[7]=o,u[2]=a,u[5]=l,u[8]=c,this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}clone(){return(new this.constructor).copy(this)}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[3],l=n[6],c=n[1],u=n[4],h=n[7],d=n[2],f=n[5],p=n[8],g=r[0],m=r[3],y=r[6],_=r[1],v=r[4],x=r[7],b=r[2],S=r[5],T=r[8];return s[0]=o*g+a*_+l*b,s[3]=o*m+a*v+l*S,s[6]=o*y+a*x+l*T,s[1]=c*g+u*_+h*b,s[4]=c*m+u*v+h*S,s[7]=c*y+u*x+h*T,s[2]=d*g+f*_+p*b,s[5]=d*m+f*v+p*S,s[8]=d*y+f*x+p*T,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}extractBasis(e,t,n){return e.fromMatrix3Column(this,0),t.fromMatrix3Column(this,1),n.fromMatrix3Column(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,e.y,t.y,n.y,e.z,t.z,n.z),this}lookAt(e,t,n){return iA.crossVectors(n,e).normalize(),bu.crossVectors(nA,t).normalize(),0===bu.squaredLength()&&(sA.copy(t).addScalar(Number.EPSILON),bu.crossVectors(nA,sA).normalize()),rA.crossVectors(t,bu).normalize(),Al.makeBasis(bu,rA,t),Qf.makeBasis(iA,n,e),this.multiplyMatrices(Al,Qf.transpose()),this}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getElementIndex(e,t){return 3*e+t}frobeniusNorm(){const e=this.elements;let t=0;for(let n=0;n<9;n++)t+=e[n]*e[n];return Math.sqrt(t)}offDiagonalFrobeniusNorm(){const e=this.elements;let t=0;for(let n=0;n<3;n++){const r=e[this.getElementIndex(Xv[n],Kv[n])];t+=2*r*r}return Math.sqrt(t)}eigenDecomposition(e){let t=0,n=0;e.unitary.identity(),e.diagonal.copy(this);const s=e.unitary,o=e.diagonal,a=Number.EPSILON*o.frobeniusNorm();for(;n<10&&o.offDiagonalFrobeniusNorm()>a;)o.shurDecomposition(Al),Qf.copy(Al).transpose(),o.multiply(Al),o.premultiply(Qf),s.multiply(Al),++t>2&&(n++,t=0);return e}shurDecomposition(e){let t=0,n=1;const r=this.elements;for(let c=0;c<3;c++){const u=Math.abs(r[this.getElementIndex(Xv[c],Kv[c])]);u>t&&(t=u,n=c)}let s=1,o=0;const a=Kv[n],l=Xv[n];if(Math.abs(r[this.getElementIndex(l,a)])>Number.EPSILON){const d=(r[this.getElementIndex(l,l)]-r[this.getElementIndex(a,a)])/2/r[this.getElementIndex(l,a)];let f;f=d<0?-1/(-d+Math.sqrt(1+d*d)):1/(d+Math.sqrt(1+d*d)),s=1/Math.sqrt(1+f*f),o=f*s}return e.identity(),e.elements[this.getElementIndex(a,a)]=s,e.elements[this.getElementIndex(l,l)]=s,e.elements[this.getElementIndex(l,a)]=o,e.elements[this.getElementIndex(a,l)]=-o,e}fromQuaternion(e){const t=this.elements,n=e.x,r=e.y,s=e.z,o=e.w,a=n+n,l=r+r,c=s+s,u=n*a,h=n*l,d=n*c,f=r*l,p=r*c,g=s*c,m=o*a,y=o*l,_=o*c;return t[0]=1-(f+g),t[3]=h-_,t[6]=d+y,t[1]=h+_,t[4]=1-(u+g),t[7]=p-m,t[2]=d-y,t[5]=p+m,t[8]=1-(u+f),this}fromMatrix4(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],this}fromArray(e,t=0){const n=this.elements;for(let r=0;r<9;r++)n[r]=e[r+t];return this}toArray(e,t=0){const n=this.elements;return e[t+0]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}}const Al=new Po,Qf=new Po,ep=new Po,Qv=new R;class tp{constructor(e=0,t=0,n=0,r=1){this.x=e,this.y=t,this.z=n,this.w=r}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}clone(){return(new this.constructor).copy(this)}inverse(){return this.conjugate().normalize()}conjugate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}length(){return Math.sqrt(this.squaredLength())}squaredLength(){return this.dot(this)}normalize(){let e=this.length();return 0===e?(this.x=0,this.y=0,this.z=0,this.w=1):(e=1/e,this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this.w=this.w*e),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e.x,r=e.y,s=e.z,o=e.w,a=t.x,l=t.y,c=t.z,u=t.w;return this.x=n*u+o*a+r*c-s*l,this.y=r*u+o*l+s*a-n*c,this.z=s*u+o*c+n*l-r*a,this.w=o*u-n*a-r*l-s*c,this}angleTo(e){return 2*Math.acos(Math.abs(ti.clamp(this.dot(e),-1,1)))}rotateTo(e,t,n=1e-4){const r=this.angleTo(e);if(r<n)return!0;const s=Math.min(1,t/r);return this.slerp(e,s),!1}lookAt(e,t,n){ep.lookAt(e,t,n),this.fromMatrix3(ep)}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this.x,r=this.y,s=this.z,o=this.w;let a=o*e.w+n*e.x+r*e.y+s*e.z;if(a<0?(this.w=-e.w,this.x=-e.x,this.y=-e.y,this.z=-e.z,a=-a):this.copy(e),a>=1)return this.w=o,this.x=n,this.y=r,this.z=s,this;const l=Math.sqrt(1-a*a);if(Math.abs(l)<.001)return this.w=.5*(o+this.w),this.x=.5*(n+this.x),this.y=.5*(r+this.y),this.z=.5*(s+this.z),this;const c=Math.atan2(l,a),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this.w=o*u+this.w*h,this.x=n*u+this.x*h,this.y=r*u+this.y*h,this.z=s*u+this.z*h,this}extractRotationFromMatrix(e){const t=ep.elements,n=e.elements,r=1/Qv.fromMatrix4Column(e,0).length(),s=1/Qv.fromMatrix4Column(e,1).length(),o=1/Qv.fromMatrix4Column(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[4]*s,t[4]=n[5]*s,t[5]=n[6]*s,t[6]=n[8]*o,t[7]=n[9]*o,t[8]=n[10]*o,this.fromMatrix3(ep),this}fromEuler(e,t,n){const r=Math.cos(t/2),s=Math.cos(e/2),o=Math.cos(n/2),a=Math.sin(t/2),l=Math.sin(e/2),c=Math.sin(n/2);return this.w=r*s*o+a*l*c,this.x=r*l*o+a*s*c,this.y=a*s*o-r*l*c,this.z=r*s*c-a*l*o,this}toEuler(e){const t=-2*(this.y*this.z-this.x*this.w);return Math.abs(t)>.9999?(e.x=.5*Math.PI*t,e.y=Math.atan2(this.x*this.z+this.w*this.y,.5-this.x*this.x-this.y*this.y),e.z=0):(e.x=Math.asin(t),e.y=Math.atan2(this.x*this.z+this.w*this.y,.5-this.x*this.x-this.y*this.y),e.z=Math.atan2(this.x*this.y+this.w*this.z,.5-this.x*this.x-this.z*this.z)),e}fromMatrix3(e){const t=e.elements,n=t[0],r=t[3],s=t[6],o=t[1],a=t[4],l=t[7],c=t[2],u=t[5],h=t[8],d=n+a+h;if(d>0){let f=.5/Math.sqrt(d+1);this.w=.25/f,this.x=(u-l)*f,this.y=(s-c)*f,this.z=(o-r)*f}else if(n>a&&n>h){let f=2*Math.sqrt(1+n-a-h);this.w=(u-l)/f,this.x=.25*f,this.y=(r+o)/f,this.z=(s+c)/f}else if(a>h){let f=2*Math.sqrt(1+a-n-h);this.w=(s-c)/f,this.x=(r+o)/f,this.y=.25*f,this.z=(l+u)/f}else{let f=2*Math.sqrt(1+h-n-a);this.w=(o-r)/f,this.x=(s+c)/f,this.y=(l+u)/f,this.z=.25*f}return this}fromArray(e,t=0){return this.x=e[t+0],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e,t=0){return e[t+0]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}}class Tl{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,n,r,s,o,a,l,c,u,h,d,f,p,g,m){const y=this.elements;return y[0]=e,y[4]=t,y[8]=n,y[12]=r,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=c,y[6]=u,y[10]=h,y[14]=d,y[3]=f,y[7]=p,y[11]=g,y[15]=m,this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}clone(){return(new this.constructor).copy(this)}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[4],l=n[8],c=n[12],u=n[1],h=n[5],d=n[9],f=n[13],p=n[2],g=n[6],m=n[10],y=n[14],_=n[3],v=n[7],x=n[11],b=n[15],S=r[0],T=r[4],w=r[8],C=r[12],I=r[1],F=r[5],Z=r[9],k=r[13],L=r[2],U=r[6],G=r[10],te=r[14],z=r[3],ne=r[7],Q=r[11],B=r[15];return s[0]=o*S+a*I+l*L+c*z,s[4]=o*T+a*F+l*U+c*ne,s[8]=o*w+a*Z+l*G+c*Q,s[12]=o*C+a*k+l*te+c*B,s[1]=u*S+h*I+d*L+f*z,s[5]=u*T+h*F+d*U+f*ne,s[9]=u*w+h*Z+d*G+f*Q,s[13]=u*C+h*k+d*te+f*B,s[2]=p*S+g*I+m*L+y*z,s[6]=p*T+g*F+m*U+y*ne,s[10]=p*w+g*Z+m*G+y*Q,s[14]=p*C+g*k+m*te+y*B,s[3]=_*S+v*I+x*L+b*z,s[7]=_*T+v*F+x*U+b*ne,s[11]=_*w+v*Z+x*G+b*Q,s[15]=_*C+v*k+x*te+b*B,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}extractBasis(e,t,n){return e.fromMatrix4Column(this,0),t.fromMatrix4Column(this,1),n.fromMatrix4Column(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}compose(e,t,n){return this.fromQuaternion(t),this.scale(n),this.setPosition(e),this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}setPosition(e){const t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}getInverse(e){const t=this.elements,n=e.elements,r=t[0],s=t[1],o=t[2],a=t[3],l=t[4],c=t[5],u=t[6],h=t[7],d=t[8],f=t[9],p=t[10],g=t[11],m=t[12],y=t[13],_=t[14],v=t[15],x=f*_*h-y*p*h+y*u*g-c*_*g-f*u*v+c*p*v,b=m*p*h-d*_*h-m*u*g+l*_*g+d*u*v-l*p*v,S=d*y*h-m*f*h+m*c*g-l*y*g-d*c*v+l*f*v,T=m*f*u-d*y*u-m*c*p+l*y*p+d*c*_-l*f*_,w=r*x+s*b+o*S+a*T;if(0===w)return e.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const C=1/w;return n[0]=x*C,n[1]=(y*p*a-f*_*a-y*o*g+s*_*g+f*o*v-s*p*v)*C,n[2]=(c*_*a-y*u*a+y*o*h-s*_*h-c*o*v+s*u*v)*C,n[3]=(f*u*a-c*p*a-f*o*h+s*p*h+c*o*g-s*u*g)*C,n[4]=b*C,n[5]=(d*_*a-m*p*a+m*o*g-r*_*g-d*o*v+r*p*v)*C,n[6]=(m*u*a-l*_*a-m*o*h+r*_*h+l*o*v-r*u*v)*C,n[7]=(l*p*a-d*u*a+d*o*h-r*p*h-l*o*g+r*u*g)*C,n[8]=S*C,n[9]=(m*f*a-d*y*a-m*s*g+r*y*g+d*s*v-r*f*v)*C,n[10]=(l*y*a-m*c*a+m*s*h-r*y*h-l*s*v+r*c*v)*C,n[11]=(d*c*a-l*f*a-d*s*h+r*f*h+l*s*g-r*c*g)*C,n[12]=T*C,n[13]=(d*y*o-m*f*o+m*s*p-r*y*p-d*s*_+r*f*_)*C,n[14]=(m*c*o-l*y*o-m*s*u+r*y*u+l*s*_-r*c*_)*C,n[15]=(l*f*o-d*c*o+d*s*u-r*f*u-l*s*p+r*c*p)*C,e}getMaxScale(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}fromQuaternion(e){const t=this.elements,n=e.x,r=e.y,s=e.z,o=e.w,a=n+n,l=r+r,c=s+s,u=n*a,h=n*l,d=n*c,f=r*l,p=r*c,g=s*c,m=o*a,y=o*l,_=o*c;return t[0]=1-(f+g),t[4]=h-_,t[8]=d+y,t[1]=h+_,t[5]=1-(u+g),t[9]=p-m,t[2]=d-y,t[6]=p+m,t[10]=1-(u+f),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}fromMatrix3(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=0,t[4]=n[3],t[5]=n[4],t[6]=n[5],t[7]=0,t[8]=n[6],t[9]=n[7],t[10]=n[8],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}fromArray(e,t=0){const n=this.elements;for(let r=0;r<16;r++)n[r]=e[r+t];return this}toArray(e,t=0){const n=this.elements;return e[t+0]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}}const np=new tp,Ps=new R,ip=new R,Il=new tp;class e_{constructor(){this.name="",this.active=!0,this.children=new Array,this.parent=null,this.neighbors=new Array,this.neighborhoodRadius=1,this.updateNeighborhood=!1,this.position=new R,this.rotation=new tp,this.scale=new R(1,1,1),this.forward=new R(0,0,1),this.up=new R(0,1,0),this.boundingRadius=0,this.maxTurnRate=Math.PI,this.canActivateTrigger=!0,this.manager=null,this._localMatrix=new Tl,this._worldMatrix=new Tl,this._cache={position:new R,rotation:new tp,scale:new R(1,1,1)},this._renderComponent=null,this._renderComponentCallback=null,this._started=!1,this._uuid=null,this._worldMatrixDirty=!1}get worldMatrix(){return this._updateWorldMatrix(),this._worldMatrix}get uuid(){return null===this._uuid&&(this._uuid=ti.generateUUID()),this._uuid}start(){return this}update(){return this}add(e){return null!==e.parent&&e.parent.remove(e),this.children.push(e),e.parent=this,this}remove(e){const t=this.children.indexOf(e);return this.children.splice(t,1),e.parent=null,this}getDirection(e){return e.copy(this.forward).applyRotation(this.rotation).normalize()}lookAt(e){const t=this.parent;return null!==t?(this.getWorldPosition(ip),Ps.subVectors(e,ip).normalize(),this.rotation.lookAt(this.forward,Ps,this.up),Il.extractRotationFromMatrix(t.worldMatrix).inverse(),this.rotation.premultiply(Il)):(Ps.subVectors(e,this.position).normalize(),this.rotation.lookAt(this.forward,Ps,this.up)),this}rotateTo(e,t,n=1e-4){const r=this.parent;return null!==r?(this.getWorldPosition(ip),Ps.subVectors(e,ip).normalize(),np.lookAt(this.forward,Ps,this.up),Il.extractRotationFromMatrix(r.worldMatrix).inverse(),np.premultiply(Il)):(Ps.subVectors(e,this.position).normalize(),np.lookAt(this.forward,Ps,this.up)),this.rotation.rotateTo(np,this.maxTurnRate*t,n)}getWorldDirection(e){return Il.extractRotationFromMatrix(this.worldMatrix),e.copy(this.forward).applyRotation(Il).normalize()}getWorldPosition(e){return e.extractPositionFromMatrix(this.worldMatrix)}setRenderComponent(e,t){return this._renderComponent=e,this._renderComponentCallback=t,this}handleMessage(){return!1}lineOfSightTest(){return null}sendMessage(e,t,n=0,r=null){return null!==this.manager?this.manager.sendMessage(this,e,t,n,r):Ft.error("YUKA.GameEntity: The game entity must be added to a manager in order to send a message."),this}toJSON(){return{type:this.constructor.name,uuid:this.uuid,name:this.name,active:this.active,children:oA(this.children),parent:null!==this.parent?this.parent.uuid:null,neighbors:oA(this.neighbors),neighborhoodRadius:this.neighborhoodRadius,updateNeighborhood:this.updateNeighborhood,position:this.position.toArray(new Array),rotation:this.rotation.toArray(new Array),scale:this.scale.toArray(new Array),forward:this.forward.toArray(new Array),up:this.up.toArray(new Array),boundingRadius:this.boundingRadius,maxTurnRate:this.maxTurnRate,canActivateTrigger:this.canActivateTrigger,worldMatrix:this.worldMatrix.toArray(new Array),_localMatrix:this._localMatrix.toArray(new Array),_cache:{position:this._cache.position.toArray(new Array),rotation:this._cache.rotation.toArray(new Array),scale:this._cache.scale.toArray(new Array)},_started:this._started}}fromJSON(e){return this.name=e.name,this.active=e.active,this.neighborhoodRadius=e.neighborhoodRadius,this.updateNeighborhood=e.updateNeighborhood,this.position.fromArray(e.position),this.rotation.fromArray(e.rotation),this.scale.fromArray(e.scale),this.forward.fromArray(e.forward),this.up.fromArray(e.up),this.boundingRadius=e.boundingRadius,this.maxTurnRate=e.maxTurnRate,this.canActivateTrigger=e.canActivateTrigger,this.children=e.children.slice(),this.neighbors=e.neighbors.slice(),this.parent=e.parent,this._localMatrix.fromArray(e._localMatrix),this._worldMatrix.fromArray(e.worldMatrix),this._cache.position.fromArray(e._cache.position),this._cache.rotation.fromArray(e._cache.rotation),this._cache.scale.fromArray(e._cache.scale),this._started=e._started,this._uuid=e.uuid,this}resolveReferences(e){const t=this.neighbors;for(let r=0,s=t.length;r<s;r++)t[r]=e.get(t[r]);const n=this.children;for(let r=0,s=n.length;r<s;r++)n[r]=e.get(n[r]);return this.parent=e.get(this.parent)||null,this}_updateMatrix(){const e=this._cache;e.position.equals(this.position)&&e.rotation.equals(this.rotation)&&e.scale.equals(this.scale)||(this._localMatrix.compose(this.position,this.rotation,this.scale),e.position.copy(this.position),e.rotation.copy(this.rotation),e.scale.copy(this.scale),this._worldMatrixDirty=!0)}_updateWorldMatrix(){const e=this.parent;if(null!==e&&e._updateWorldMatrix(),this._updateMatrix(),!0===this._worldMatrixDirty){null===e?this._worldMatrix.copy(this._localMatrix):this._worldMatrix.multiplyMatrices(this.parent._worldMatrix,this._localMatrix),this._worldMatrixDirty=!1;const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n]._worldMatrixDirty=!0}}updateWorldMatrix(){return console.warn("GameEntity: .updateWorldMatrix() has been removed. World matrices are automatically updated on access."),this}}function oA(i){const e=new Array;for(let t=0,n=i.length;t<n;t++)e.push(i[t].uuid);return e}const aA=new R,t_=new R;class lA extends e_{constructor(){super(),this.velocity=new R,this.maxSpeed=1,this.updateOrientation=!0}update(e){return this.getSpeedSquared()>this.maxSpeed*this.maxSpeed&&(this.velocity.normalize(),this.velocity.multiplyScalar(this.maxSpeed)),aA.copy(this.velocity).multiplyScalar(e),t_.copy(this.position).add(aA),this.updateOrientation&&this.getSpeedSquared()>1e-8&&this.lookAt(t_),this.position.copy(t_),this}getSpeed(){return this.velocity.length()}getSpeedSquared(){return this.velocity.squaredLength()}toJSON(){const e=super.toJSON();return e.velocity=this.velocity.toArray(new Array),e.maxSpeed=this.maxSpeed,e.updateOrientation=this.updateOrientation,e}fromJSON(e){return super.fromJSON(e),this.velocity.fromArray(e.velocity),this.maxSpeed=e.maxSpeed,this.updateOrientation=e.updateOrientation,this}}class ui{constructor(){this.active=!0,this.weight=1}calculate(){}toJSON(){return{type:this.constructor.name,active:this.active,weight:this.weight}}fromJSON(e){return this.active=e.active,this.weight=e.weight,this}resolveReferences(){}}const rp=new R,sp=new R;class cA extends ui{constructor(){super()}calculate(e,t){rp.set(0,0,0);const n=e.neighbors;for(let r=0,s=n.length;r<s;r++)n[r].getDirection(sp),rp.add(sp);return n.length>0&&(rp.divideScalar(n.length),e.getDirection(sp),t.subVectors(rp,sp)),t}}const n_=new R,i_=new R;class op extends ui{constructor(e=new R,t=3,n=0){super(),this.target=e,this.deceleration=t,this.tolerance=n}calculate(e,t){const r=this.deceleration;i_.subVectors(this.target,e.position);const s=i_.length();if(s>this.tolerance){let o=s/r;o=Math.min(o,e.maxSpeed),n_.copy(i_).multiplyScalar(o/s)}else n_.set(0,0,0);return t.subVectors(n_,e.velocity)}toJSON(){const e=super.toJSON();return e.target=this.target.toArray(new Array),e.deceleration=this.deceleration,e}fromJSON(e){return super.fromJSON(e),this.target.fromArray(e.target),this.deceleration=e.deceleration,this}}const r_=new R;class Mu extends ui{constructor(e=new R){super(),this.target=e}calculate(e,t){return r_.subVectors(this.target,e.position).normalize(),r_.multiplyScalar(e.maxSpeed),t.subVectors(r_,e.velocity)}toJSON(){const e=super.toJSON();return e.target=this.target.toArray(new Array),e}fromJSON(e){return super.fromJSON(e),this.target.fromArray(e.target),this}}const ap=new R;class uA extends ui{constructor(){super(),this._seek=new Mu}calculate(e,t){ap.set(0,0,0);const n=e.neighbors;for(let r=0,s=n.length;r<s;r++)ap.add(n[r].position);return n.length>0&&(ap.divideScalar(n.length),this._seek.target=ap,this._seek.calculate(e,t),t.normalize()),t}}const Su=new R;class hA extends ui{constructor(e=new R,t=10){super(),this.target=e,this.panicDistance=t}calculate(e,t){const n=this.target;return e.position.squaredDistanceTo(n)<=this.panicDistance*this.panicDistance&&(Su.subVectors(e.position,n).normalize(),0===Su.squaredLength()&&Su.set(0,0,1),Su.multiplyScalar(e.maxSpeed),t.subVectors(Su,e.velocity)),t}toJSON(){const e=super.toJSON();return e.target=this.target.toArray(new Array),e.panicDistance=this.panicDistance,e}fromJSON(e){return super.fromJSON(e),this.target.fromArray(e.target),this.panicDistance=e.panicDistance,this}}const dA=new R,fA=new R,pA=new R;class x$ extends ui{constructor(e=null,t=10,n=1){super(),this.pursuer=e,this.panicDistance=t,this.predictionFactor=n,this._flee=new hA}calculate(e,t){const n=this.pursuer;dA.subVectors(n.position,e.position);let r=dA.length()/(e.maxSpeed+n.getSpeed());return r*=this.predictionFactor,fA.copy(n.velocity).multiplyScalar(r),pA.addVectors(n.position,fA),this._flee.target=pA,this._flee.panicDistance=this.panicDistance,this._flee.calculate(e,t),t}toJSON(){const e=super.toJSON();return e.pursuer=this.pursuer?this.pursuer.uuid:null,e.panicDistance=this.panicDistance,e.predictionFactor=this.predictionFactor,e}fromJSON(e){return super.fromJSON(e),this.pursuer=e.pursuer,this.panicDistance=e.panicDistance,this.predictionFactor=e.predictionFactor,this}resolveReferences(e){this.pursuer=e.get(this.pursuer)||null}}class s_{constructor(){this.loop=!1,this._waypoints=new Array,this._index=0}add(e){return this._waypoints.push(e),this}clear(){return this._waypoints.length=0,this._index=0,this}current(){return this._waypoints[this._index]}finished(){return!0!==this.loop&&this._index===this._waypoints.length-1}advance(){return this._index++,this._index===this._waypoints.length&&(!0===this.loop?this._index=0:this._index--),this}toJSON(){const e={type:this.constructor.name,loop:this.loop,_waypoints:new Array,_index:this._index},t=this._waypoints;for(let n=0,r=t.length;n<r;n++)e._waypoints.push(t[n].toArray(new Array));return e}fromJSON(e){this.loop=e.loop,this._index=e._index;const t=e._waypoints;for(let n=0,r=t.length;n<r;n++){const s=t[n];this._waypoints.push((new R).fromArray(s))}return this}}class gA extends ui{constructor(e=new s_,t=1){super(),this.path=e,this.nextWaypointDistance=t,this._arrive=new op,this._seek=new Mu}calculate(e,t){const n=this.path;n.current().squaredDistanceTo(e.position)<this.nextWaypointDistance*this.nextWaypointDistance&&n.advance();const s=n.current();return!0===n.finished()?(this._arrive.target=s,this._arrive.calculate(e,t)):(this._seek.target=s,this._seek.calculate(e,t)),t}toJSON(){const e=super.toJSON();return e.path=this.path.toJSON(),e.nextWaypointDistance=this.nextWaypointDistance,e}fromJSON(e){return super.fromJSON(e),this.path.fromJSON(e.path),this.nextWaypointDistance=e.nextWaypointDistance,this}}const lp=new R,cp=new R,mA=new R,yA=new R;class w$ extends ui{constructor(e=null,t=null,n=3){super(),this.entity1=e,this.entity2=t,this.deceleration=n,this._arrive=new op}calculate(e,t){const n=this.entity1,r=this.entity2;lp.addVectors(n.position,r.position).multiplyScalar(.5);const s=e.position.distanceTo(lp)/e.maxSpeed;return cp.copy(n.velocity).multiplyScalar(s),mA.addVectors(n.position,cp),cp.copy(r.velocity).multiplyScalar(s),yA.addVectors(r.position,cp),lp.addVectors(mA,yA).multiplyScalar(.5),this._arrive.deceleration=this.deceleration,this._arrive.target=lp,this._arrive.calculate(e,t),t}toJSON(){const e=super.toJSON();return e.entity1=this.entity1?this.entity1.uuid:null,e.entity2=this.entity2?this.entity2.uuid:null,e.deceleration=this.deceleration,e}fromJSON(e){return super.fromJSON(e),this.entity1=e.entity1,this.entity2=e.entity2,this.deceleration=e.deceleration,this}resolveReferences(e){this.entity1=e.get(this.entity1)||null,this.entity2=e.get(this.entity2)||null}}const Ui=new R,Cu=new R,Ls=new R,Kr=[new R,new R,new R,new R,new R,new R,new R,new R];class Qr{constructor(e=new R,t=new R){this.min=e,this.max=t}set(e,t){return this.min=e,this.max=t,this}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}clone(){return(new this.constructor).copy(this)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max),t}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}expand(e){return this.min.min(e),this.max.max(e),this}getCenter(e){return e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return e.subVectors(this.max,this.min)}intersectsAABB(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsBoundingSphere(e){return this.clampPoint(e.center,Ui),Ui.squaredDistanceTo(e.center)<=e.radius*e.radius}intersectsPlane(e){const t=e.normal;this.getCenter(Cu),Ls.subVectors(this.max,Cu);const n=Ls.x*Math.abs(t.x)+Ls.y*Math.abs(t.y)+Ls.z*Math.abs(t.z),r=e.distanceToPoint(Cu);return Math.abs(r)<=n}getNormalFromSurfacePoint(e,t){t.set(0,0,0);let n,r=1/0;return this.getCenter(Cu),this.getSize(Ls),Ui.copy(e).sub(Cu),n=Math.abs(Ls.x-Math.abs(Ui.x)),n<r&&(r=n,t.set(1*Math.sign(Ui.x),0,0)),n=Math.abs(Ls.y-Math.abs(Ui.y)),n<r&&(r=n,t.set(0,1*Math.sign(Ui.y),0)),n=Math.abs(Ls.z-Math.abs(Ui.z)),n<r&&t.set(0,0,1*Math.sign(Ui.z)),t}fromCenterAndSize(e,t){return Ui.copy(t).multiplyScalar(.5),this.min.copy(e).sub(Ui),this.max.copy(e).add(Ui),this}fromPoints(e){this.min.set(1/0,1/0,1/0),this.max.set(-1/0,-1/0,-1/0);for(let t=0,n=e.length;t<n;t++)this.expand(e[t]);return this}applyMatrix4(e){const t=this.min,n=this.max;return Kr[0].set(t.x,t.y,t.z).applyMatrix4(e),Kr[1].set(t.x,t.y,n.z).applyMatrix4(e),Kr[2].set(t.x,n.y,t.z).applyMatrix4(e),Kr[3].set(t.x,n.y,n.z).applyMatrix4(e),Kr[4].set(n.x,t.y,t.z).applyMatrix4(e),Kr[5].set(n.x,t.y,n.z).applyMatrix4(e),Kr[6].set(n.x,n.y,t.z).applyMatrix4(e),Kr[7].set(n.x,n.y,n.z).applyMatrix4(e),this.fromPoints(Kr)}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{type:this.constructor.name,min:this.min.toArray(new Array),max:this.max.toArray(new Array)}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const o_=new Qr;class Lo{constructor(e=new R,t=0){this.center=e,this.radius=t}set(e,t){return this.center=e,this.radius=t,this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}clone(){return(new this.constructor).copy(this)}clampPoint(e,t){return t.copy(e),this.center.squaredDistanceTo(e)>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}containsPoint(e){return e.squaredDistanceTo(this.center)<=this.radius*this.radius}intersectsBoundingSphere(e){const t=this.radius+e.radius;return e.center.squaredDistanceTo(this.center)<=t*t}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}getNormalFromSurfacePoint(e,t){return t.subVectors(e,this.center).normalize()}fromPoints(e){return o_.fromPoints(e),o_.getCenter(this.center),this.radius=this.center.distanceTo(o_.max),this}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScale(),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}toJSON(){return{type:this.constructor.name,center:this.center.toArray(new Array),radius:this.radius}}fromJSON(e){return this.center.fromArray(e.center),this.radius=e.radius,this}}const Vi=new R,a_=new R,up=new R,l_=new R,vA=new R,hp=new Tl,b$=new Tl,_A=new Qr;class dp{constructor(e=new R,t=new R){this.origin=e,this.direction=t}set(e,t){return this.origin=e,this.direction=t,this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}clone(){return(new this.constructor).copy(this)}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}intersectBoundingSphere(e,t){Vi.subVectors(e.center,this.origin);const n=Vi.dot(this.direction),r=Vi.dot(Vi)-n*n,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,l=n+o;return a<0&&l<0?null:this.at(a<0?l:a,t)}intersectsBoundingSphere(e){const t=new R;let n;const r=t.subVectors(e.center,this.origin).dot(this.direction);return r<0?n=this.origin.squaredDistanceTo(e.center):(t.copy(this.direction).multiplyScalar(r).add(this.origin),n=t.squaredDistanceTo(e.center)),n<=e.radius*e.radius}intersectAABB(e,t){let n,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return c>=0?(n=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(n=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),u>=0?(s=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),n>o||s>r||((s>n||n!=n)&&(n=s),(o<r||r!=r)&&(r=o),h>=0?(a=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),n>l||a>r)||((a>n||n!=n)&&(n=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(n>=0?n:r,t)}intersectsAABB(e){return null!==this.intersectAABB(e,Vi)}intersectPlane(e,t){let n;const r=e.normal.dot(this.direction);if(0===r){if(0!==e.distanceToPoint(this.origin))return null;n=0}else n=-(this.origin.dot(e.normal)+e.constant)/r;return n>=0?this.at(n,t):null}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectOBB(e,t){return e.getSize(vA),_A.fromCenterAndSize(Vi.set(0,0,0),vA),hp.fromMatrix3(e.rotation),hp.setPosition(e.center),xA.copy(this).applyMatrix4(hp.getInverse(b$)),xA.intersectAABB(_A,t)?t.applyMatrix4(hp):null}intersectsOBB(e){return null!==this.intersectOBB(e,Vi)}intersectConvexHull(e,t){const n=e.faces;let r=-1/0,s=1/0;for(let o=0,a=n.length;o<a;o++){const c=n[o].plane,u=c.distanceToPoint(this.origin),h=c.normal.dot(this.direction);if(u>0&&h>=0)return null;const d=0!==h?-u/h:0;if(!(d<=0)&&(h>0?s=Math.min(d,s):r=Math.max(d,r),r>s))return null}return this.at(r!==-1/0?r:s,t),t}intersectsConvexHull(e){return null!==this.intersectConvexHull(e,Vi)}intersectTriangle(e,t,n){const r=e.a,o=e.c;a_.subVectors(e.b,r),up.subVectors(o,r),l_.crossVectors(a_,up);let l,a=this.direction.dot(l_);if(a>0){if(t)return null;l=1}else{if(!(a<0))return null;l=-1,a=-a}Vi.subVectors(this.origin,r);const c=l*this.direction.dot(up.crossVectors(Vi,up));if(c<0)return null;const u=l*this.direction.dot(a_.cross(Vi));if(u<0||c+u>a)return null;const h=-l*Vi.dot(l_);return h<0?null:this.at(h/a,n)}intersectBVH(e,t){return e.root.intersectRay(this,t)}intersectsBVH(e){return e.root.intersectsRay(this)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}const xA=new dp,wA=new Tl,Rl=new R,fp=new R,c_=new R,u_=new Lo,M$=new dp(new R(0,0,0),new R(0,0,1));class S$ extends ui{constructor(e=new Array){super(),this.obstacles=e,this.brakingWeight=.2,this.dBoxMinLength=4}calculate(e,t){const n=this.obstacles;let r=null,s=1/0;const o=this.dBoxMinLength+e.getSpeed()/e.maxSpeed*this.dBoxMinLength;e.worldMatrix.getInverse(wA);for(let a=0,l=n.length;a<l;a++){const c=n[a];if(c!==e&&(Rl.copy(c.position).applyMatrix4(wA),Rl.z>0&&Math.abs(Rl.z)<o)){const u=c.boundingRadius+e.boundingRadius;Math.abs(Rl.x)<u&&(u_.center.copy(Rl),u_.radius=u,M$.intersectBoundingSphere(u_,c_),c_.z<s&&(s=c_.z,r=c,fp.copy(Rl)))}}return null!==r&&(t.x=(r.boundingRadius-fp.x)*(1+(o-fp.z)/o),t.z=(r.boundingRadius-fp.z)*this.brakingWeight,t.applyRotation(e.rotation)),t}toJSON(){const e=super.toJSON();e.obstacles=new Array,e.brakingWeight=this.brakingWeight,e.dBoxMinLength=this.dBoxMinLength;for(let t=0,n=this.obstacles.length;t<n;t++)e.obstacles.push(this.obstacles[t].uuid);return e}fromJSON(e){return super.fromJSON(e),this.obstacles=e.obstacles,this.brakingWeight=e.brakingWeight,this.dBoxMinLength=e.dBoxMinLength,this}resolveReferences(e){const t=this.obstacles;for(let n=0,r=t.length;n<r;n++)t[n]=e.get(t[n])}}const h_=new R,bA=new R,MA=new R,SA=new R;class C$ extends ui{constructor(e=null,t=new R){super(),this.leader=e,this.offset=t,this._arrive=new op,this._arrive.deceleration=1.5}calculate(e,t){const n=this.leader;h_.copy(this.offset).applyMatrix4(n.worldMatrix),bA.subVectors(h_,e.position);const s=bA.length()/(e.maxSpeed+n.getSpeed());return MA.copy(n.velocity).multiplyScalar(s),SA.addVectors(h_,MA),this._arrive.target=SA,this._arrive.calculate(e,t),t}toJSON(){const e=super.toJSON();return e.leader=this.leader?this.leader.uuid:null,e.offset=this.offset,e}fromJSON(e){return super.fromJSON(e),this.leader=e.leader,this.offset=e.offset,this}resolveReferences(e){this.leader=e.get(this.leader)||null}}const d_=new R,f_=new R,CA=new R,DA=new R,EA=new R;class AA extends ui{constructor(e=null,t=1){super(),this.evader=e,this.predictionFactor=t,this._seek=new Mu}calculate(e,t){const n=this.evader;d_.subVectors(n.position,e.position),e.getDirection(f_),n.getDirection(CA);const r=d_.dot(f_)>0,s=f_.dot(CA)<-.95;if(!0===r&&!0===s)return this._seek.target=n.position,this._seek.calculate(e,t),t;let o=d_.length()/(e.maxSpeed+n.getSpeed());return o*=this.predictionFactor,DA.copy(n.velocity).multiplyScalar(o),EA.addVectors(n.position,DA),this._seek.target=EA,this._seek.calculate(e,t),t}toJSON(){const e=super.toJSON();return e.evader=this.evader?this.evader.uuid:null,e.predictionFactor=this.predictionFactor,e}fromJSON(e){return super.fromJSON(e),this.evader=e.evader,this.predictionFactor=e.predictionFactor,this}resolveReferences(e){this.evader=e.get(this.evader)||null}}const pp=new R;class TA extends ui{constructor(){super()}calculate(e,t){const n=e.neighbors;for(let r=0,s=n.length;r<s;r++){pp.subVectors(e.position,n[r].position);let a=pp.length();0===a&&(a=1e-4),pp.normalize().divideScalar(a),t.add(pp)}return t}}const gp=new R,p_=new R;class D$ extends ui{constructor(e=1,t=5,n=5){super(),this.radius=e,this.distance=t,this.jitter=n,this._targetLocal=new R,function E$(i,e){const t=Math.random()*Math.PI*2;e.x=i*Math.cos(t),e.z=i*Math.sin(t)}(this.radius,this._targetLocal)}calculate(e,t,n){const r=this.jitter*n;return p_.x=ti.randFloat(-1,1)*r,p_.z=ti.randFloat(-1,1)*r,this._targetLocal.add(p_),this._targetLocal.normalize(),this._targetLocal.multiplyScalar(this.radius),gp.copy(this._targetLocal),gp.z+=this.distance,gp.applyMatrix4(e.worldMatrix),t.subVectors(gp,e.position),t}toJSON(){const e=super.toJSON();return e.radius=this.radius,e.distance=this.distance,e.jitter=this.jitter,e._targetLocal=this._targetLocal.toArray(new Array),e}fromJSON(e){return super.fromJSON(e),this.radius=e.radius,this.distance=e.distance,this.jitter=e.jitter,this._targetLocal.fromArray(e._targetLocal),this}}const mp=new R;class IA{constructor(e){this.vehicle=e,this.behaviors=new Array,this._steeringForce=new R,this._typesMap=new Map}add(e){return this.behaviors.push(e),this}remove(e){const t=this.behaviors.indexOf(e);return this.behaviors.splice(t,1),this}clear(){return this.behaviors.length=0,this}calculate(e,t){return this._calculateByOrder(e),t.copy(this._steeringForce)}_accumulate(e){const t=this._steeringForce.length(),n=this.vehicle.maxForce-t;return!(n<=0||(e.length()>n&&e.normalize().multiplyScalar(n),this._steeringForce.add(e),0))}_calculateByOrder(e){const t=this.behaviors;this._steeringForce.set(0,0,0);for(let n=0,r=t.length;n<r;n++){const s=t[n];if(!0===s.active&&(mp.set(0,0,0),s.calculate(this.vehicle,mp,e),mp.multiplyScalar(s.weight),!1===this._accumulate(mp)))return}}toJSON(){const e={type:"SteeringManager",behaviors:new Array},t=this.behaviors;for(let n=0,r=t.length;n<r;n++)e.behaviors.push(t[n].toJSON());return e}fromJSON(e){this.clear();const t=e.behaviors;for(let n=0,r=t.length;n<r;n++){const s=t[n],o=s.type;let a;switch(o){case"SteeringBehavior":a=(new ui).fromJSON(s);break;case"AlignmentBehavior":a=(new cA).fromJSON(s);break;case"ArriveBehavior":a=(new op).fromJSON(s);break;case"CohesionBehavior":a=(new uA).fromJSON(s);break;case"EvadeBehavior":a=(new x$).fromJSON(s);break;case"FleeBehavior":a=(new hA).fromJSON(s);break;case"FollowPathBehavior":a=(new gA).fromJSON(s);break;case"InterposeBehavior":a=(new w$).fromJSON(s);break;case"ObstacleAvoidanceBehavior":a=(new S$).fromJSON(s);break;case"OffsetPursuitBehavior":a=(new C$).fromJSON(s);break;case"PursuitBehavior":a=(new AA).fromJSON(s);break;case"SeekBehavior":a=(new Mu).fromJSON(s);break;case"SeparationBehavior":a=(new TA).fromJSON(s);break;case"WanderBehavior":a=(new D$).fromJSON(s);break;default:const l=this._typesMap.get(o);if(void 0===l){Ft.warn("YUKA.SteeringManager: Unsupported steering behavior type:",o);continue}a=(new l).fromJSON(s)}this.add(a)}return this}registerType(e,t){return this._typesMap.set(e,t),this}resolveReferences(e){const t=this.behaviors;for(let n=0,r=t.length;n<r;n++)t[n].resolveReferences(e);return this}}class A${constructor(e=10){this.count=e,this._history=new Array,this._slot=0;for(let t=0;t<this.count;t++)this._history[t]=new R}calculate(e,t){t.set(0,0,0),this._slot===this.count&&(this._slot=0),this._history[this._slot].copy(e),this._slot++;for(let n=0;n<this.count;n++)t.add(this._history[n]);return t.divideScalar(this.count),t}toJSON(){const e={type:this.constructor.name,count:this.count,_history:new Array,_slot:this._slot},t=this._history;for(let n=0,r=t.length;n<r;n++)e._history.push(t[n].toArray(new Array));return e}fromJSON(e){this.count=e.count,this._slot=e._slot;const t=e._history;this._history.length=0;for(let n=0,r=t.length;n<r;n++){const s=t[n];this._history.push((new R).fromArray(s))}return this}}const RA=new R,yp=new R,PA=new R,Du=new R,LA=new R;class g_ extends lA{constructor(){super(),this.mass=1,this.maxForce=100,this.steering=new IA(this),this.smoother=null}update(e){return this.steering.calculate(e,RA),PA.copy(RA).divideScalar(this.mass),this.velocity.add(PA.multiplyScalar(e)),this.getSpeedSquared()>this.maxSpeed*this.maxSpeed&&(this.velocity.normalize(),this.velocity.multiplyScalar(this.maxSpeed)),yp.copy(this.velocity).multiplyScalar(e),Du.copy(this.position).add(yp),!0===this.updateOrientation&&null===this.smoother&&this.getSpeedSquared()>1e-8&&this.lookAt(Du),this.position.copy(Du),!0===this.updateOrientation&&null!==this.smoother&&(this.smoother.calculate(this.velocity,LA),yp.copy(LA).multiplyScalar(e),Du.copy(this.position).add(yp),this.lookAt(Du)),this}toJSON(){const e=super.toJSON();return e.mass=this.mass,e.maxForce=this.maxForce,e.steering=this.steering.toJSON(),e.smoother=this.smoother?this.smoother.toJSON():null,e}fromJSON(e){return super.fromJSON(e),this.mass=e.mass,this.maxForce=e.maxForce,this.steering=new IA(this).fromJSON(e.steering),this.smoother=e.smoother?(new A$).fromJSON(e.smoother):null,this}resolveReferences(e){super.resolveReferences(e),this.steering.resolveReferences(e)}}class vp{touching(){return!1}update(){return this}toJSON(){return{type:this.constructor.name}}fromJSON(){return this}}const NA=new Lo,OA=new R;class T$ extends vp{constructor(e=new R){super(),this.size=e,this._aabb=new Qr}touching(e){return NA.set(e.position,e.boundingRadius),this._aabb.intersectsBoundingSphere(NA)}update(e){return e.getWorldPosition(OA),this._aabb.fromCenterAndSize(OA,this.size),this}toJSON(){const e=super.toJSON();return e.size=this.size.toArray(new Array),e}fromJSON(e){return super.fromJSON(e),this.size.fromArray(e.size),this}}const m_=new Lo;class I$ extends vp{constructor(e=0){super(),this.radius=e,this._boundingSphere=new Lo}touching(e){return e.getWorldPosition(m_.center),m_.radius=e.boundingRadius,this._boundingSphere.intersectsBoundingSphere(m_)}update(e){return e.getWorldPosition(this._boundingSphere.center),this._boundingSphere.radius=this.radius,this}toJSON(){const e=super.toJSON();return e.radius=this.radius,e}fromJSON(e){return super.fromJSON(e),this.radius=e.radius,this}}class FA extends e_{constructor(e=new vp){super(),this.region=e,this.canActivateTrigger=!1,this._typesMap=new Map}check(e){return!0===this.region.touching(e)&&this.execute(e),this}execute(){}updateRegion(){return this.region.update(this),this}toJSON(){const e=super.toJSON();return e.region=this.region.toJSON(),e}fromJSON(e){super.fromJSON(e);const t=e.region;let n=t.type;switch(n){case"TriggerRegion":this.region=(new vp).fromJSON(t);break;case"RectangularTriggerRegion":this.region=(new T$).fromJSON(t);break;case"SphericalTriggerRegion":this.region=(new I$).fromJSON(t);break;default:const r=this._typesMap.get(n);void 0!==r?this.region=(new r).fromJSON(t):Ft.warn("YUKA.Trigger: Unsupported trigger region type:",t.type)}return this}registerType(e,t){return this._typesMap.set(e,t),this}}const Eu=new Array;class R${constructor(){this.entities=new Array,this.spatialIndex=null,this._triggers=new Array,this._indexMap=new Map,this._typesMap=new Map,this._messageDispatcher=new v$}add(e){return this.entities.push(e),e.manager=this,this}remove(e){const t=this.entities.indexOf(e);return this.entities.splice(t,1),e.manager=null,this}clear(){return this.entities.length=0,this._messageDispatcher.clear(),this}getEntityByName(e){const t=this.entities;for(let n=0,r=t.length;n<r;n++){const s=t[n];if(s.name===e)return s}return null}update(e){const t=this.entities,n=this._triggers;for(let r=t.length-1;r>=0;r--)this.updateEntity(t[r],e);for(let r=n.length-1;r>=0;r--)this.processTrigger(n[r]);return this._triggers.length=0,this._messageDispatcher.dispatchDelayedMessages(e),this}updateEntity(e,t){if(!0===e.active){this.updateNeighborhood(e),!1===e._started&&(e.start(),e._started=!0),e.update(t);const n=e.children;for(let o=n.length-1;o>=0;o--)this.updateEntity(n[o],t);if(e instanceof FA&&this._triggers.push(e),null!==this.spatialIndex){let o=this._indexMap.get(e)||-1;o=this.spatialIndex.updateEntity(e,o),this._indexMap.set(e,o)}const r=e._renderComponent,s=e._renderComponentCallback;null!==r&&null!==s&&s(e,r)}return this}updateNeighborhood(e){if(!0===e.updateNeighborhood){e.neighbors.length=0,null!==this.spatialIndex?this.spatialIndex.query(e.position,e.neighborhoodRadius,Eu):(Eu.length=0,Eu.push(...this.entities));const t=e.neighborhoodRadius*e.neighborhoodRadius;for(let n=0,r=Eu.length;n<r;n++){const s=Eu[n];e!==s&&!0===s.active&&e.position.squaredDistanceTo(s.position)<=t&&e.neighbors.push(s)}}return this}processTrigger(e){e.updateRegion();const t=this.entities;for(let n=t.length-1;n>=0;n--){const r=t[n];e!==r&&!0===r.active&&!0===r.canActivateTrigger&&e.check(r)}return this}sendMessage(e,t,n,r,s){return this._messageDispatcher.dispatch(e,t,n,r,s),this}toJSON(){const e={type:this.constructor.name,entities:new Array,_messageDispatcher:this._messageDispatcher.toJSON()};function t(n){e.entities.push(n.toJSON());for(let r=0,s=n.children.length;r<s;r++)t(n.children[r])}for(let n=0,r=this.entities.length;n<r;n++)t(this.entities[n]);return e}fromJSON(e){this.clear();const t=e.entities,n=e._messageDispatcher,r=new Map;for(let s=0,o=t.length;s<o;s++){const a=t[s],l=a.type;let c;switch(l){case"GameEntity":c=(new e_).fromJSON(a);break;case"MovingEntity":c=(new lA).fromJSON(a);break;case"Vehicle":c=(new g_).fromJSON(a);break;case"Trigger":c=(new FA).fromJSON(a);break;default:const u=this._typesMap.get(l);if(void 0===u){Ft.warn("YUKA.EntityManager: Unsupported entity type:",l);continue}c=(new u).fromJSON(a)}r.set(c.uuid,c),null===c.parent&&this.add(c)}for(let s of r.values())s.resolveReferences(r);return this._messageDispatcher.fromJSON(n),this}registerType(e,t){return this._typesMap.set(e,t),this}}const Pl=new R,y_=new R,_p=new R;class v_{constructor(e=new R(0,0,1),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal=e,this.constant=t,this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}clone(){return(new this.constructor).copy(this)}distanceToPoint(e){return this.normal.dot(e)+this.constant}fromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}fromCoplanarPoints(e,t,n){return Pl.subVectors(n,t).cross(y_.subVectors(e,t)).normalize(),this.fromNormalAndCoplanarPoint(Pl,e),this}intersectPlane(e,t){_p.crossVectors(this.normal,e.normal);const n=_p.dot(_p);return 0===n?null:(Pl.copy(e.normal).multiplyScalar(this.constant),y_.copy(this.normal).multiplyScalar(e.constant),t.crossVectors(Pl.sub(y_),_p).divideScalar(n),t)}intersectsPlane(e){const t=this.normal.dot(e.normal);return 1!==Math.abs(t)}projectPoint(e,t){return Pl.copy(this.normal).multiplyScalar(this.distanceToPoint(e)),t.subVectors(e,Pl),t}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}new Lo,new R,new R,new R,new dp,new v_,new Tl,new R,new R,new R,new R;class VA{constructor(){this._previousTime=0,this._currentTime=0,this._delta=0,this._elapsed=0,this._timescale=1,this._useFixedDelta=!1,this._fixedDelta=16.67,this._usePageVisibilityAPI=typeof document<"u"&&void 0!==document.hidden,!0===this._usePageVisibilityAPI&&(this._pageVisibilityHandler=P$.bind(this),document.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disableFixedDelta(){return this._useFixedDelta=!1,this}dispose(){return!0===this._usePageVisibilityAPI&&document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this}enableFixedDelta(){return this._useFixedDelta=!0,this}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getFixedDelta(){return this._fixedDelta/1e3}getTimescale(){return this._timescale}reset(){return this._currentTime=this._now(),this}setFixedDelta(e){return this._fixedDelta=1e3*e,this}setTimescale(e){return this._timescale=e,this}update(){return!0===this._useFixedDelta?this._delta=this._fixedDelta:(this._previousTime=this._currentTime,this._currentTime=this._now(),this._delta=this._currentTime-this._previousTime),this._delta*=this._timescale,this._elapsed+=this._delta,this}_now(){return(typeof performance>"u"?Date:performance).now()}}function P$(){!1===document.hidden&&this.reset()}class HA{clearDegreeOfMembership(){}getDegreeOfMembership(){}updateDegreeOfMembership(){}toJSON(){return{type:this.constructor.name}}}class Ns extends HA{constructor(e=new Array){super(),this.terms=e}clearDegreeOfMembership(){const e=this.terms;for(let t=0,n=e.length;t<n;t++)e[t].clearDegreeOfMembership();return this}updateDegreeOfMembership(e){const t=this.terms;for(let n=0,r=t.length;n<r;n++)t[n].updateDegreeOfMembership(e);return this}toJSON(){const e=super.toJSON();e.terms=new Array;for(let t=0,n=this.terms.length;t<n;t++){const r=this.terms[t];e.terms.push(r instanceof Ns?r.toJSON():r.uuid)}return e}}class N$ extends Ns{constructor(){super(Array.from(arguments))}getDegreeOfMembership(){const e=this.terms;let t=1/0;for(let n=0,r=e.length;n<r;n++){const o=e[n].getDegreeOfMembership();o<t&&(t=o)}return t}}class O$ extends Ns{constructor(e=null){super(null!==e?[e]:new Array)}clearDegreeOfMembership(){return this.terms[0].clearDegreeOfMembership(),this}getDegreeOfMembership(){const t=this.terms[0].getDegreeOfMembership();return Math.sqrt(t)}updateDegreeOfMembership(e){return this.terms[0].updateDegreeOfMembership(Math.sqrt(e)),this}}class F$ extends Ns{constructor(){super(Array.from(arguments))}getDegreeOfMembership(){const e=this.terms;let t=-1/0;for(let n=0,r=e.length;n<r;n++){const o=e[n].getDegreeOfMembership();o>t&&(t=o)}return t}}class k$ extends Ns{constructor(e=null){super(null!==e?[e]:new Array)}clearDegreeOfMembership(){return this.terms[0].clearDegreeOfMembership(),this}getDegreeOfMembership(){const t=this.terms[0].getDegreeOfMembership();return t*t}updateDegreeOfMembership(e){return this.terms[0].updateDegreeOfMembership(e*e),this}}class xp extends HA{constructor(e=0){super(),this.degreeOfMembership=0,this.representativeValue=e,this.left=0,this.right=0,this._uuid=null}get uuid(){return null===this._uuid&&(this._uuid=ti.generateUUID()),this._uuid}computeDegreeOfMembership(){}clearDegreeOfMembership(){return this.degreeOfMembership=0,this}getDegreeOfMembership(){return this.degreeOfMembership}updateDegreeOfMembership(e){return e>this.degreeOfMembership&&(this.degreeOfMembership=e),this}toJSON(){const e=super.toJSON();return e.degreeOfMembership=this.degreeOfMembership,e.representativeValue=this.representativeValue,e.left=this.left,e.right=this.right,e.uuid=this.uuid,e}fromJSON(e){return this.degreeOfMembership=e.degreeOfMembership,this.representativeValue=e.representativeValue,this.left=e.left,this.right=e.right,this._uuid=e.uuid,this}}class z$ extends xp{constructor(e=0,t=0,n=0){super((t+e)/2),this.left=e,this.midpoint=t,this.right=n}computeDegreeOfMembership(e){const t=this.midpoint,r=this.right;return e>=this.left&&e<=t?1:e>t&&e<=r?1/(r-t)*(r-e):0}toJSON(){const e=super.toJSON();return e.midpoint=this.midpoint,e}fromJSON(e){return super.fromJSON(e),this.midpoint=e.midpoint,this}}class B$ extends xp{constructor(e=0,t=0,n=0){super((t+n)/2),this.left=e,this.midpoint=t,this.right=n}computeDegreeOfMembership(e){const t=this.midpoint,n=this.left;return e>=n&&e<=t?1/(t-n)*(e-n):e>t&&e<=this.right?1:0}toJSON(){const e=super.toJSON();return e.midpoint=this.midpoint,e}fromJSON(e){return super.fromJSON(e),this.midpoint=e.midpoint,this}}class U$ extends xp{constructor(e=0,t=0,n=0){super(t),this.left=e,this.midpoint=t,this.right=n}computeDegreeOfMembership(e){return e>=this.left&&e<=this.right?1:0}toJSON(){const e=super.toJSON();return e.midpoint=this.midpoint,e}fromJSON(e){return super.fromJSON(e),this.midpoint=e.midpoint,this}}class V$ extends xp{constructor(e=0,t=0,n=0){super(t),this.left=e,this.midpoint=t,this.right=n}computeDegreeOfMembership(e){const t=this.midpoint,n=this.left,r=this.right;return e>=n&&e<=t?1/(t-n)*(e-n):e>t&&e<=r?1/(r-t)*(r-e):0}toJSON(){const e=super.toJSON();return e.midpoint=this.midpoint,e}fromJSON(e){return super.fromJSON(e),this.midpoint=e.midpoint,this}}class H${constructor(e=null,t=null){this.antecedent=e,this.consequence=t}initConsequence(){return this.consequence.clearDegreeOfMembership(),this}evaluate(){return this.consequence.updateDegreeOfMembership(this.antecedent.getDegreeOfMembership()),this}toJSON(){const e={},t=this.antecedent,n=this.consequence;return e.type=this.constructor.name,e.antecedent=t instanceof Ns?t.toJSON():t.uuid,e.consequence=n instanceof Ns?n.toJSON():n.uuid,e}fromJSON(e,t){function n(r){if("string"==typeof r)return t.get(r)||null;{const s=r.type;let o;switch(s){case"FuzzyAND":o=new N$;break;case"FuzzyOR":o=new F$;break;case"FuzzyVERY":o=new k$;break;case"FuzzyFAIRLY":o=new O$;break;default:return void Ft.error("YUKA.FuzzyRule: Unsupported operator type:",s)}const a=r.terms;for(let l=0,c=a.length;l<c;l++)o.terms.push(n(a[l]));return o}}return this.antecedent=n(e.antecedent),this.consequence=n(e.consequence),this}}class G${constructor(){this.fuzzySets=new Array,this.minRange=1/0,this.maxRange=-1/0}add(e){return this.fuzzySets.push(e),e.left<this.minRange&&(this.minRange=e.left),e.right>this.maxRange&&(this.maxRange=e.right),this}remove(e){const t=this.fuzzySets,n=t.indexOf(e);t.splice(n,1),this.minRange=1/0,this.maxRange=-1/0;for(let r=0,s=t.length;r<s;r++){const o=t[r];o.left<this.minRange&&(this.minRange=o.left),o.right>this.maxRange&&(this.maxRange=o.right)}return this}fuzzify(e){if(e<this.minRange||e>this.maxRange)return void Ft.warn("YUKA.FuzzyVariable: Value for fuzzification out of range.");const t=this.fuzzySets;for(let n=0,r=t.length;n<r;n++){const s=t[n];s.degreeOfMembership=s.computeDegreeOfMembership(e)}return this}defuzzifyMaxAv(){const e=this.fuzzySets;let t=0,n=0;for(let r=0,s=e.length;r<s;r++){const o=e[r];t+=o.degreeOfMembership,n+=o.representativeValue*o.degreeOfMembership}return 0===t?0:n/t}defuzzifyCentroid(e=10){const t=this.fuzzySets,n=(this.maxRange-this.minRange)/e;let r=0,s=0;for(let o=1;o<=e;o++){const a=this.minRange+o*n;for(let l=0,c=t.length;l<c;l++){const u=t[l],h=Math.min(u.degreeOfMembership,u.computeDegreeOfMembership(a));r+=h,s+=a*h}}return 0===r?0:s/r}toJSON(){const e={type:this.constructor.name,fuzzySets:new Array,minRange:this.minRange.toString(),maxRange:this.maxRange.toString()};for(let t=0,n=this.fuzzySets.length;t<n;t++)e.fuzzySets.push(this.fuzzySets[t].toJSON());return e}fromJSON(e){this.minRange=parseFloat(e.minRange),this.maxRange=parseFloat(e.maxRange);for(let t=0,n=e.fuzzySets.length;t<n;t++){const r=e.fuzzySets[t];switch(r.type){case"LeftShoulderFuzzySet":this.fuzzySets.push((new z$).fromJSON(r));break;case"RightShoulderFuzzySet":this.fuzzySets.push((new B$).fromJSON(r));break;case"SingletonFuzzySet":this.fuzzySets.push((new U$).fromJSON(r));break;case"TriangularFuzzySet":this.fuzzySets.push((new V$).fromJSON(r));break;default:Ft.error("YUKA.FuzzyVariable: Unsupported fuzzy set type:",r.type)}}return this}}class Au{constructor(){this.rules=new Array,this.flvs=new Map}addFLV(e,t){return this.flvs.set(e,t),this}removeFLV(e){return this.flvs.delete(e),this}addRule(e){return this.rules.push(e),this}removeRule(e){const t=this.rules,n=t.indexOf(e);return t.splice(n,1),this}fuzzify(e,t){return this.flvs.get(e).fuzzify(t),this}defuzzify(e,t=Au.DEFUZ_TYPE.MAXAV){const n=this.flvs,r=this.rules;this._initConsequences();for(let a=0,l=r.length;a<l;a++)r[a].evaluate();const s=n.get(e);let o;switch(t){case Au.DEFUZ_TYPE.MAXAV:o=s.defuzzifyMaxAv();break;case Au.DEFUZ_TYPE.CENTROID:o=s.defuzzifyCentroid();break;default:Ft.warn("YUKA.FuzzyModule: Unknown defuzzification method:",t),o=s.defuzzifyMaxAv()}return o}_initConsequences(){const e=this.rules;for(let t=0,n=e.length;t<n;t++)e[t].initConsequence();return this}toJSON(){const e={rules:new Array,flvs:new Array},t=this.rules;for(let r=0,s=t.length;r<s;r++)e.rules.push(t[r].toJSON());const n=this.flvs;for(let[r,s]of n)e.flvs.push({name:r,flv:s.toJSON()});return e}fromJSON(e){const t=new Map,n=e.flvs;for(let s=0,o=n.length;s<o;s++){const a=n[s],l=a.name,c=(new G$).fromJSON(a.flv);this.addFLV(l,c);for(let u of c.fuzzySets)t.set(u.uuid,u)}const r=e.rules;for(let s=0,o=r.length;s<o;s++){const a=r[s],l=(new H$).fromJSON(a,t);this.addRule(l)}return this}}Au.DEFUZ_TYPE=Object.freeze({MAXAV:0,CENTROID:1});class hi{constructor(e=null){this.owner=e,this.status=hi.STATUS.INACTIVE}activate(){}execute(){}terminate(){}handleMessage(){return!1}active(){return this.status===hi.STATUS.ACTIVE}inactive(){return this.status===hi.STATUS.INACTIVE}completed(){return this.status===hi.STATUS.COMPLETED}failed(){return this.status===hi.STATUS.FAILED}replanIfFailed(){return!0===this.failed()&&(this.status=hi.STATUS.INACTIVE),this}activateIfInactive(){return!0===this.inactive()&&(this.status=hi.STATUS.ACTIVE,this.activate()),this}toJSON(){return{type:this.constructor.name,owner:this.owner.uuid,status:this.status}}fromJSON(e){return this.owner=e.owner,this.status=e.status,this}resolveReferences(e){return this.owner=e.get(this.owner)||null,this}}hi.STATUS=Object.freeze({ACTIVE:"active",INACTIVE:"inactive",COMPLETED:"completed",FAILED:"failed"}),new R,new R,new R,new R(1,0,0),new R(0,1,0),new R(0,0,1),new R,new R,new R,new R,new Array;const JA=new R,wp=new R;class b_{constructor(e=new R,t=new R){this.from=e,this.to=t}set(e,t){return this.from=e,this.to=t,this}copy(e){return this.from.copy(e.from),this.to.copy(e.to),this}clone(){return(new this.constructor).copy(this)}delta(e){return e.subVectors(this.to,this.from)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.from)}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.at(r,n)}closestPointToPointParameter(e,t=!0){JA.subVectors(e,this.from),wp.subVectors(this.to,this.from);const n=wp.dot(wp);let s=wp.dot(JA)/n;return t&&(s=ti.clamp(s,0,1)),s}equals(e){return e.from.equals(this.from)&&e.to.equals(this.to)}}const bp=new R,YA=new R,M_=new R,S_=new R,C_=new R,D_=new R,ZA=new R;class tj{constructor(e=new R){this.vertex=e,this.next=null,this.prev=null,this.twin=null,this.polygon=null}tail(){return this.prev?this.prev.vertex:null}head(){return this.vertex}length(){const e=this.tail(),t=this.head();return null!==e?e.distanceTo(t):-1}squaredLength(){const e=this.tail(),t=this.head();return null!==e?e.squaredDistanceTo(t):-1}linkOpponent(e){return this.twin=e,e.twin=this,this}getDirection(e){return e.subVectors(this.vertex,this.prev.vertex).normalize()}}class ts{constructor(){this.centroid=new R,this.edge=null,this.plane=new v_}fromContour(e){const t=new Array;if(e.length<3)return Ft.error("YUKA.Polygon: Unable to create polygon from contour. It needs at least three points."),this;for(let n=0,r=e.length;n<r;n++){const s=new tj(e[n]);t.push(s)}for(let n=0,r=t.length;n<r;n++){let s,o,a;0===n?(s=t[n],o=t[r-1],a=t[n+1]):n===r-1?(s=t[n],o=t[n-1],a=t[0]):(s=t[n],o=t[n-1],a=t[n+1]),s.prev=o,s.next=a,s.polygon=this}return this.edge=t[0],this.plane.fromCoplanarPoints(e[0],e[1],e[2]),this}computeCentroid(){const e=this.centroid;let t=this.edge,n=0;e.set(0,0,0);do{e.add(t.vertex),n++,t=t.next}while(t!==this.edge);return e.divideScalar(n),this}contains(e,t=.001){const n=this.plane;let r=this.edge;do{if(!1===E_(r.tail(),r.head(),e))return!1;r=r.next}while(r!==this.edge);const s=n.distanceToPoint(e);return!(Math.abs(s)>t)}convex(e=!0){let t=this.edge;do{const n=t.tail(),r=t.head(),s=t.next.head();if(e){if(!1===E_(n,r,s))return!1}else if(!1===E_(s,r,n))return!1;t=t.next}while(t!==this.edge);return!0}coplanar(e=.001){const t=this.plane;let n=this.edge;do{const r=t.distanceToPoint(n.vertex);if(Math.abs(r)>e)return!1;n=n.next}while(n!==this.edge);return!0}distanceToPoint(e){return this.plane.distanceToPoint(e)}getContour(e){let t=this.edge;e.length=0;do{e.push(t.vertex),t=t.next}while(t!==this.edge);return e}}function E_(i,e,t){return ti.area(i,e,t)>=0}class XA{constructor(){this.faces=new Array,this.edges=new Array,this.vertices=new Array,this.centroid=new R}computeCentroid(){const e=this.centroid;let t=this.faces;e.set(0,0,0);for(let n=0,r=t.length;n<r;n++)e.add(t[n].centroid);return e.divideScalar(t.length),this}computeUniqueVertices(){const e=this.faces,t=this.vertices;t.length=0;const n=new Set;for(let r=0,s=e.length;r<s;r++){const o=e[r];let a=o.edge;do{n.add(a.vertex),a=a.next}while(a!==o.edge)}return t.push(...n),this}computeUniqueEdges(){const e=this.faces,t=this.edges;t.length=0;for(let n=0,r=e.length;n<r;n++){const s=e[n];let o=s.edge;do{!1===t.includes(o.twin)&&t.push(o),o=o.next}while(o!==s.edge)}return this}fromAABB(e){this.faces.length=0,this.vertices.length=0;const t=e.min,n=e.max,r=[new R(n.x,n.y,n.z),new R(n.x,n.y,t.z),new R(n.x,t.y,n.z),new R(n.x,t.y,t.z),new R(t.x,n.y,n.z),new R(t.x,n.y,t.z),new R(t.x,t.y,n.z),new R(t.x,t.y,t.z)];this.vertices.push(...r);const s=(new ts).fromContour([r[4],r[0],r[1],r[5]]),o=(new ts).fromContour([r[2],r[3],r[1],r[0]]),a=(new ts).fromContour([r[6],r[2],r[0],r[4]]),l=(new ts).fromContour([r[3],r[7],r[5],r[1]]),c=(new ts).fromContour([r[3],r[2],r[6],r[7]]),u=(new ts).fromContour([r[7],r[6],r[4],r[5]]);return s.edge.linkOpponent(u.edge.prev),s.edge.next.linkOpponent(a.edge.prev),s.edge.next.next.linkOpponent(o.edge.prev),s.edge.prev.linkOpponent(l.edge.prev),c.edge.linkOpponent(l.edge.next),c.edge.next.linkOpponent(o.edge.next),c.edge.next.next.linkOpponent(a.edge.next),c.edge.prev.linkOpponent(u.edge.next),u.edge.linkOpponent(l.edge.next.next),l.edge.linkOpponent(o.edge.next.next),o.edge.linkOpponent(a.edge.next.next),a.edge.linkOpponent(u.edge.next.next),this.faces.push(s,o,a,l,c,u),s.computeCentroid(),o.computeCentroid(),a.computeCentroid(),l.computeCentroid(),c.computeCentroid(),u.computeCentroid(),e.getCenter(this.centroid),this.computeUniqueEdges(),this}}const KA=new b_,Mp=new v_,QA=new R,nj=new R(0,1,0),eT=new class ej{intersects(e,t){return!(this._checkFaceDirections(e,t)||this._checkFaceDirections(t,e)||this._checkEdgeDirections(e,t))}_checkFaceDirections(e,t){const n=e.faces;for(let r=0,s=n.length;r<s;r++){const a=n[r].plane;YA.copy(a.normal).multiplyScalar(-1);const l=this._getSupportVertex(t,YA);if(a.distanceToPoint(l)>0)return!0}return!1}_checkEdgeDirections(e,t){const n=e.edges,r=t.edges;for(let s=0,o=n.length;s<o;s++){const a=n[s];for(let l=0,c=r.length;l<c;l++){const u=r[l];if(a.getDirection(M_),u.getDirection(S_),this._minkowskiFace(a,M_,u,S_)&&this._distanceBetweenEdges(a,M_,u,S_,e)>0)return!0}}return!1}_getSupportVertex(e,t){let n=-1/0,r=null;const s=e.vertices;for(let o=0,a=s.length;o<a;o++){const l=s[o],c=l.dot(t);c>n&&(n=c,r=l)}return r}_minkowskiFace(e,t,n,r){const s=e.polygon.plane.normal,o=e.twin.polygon.plane.normal;C_.copy(n.polygon.plane.normal),D_.copy(n.twin.polygon.plane.normal),C_.multiplyScalar(-1),D_.multiplyScalar(-1);const a=C_.dot(t),l=D_.dot(t),c=s.dot(r),u=o.dot(r);return a*l<0&&c*u<0&&a*u>0}_distanceBetweenEdges(e,t,n,r,s){return 1===Math.abs(t.dot(r))?-1/0:(bp.crossVectors(t,r).normalize(),bp.dot(ZA.subVectors(e.vertex,s.centroid))<0&&bp.multiplyScalar(-1),bp.dot(ZA.subVectors(n.vertex,e.vertex)))}};let Tu;class ij extends XA{constructor(){super(),this.mergeFaces=!0,this._tolerance=-1,this._vertices=new Array,this._assigned=new tT,this._unassigned=new tT}containsPoint(e){const t=this.faces;for(let n=0,r=t.length;n<r;n++)if(t[n].distanceToPoint(e)>this._tolerance)return!1;return!0}intersectsAABB(e){if(void 0===Tu)Tu=(new XA).fromAABB(e);else{const t=e.min,n=e.max,r=Tu.vertices;r[0].set(n.x,n.y,n.z),r[1].set(n.x,n.y,t.z),r[2].set(n.x,t.y,n.z),r[3].set(n.x,t.y,t.z),r[4].set(t.x,n.y,n.z),r[5].set(t.x,n.y,t.z),r[6].set(t.x,t.y,n.z),r[7].set(t.x,t.y,t.z),e.getCenter(Tu.centroid)}return eT.intersects(this,Tu)}intersectsConvexHull(e){return eT.intersects(this,e)}fromPoints(e){if(e.length<4)return Ft.error("YUKA.ConvexHull: The given points array needs at least four points."),this;for(let t=0,n=e.length;t<n;t++)this._vertices.push(new rj(e[t]));return this._generate(),this}_addAdjoiningFace(e,t){const n=new ns(e.point,t.prev.vertex,t.vertex);return this.faces.push(n),n.getEdge(-1).linkOpponent(t.twin),n.getEdge(0)}_addNewFaces(e,t){const n=[];let r=null,s=null;for(let o=0,a=t.length;o<a;o++){let l=this._addAdjoiningFace(e,t[o]);null===r?r=l:l.next.linkOpponent(s),n.push(l.polygon),s=l}return r.next.linkOpponent(s),n}_addVertexToFace(e,t){return e.face=t,null===t.outside?(this._assigned.append(e),t.outside=e):this._assigned.insertAfter(t.outside,e),this}_addVertexToHull(e){const t=[];this._unassigned.clear(),this._computeHorizon(e.point,null,e.face,t);const n=this._addNewFaces(e,t);return this._resolveUnassignedPoints(n),this}_reset(){return this._vertices.length=0,this._assigned.clear(),this._unassigned.clear(),this}_computeInitialHull(){let e,t,n,r;const s=this._vertices,o=this._computeExtremes(),a=o.min,l=o.max;let c,u;u=l.x.point.x-a.x.point.x,e=a.x,t=l.x,c=l.y.point.y-a.y.point.y,c>u&&(e=a.y,t=l.y,u=c),c=l.z.point.z-a.z.point.z,c>u&&(e=a.z,t=l.z),u=-1/0,KA.set(e.point,t.point);for(let d=0,f=s.length;d<f;d++){const p=s[d];p!==e&&p!==t&&(KA.closestPointToPoint(p.point,!0,QA),c=QA.squaredDistanceTo(p.point),c>u&&(u=c,n=p))}u=-1/0,Mp.fromCoplanarPoints(e.point,t.point,n.point);for(let d=0,f=s.length;d<f;d++){const p=s[d];p!==e&&p!==t&&p!==n&&(c=Math.abs(Mp.distanceToPoint(p.point)),c>u&&(u=c,r=p))}if(0===Mp.distanceToPoint(r.point))throw"ERROR: YUKA.ConvexHull: All extreme points lie in a single plane. Unable to compute convex hull.";const h=this.faces;Mp.distanceToPoint(r.point)<0?(h.push(new ns(e.point,t.point,n.point),new ns(r.point,t.point,e.point),new ns(r.point,n.point,t.point),new ns(r.point,e.point,n.point)),h[1].getEdge(2).linkOpponent(h[0].getEdge(1)),h[2].getEdge(2).linkOpponent(h[0].getEdge(2)),h[3].getEdge(2).linkOpponent(h[0].getEdge(0)),h[1].getEdge(1).linkOpponent(h[2].getEdge(0)),h[2].getEdge(1).linkOpponent(h[3].getEdge(0)),h[3].getEdge(1).linkOpponent(h[1].getEdge(0))):(h.push(new ns(e.point,n.point,t.point),new ns(r.point,e.point,t.point),new ns(r.point,t.point,n.point),new ns(r.point,n.point,e.point)),h[1].getEdge(2).linkOpponent(h[0].getEdge(0)),h[2].getEdge(2).linkOpponent(h[0].getEdge(2)),h[3].getEdge(2).linkOpponent(h[0].getEdge(1)),h[1].getEdge(0).linkOpponent(h[2].getEdge(1)),h[2].getEdge(0).linkOpponent(h[3].getEdge(1)),h[3].getEdge(0).linkOpponent(h[1].getEdge(1)));for(let d=0,f=s.length;d<f;d++){const p=s[d];if(p!==e&&p!==t&&p!==n&&p!==r){u=this._tolerance;let g=null;for(let m=0;m<4;m++)c=h[m].distanceToPoint(p.point),c>u&&(u=c,g=h[m]);null!==g&&this._addVertexToFace(p,g)}}return this}_computeExtremes(){const e=new R(1/0,1/0,1/0),t=new R(-1/0,-1/0,-1/0),n={x:null,y:null,z:null},r={x:null,y:null,z:null};for(let s=0,o=this._vertices.length;s<o;s++){const a=this._vertices[s],l=a.point;l.x<e.x&&(e.x=l.x,n.x=a),l.y<e.y&&(e.y=l.y,n.y=a),l.z<e.z&&(e.z=l.z,n.z=a),l.x>t.x&&(t.x=l.x,r.x=a),l.y>t.y&&(t.y=l.y,r.y=a),l.z>t.z&&(t.z=l.z,r.z=a)}return this._tolerance=3*Number.EPSILON*(Math.max(Math.abs(e.x),Math.abs(t.x))+Math.max(Math.abs(e.y),Math.abs(t.y))+Math.max(Math.abs(e.z),Math.abs(t.z))),{min:n,max:r}}_computeHorizon(e,t,n,r){if(n.outside){const o=n.outside;this._removeAllVerticesFromFace(n),this._unassigned.appendChain(o)}let s;n.active=!1,s=null===t?t=n.getEdge(0):t.next;do{let o=s.twin,a=o.polygon;a.active&&(a.distanceToPoint(e)>this._tolerance?this._computeHorizon(e,o,a,r):r.push(s)),s=s.next}while(s!==t);return this}_generate(){let e;for(this.faces.length=0,this._computeInitialHull();e=this._nextVertexToAdd();)this._addVertexToHull(e);return this._updateFaces(),this._postprocessHull(),this._reset(),this}_postprocessHull(){const e=this.faces,t=this.edges;if(!0===this.mergeFaces){const n={leftPrev:null,leftNext:null,rightPrev:null,rightNext:null};this.computeUniqueEdges(),t.sort((r,s)=>s.length()-r.length());for(let r=0,s=t.length;r<s;r++){const o=t[r];if(!1===this._mergePossible(o))continue;let a=o;n.prev=a.prev,n.next=a.next,n.prevTwin=a.twin.prev,n.nextTwin=a.twin.next,a.prev.next=a.twin.next,a.next.prev=a.twin.prev,a.twin.prev.next=a.next,a.twin.next.prev=a.prev;const l=a.polygon;l.edge=a.prev;const c=l.plane.normal.dot(nj)>=0;if(!0===l.convex(c)&&!0===l.coplanar(this._tolerance)){let u=l.edge;do{u.polygon=l,u=u.next}while(u!==l.edge);const h=e.indexOf(o.twin.polygon);e.splice(h,1)}else n.prev.next=a,n.next.prev=a,n.prevTwin.next=a.twin,n.nextTwin.prev=a.twin,l.edge=a}for(let r=0,s=e.length;r<s;r++)e[r].computeCentroid()}return this.computeCentroid(),this.computeUniqueEdges(),this.computeUniqueVertices(),this}_mergePossible(e){const t=e.polygon;let n=e.twin;do{if(n!==e.twin&&n.twin.polygon===t)return!1;n=n.next}while(e.twin!==n);return!0}_nextVertexToAdd(){let e=null;if(!1===this._assigned.empty()){let t=0,n=this._assigned.first();const r=n.face;do{const s=r.distanceToPoint(n.point);s>t&&(t=s,e=n),n=n.next}while(null!==n&&n.face===r)}return e}_updateFaces(){const e=this.faces,t=new Array;for(let n=0,r=e.length;n<r;n++){const s=e[n];s.active&&t.push(s)}return this.faces.length=0,this.faces.push(...t),this}_removeAllVerticesFromFace(e){if(null!==e.outside){const t=e.outside;t.face=null;let n=e.outside;for(;null!==n.next&&n.next.face===e;)n=n.next,n.face=null;e.outside=null,this._assigned.removeChain(t,n)}return this}_removeVertexFromFace(e,t){return e.face=null,e===t.outside&&(t.outside=null!==e.next&&e.next.face===t?e.next:null),this._assigned.remove(e),this}_resolveUnassignedPoints(e){if(!1===this._unassigned.empty()){let t=this._unassigned.first();do{let n=t.next,r=this._tolerance,s=null;for(let o=0,a=e.length;o<a;o++){const l=e[o];if(l.active){const c=l.distanceToPoint(t.point);c>r&&(r=c,s=l)}}null!==s&&this._addVertexToFace(t,s),t=n}while(null!==t)}return this}}class ns extends ts{constructor(e=new R,t=new R,n=new R){super(),this.outside=null,this.active=!0,this.fromContour([e,t,n]),this.computeCentroid()}getEdge(e){let t=this.edge;for(;e>0;)t=t.next,e--;for(;e<0;)t=t.prev,e++;return t}}class rj{constructor(e=new R){this.point=e,this.prev=null,this.next=null,this.face=null}}class tT{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertAfter(e,t){return t.prev=e,t.next=e.next,t.next?t.next.prev=t:this.tail=t,e.next=t,this}append(e){return null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e,this}appendChain(e){for(null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail;null!==e.next;)e=e.next;return this.tail=e,this}remove(e){return null===e.prev?this.head=e.next:e.prev.next=e.next,null===e.next?this.tail=e.prev:e.next.prev=e.prev,e.prev=null,e.next=null,this}removeChain(e,t){return null===e.prev?this.head=t.next:e.prev.next=t.next,null===t.next?this.tail=e.prev:t.next.prev=e.prev,e.prev=null,t.next=null,this}empty(){return null===this.head}}const nT={unitary:new Po,diagonal:new Po},ht={c:null,u:[new R,new R,new R],e:[]},_t={c:null,u:[new R,new R,new R],e:[]},Wt=[[],[],[]],qe=[[],[],[]],Nt=[],No=new R,Oo=new R,Fo=new R,Hi=new R,iT=new R,oj=new class sj{constructor(e=new R,t=new R,n=new Po){this.center=e,this.halfSizes=t,this.rotation=n}set(e,t,n){return this.center=e,this.halfSizes=t,this.rotation=n,this}copy(e){return this.center.copy(e.center),this.halfSizes.copy(e.halfSizes),this.rotation.copy(e.rotation),this}clone(){return(new this.constructor).copy(this)}getSize(e){return e.copy(this.halfSizes).multiplyScalar(2)}clampPoint(e,t){const n=this.halfSizes;Hi.subVectors(e,this.center),this.rotation.extractBasis(No,Oo,Fo),t.copy(this.center);const r=ti.clamp(Hi.dot(No),-n.x,n.x);t.add(No.multiplyScalar(r));const s=ti.clamp(Hi.dot(Oo),-n.y,n.y);t.add(Oo.multiplyScalar(s));const o=ti.clamp(Hi.dot(Fo),-n.z,n.z);return t.add(Fo.multiplyScalar(o)),t}containsPoint(e){return Hi.subVectors(e,this.center),this.rotation.extractBasis(No,Oo,Fo),Math.abs(Hi.dot(No))<=this.halfSizes.x&&Math.abs(Hi.dot(Oo))<=this.halfSizes.y&&Math.abs(Hi.dot(Fo))<=this.halfSizes.z}intersectsAABB(e){return this.intersectsOBB(oj.fromAABB(e))}intersectsBoundingSphere(e){return this.clampPoint(e.center,iT),iT.squaredDistanceTo(e.center)<=e.radius*e.radius}intersectsOBB(e,t=Number.EPSILON){ht.c=this.center,ht.e[0]=this.halfSizes.x,ht.e[1]=this.halfSizes.y,ht.e[2]=this.halfSizes.z,this.rotation.extractBasis(ht.u[0],ht.u[1],ht.u[2]),_t.c=e.center,_t.e[0]=e.halfSizes.x,_t.e[1]=e.halfSizes.y,_t.e[2]=e.halfSizes.z,e.rotation.extractBasis(_t.u[0],_t.u[1],_t.u[2]);for(let s=0;s<3;s++)for(let o=0;o<3;o++)Wt[s][o]=ht.u[s].dot(_t.u[o]);Hi.subVectors(_t.c,ht.c),Nt[0]=Hi.dot(ht.u[0]),Nt[1]=Hi.dot(ht.u[1]),Nt[2]=Hi.dot(ht.u[2]);for(let s=0;s<3;s++)for(let o=0;o<3;o++)qe[s][o]=Math.abs(Wt[s][o])+t;let n,r;for(let s=0;s<3;s++)if(n=ht.e[s],r=_t.e[0]*qe[s][0]+_t.e[1]*qe[s][1]+_t.e[2]*qe[s][2],Math.abs(Nt[s])>n+r)return!1;for(let s=0;s<3;s++)if(n=ht.e[0]*qe[0][s]+ht.e[1]*qe[1][s]+ht.e[2]*qe[2][s],r=_t.e[s],Math.abs(Nt[0]*Wt[0][s]+Nt[1]*Wt[1][s]+Nt[2]*Wt[2][s])>n+r)return!1;return n=ht.e[1]*qe[2][0]+ht.e[2]*qe[1][0],r=_t.e[1]*qe[0][2]+_t.e[2]*qe[0][1],!(Math.abs(Nt[2]*Wt[1][0]-Nt[1]*Wt[2][0])>n+r||(n=ht.e[1]*qe[2][1]+ht.e[2]*qe[1][1],r=_t.e[0]*qe[0][2]+_t.e[2]*qe[0][0],Math.abs(Nt[2]*Wt[1][1]-Nt[1]*Wt[2][1])>n+r)||(n=ht.e[1]*qe[2][2]+ht.e[2]*qe[1][2],r=_t.e[0]*qe[0][1]+_t.e[1]*qe[0][0],Math.abs(Nt[2]*Wt[1][2]-Nt[1]*Wt[2][2])>n+r)||(n=ht.e[0]*qe[2][0]+ht.e[2]*qe[0][0],r=_t.e[1]*qe[1][2]+_t.e[2]*qe[1][1],Math.abs(Nt[0]*Wt[2][0]-Nt[2]*Wt[0][0])>n+r)||(n=ht.e[0]*qe[2][1]+ht.e[2]*qe[0][1],r=_t.e[0]*qe[1][2]+_t.e[2]*qe[1][0],Math.abs(Nt[0]*Wt[2][1]-Nt[2]*Wt[0][1])>n+r)||(n=ht.e[0]*qe[2][2]+ht.e[2]*qe[0][2],r=_t.e[0]*qe[1][1]+_t.e[1]*qe[1][0],Math.abs(Nt[0]*Wt[2][2]-Nt[2]*Wt[0][2])>n+r)||(n=ht.e[0]*qe[1][0]+ht.e[1]*qe[0][0],r=_t.e[1]*qe[2][2]+_t.e[2]*qe[2][1],Math.abs(Nt[1]*Wt[0][0]-Nt[0]*Wt[1][0])>n+r)||(n=ht.e[0]*qe[1][1]+ht.e[1]*qe[0][1],r=_t.e[0]*qe[2][2]+_t.e[2]*qe[2][0],Math.abs(Nt[1]*Wt[0][1]-Nt[0]*Wt[1][1])>n+r)||(n=ht.e[0]*qe[1][2]+ht.e[1]*qe[0][2],r=_t.e[0]*qe[2][1]+_t.e[1]*qe[2][0],Math.abs(Nt[1]*Wt[0][2]-Nt[0]*Wt[1][2])>n+r))}intersectsPlane(e){this.rotation.extractBasis(No,Oo,Fo);const t=this.halfSizes.x*Math.abs(e.normal.dot(No))+this.halfSizes.y*Math.abs(e.normal.dot(Oo))+this.halfSizes.z*Math.abs(e.normal.dot(Fo)),n=e.normal.dot(this.center)-e.constant;return Math.abs(n)<=t}fromAABB(e){return e.getCenter(this.center),e.getSize(this.halfSizes).multiplyScalar(.5),this.rotation.identity(),this}fromPoints(e){const n=(new ij).fromPoints(e).faces,r=new Array,s=new Array;for(let G=0,te=n.length;G<te;G++){const z=n[G];let ne=z.edge;r.length=0;do{r.push(ne),ne=ne.next}while(ne!==z.edge);for(let B=1,H=r.length-2;B<=H;B++){const oe=r[0].vertex,se=r[B+0].vertex,ue=r[B+1].vertex;s.push(oe.x,oe.y,oe.z),s.push(se.x,se.y,se.z),s.push(ue.x,ue.y,ue.z)}}const o=new R,a=new R,l=new R,c=new R,u=new R,h=new R,d=new R,f=new R;let g,m,y,_,v,x,p=0;g=m=y=_=v=x=0;for(let G=0,te=s.length;G<te;G+=9){o.fromArray(s,G),a.fromArray(s,G+3),l.fromArray(s,G+6),d.set(0,0,0),d.add(o).add(a).add(l).divideScalar(3),c.subVectors(a,o),u.subVectors(l,o);const z=h.crossVectors(c,u).length()/2;f.add(h.copy(d).multiplyScalar(z)),p+=z,g+=z/12*(9*d.x*d.x+o.x*o.x+a.x*a.x+l.x*l.x),m+=z/12*(9*d.x*d.y+o.x*o.y+a.x*a.y+l.x*l.y),y+=z/12*(9*d.x*d.z+o.x*o.z+a.x*a.z+l.x*l.z),_+=z/12*(9*d.y*d.y+o.y*o.y+a.y*a.y+l.y*l.y),v+=z/12*(9*d.y*d.z+o.y*o.z+a.y*a.z+l.y*l.z),x+=z/12*(9*d.z*d.z+o.z*o.z+a.z*a.z+l.z*l.z)}f.divideScalar(p),g/=p,m/=p,y/=p,_/=p,v/=p,x/=p,g-=f.x*f.x,m-=f.x*f.y,y-=f.x*f.z,_-=f.y*f.y,v-=f.y*f.z,x-=f.z*f.z;const b=new Po;b.elements[0]=g,b.elements[1]=m,b.elements[2]=y,b.elements[3]=m,b.elements[4]=_,b.elements[5]=v,b.elements[6]=y,b.elements[7]=v,b.elements[8]=x,b.eigenDecomposition(nT);const S=nT.unitary,T=new R,w=new R,C=new R;S.extractBasis(T,w,C);let I=-1/0,F=-1/0,Z=-1/0,k=1/0,L=1/0,U=1/0;for(let G=0,te=e.length;G<te;G++){const z=e[G];I=Math.max(T.dot(z),I),F=Math.max(w.dot(z),F),Z=Math.max(C.dot(z),Z),k=Math.min(T.dot(z),k),L=Math.min(w.dot(z),L),U=Math.min(C.dot(z),U)}return T.multiplyScalar(.5*(k+I)),w.multiplyScalar(.5*(L+F)),C.multiplyScalar(.5*(U+Z)),this.center.add(T).add(w).add(C),this.halfSizes.x=I-k,this.halfSizes.y=F-L,this.halfSizes.z=Z-U,this.halfSizes.multiplyScalar(.5),this.rotation.copy(S),this}equals(e){return e.center.equals(this.center)&&e.halfSizes.equals(this.halfSizes)&&e.rotation.equals(this.rotation)}toJSON(){return{type:this.constructor.name,center:this.center.toArray(new Array),halfSizes:this.halfSizes.toArray(new Array),rotation:this.rotation.toArray(new Array)}}fromJSON(e){return this.center.fromArray(e.center),this.halfSizes.fromArray(e.halfSizes),this.rotation.fromArray(e.rotation),this}};new R,new R,new R,new R,new b_,new Array,new R,Int8Array,Uint8Array,Int16Array,Uint16Array,Uint32Array,Float32Array,new R,new Qr,new Array,new R,new R,new dp,new R,new R,new R,new R,new R,new b_,new R;class Ap{constructor(){this.scene=new WE,this.coneGeo=new Rf(.5,2),this.normalMat=new E3,this.cone=new Vn(this.coneGeo,this.normalMat),this.entityManager=new R$,this.time=new VA,this.path=new s_,this.animate=()=>{const e=this.time.update().getDelta();this.entityManager.update(e),void 0!==this.camera&&this.renderer?.render(this.scene,this.camera),window.requestAnimationFrame(this.animate)},this.observer=new IntersectionObserver(e=>{for(const t of e)t.isIntersecting&&t.target.classList.add("shown")})}createPoint(e){return new R(e/2-Math.random()*e,e/2-Math.random()*e,e/2-Math.random()*e)}createLoop(e){let t=new R;for(let n=0;n<e;n++){let r=this.createPoint(50);for(;t.distanceTo(r)<10;)r=this.createPoint(50);this.path.add(r),t=r}}createBoids(e){const t=new g_;let n=new Vn(this.coneGeo,this.normalMat);t.maxSpeed=40,n.matrixAutoUpdate=!1,t.steering.add(new gA(this.path,10)),this.entityManager.add(t);const r=new TA;r.weight=10;const s=new AA(t);s.weight=.5;for(let o=0;o<e;o++){const a=new g_;let l=new Vn(this.coneGeo,this.normalMat);a.setRenderComponent(l,this.sync),a.maxSpeed=20+20*Math.random(),l.matrixAutoUpdate=!1,this.scene.add(l),a.updateNeighborhood=!0,a.neighborhoodRadius=5,a.position=this.createPoint(30),a.steering.add(s),a.steering.add(new cA),a.steering.add(new uA),a.steering.add(r),this.entityManager.add(a)}}createScene(){void 0===this.canvas||void 0===this.container||(this.camera=new Rn(50,this.container.clientWidth/this.container.clientHeight),this.renderer=new GE({canvas:this.canvas,alpha:!0,antialias:!0}),this.renderer?.setSize(this.container.clientWidth,this.container.clientHeight,!0),this.camera.position.z=100,this.path.loop=!0,this.createLoop(5),this.coneGeo.rotateX(Math.PI/2),this.createBoids(200),this.renderer.render(this.scene,this.camera))}sync(e,t){t.matrix.copy(e.worldMatrix)}onResize(){void 0===this.container||void 0===this.camera||(console.log("ping"),this.camera.aspect=this.container?.clientWidth/this.container?.clientHeight,this.camera.updateProjectionMatrix(),this.renderer?.setSize(this.container.clientWidth,this.container.clientHeight,!0))}ngOnInit(){const e=document.getElementById("room")??void 0;e instanceof HTMLCanvasElement&&(this.canvas=e),this.container=document.getElementById("container3D")??void 0,document.querySelectorAll(".animated").forEach(t=>this.observer.observe(t)),this.createScene(),this.animate()}static#e=this.\u0275fac=function(t){return new(t||Ap)};static#t=this.\u0275cmp=Wo({type:Ap,selectors:[["app-skills"]],hostBindings:function(t,n){1&t&&gc("resize",function(s){return n.onResize(s)},0,rm)},decls:59,vars:0,consts:[["rel","stylesheet","href","https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"],["id","flexible",1,"skill-page"],[1,"cards"],[2,"display","inline-block","transform","translateY(0.3em)"],[2,"display","inline-block","transform","translateY(0.15em)"],[2,"display","flex","align-items","center","justify-items","center","padding","3vw"],["viewBox","0 0 385 255","fill","none","xmlns","http://www.w3.org/2000/svg",2,"overflow","visible"],["id","phone"],["id","base","d","M3.85973 167.409L247.661 13.616C251.181 11.3952 255.175 10.226 259.24 10.226C263.305 10.226 267.299 11.3952 270.819 13.616L381.14 83.2083C382.314 83.9485 383.288 85.0133 383.966 86.2954C384.643 87.5776 385 89.032 385 90.5126C385 91.9931 384.643 93.4475 383.966 94.7297C383.288 96.0119 382.314 97.0766 381.14 97.8169L137.339 251.61C133.819 253.831 129.825 255 125.76 255C121.695 255 117.702 253.831 114.181 251.61L3.85973 182.018C2.68623 181.278 1.71173 180.213 1.0342 178.931C0.356684 177.648 0 176.194 0 174.713C0 173.233 0.356684 171.779 1.0342 170.496C1.71173 169.214 2.68623 168.149 3.85973 167.409Z","fill","white"],["id","angular",1,"animated"],["id","path17619","d","M233.472 3.38994L343.793 72.9822C344.967 73.7225 345.941 74.7872 346.619 76.0694C347.296 77.3516 347.653 78.806 347.653 80.2865C347.653 81.7671 347.296 83.2215 346.619 84.5037C345.941 85.7858 344.967 86.8506 343.793 87.5908L313.56 106.663C310.039 108.883 306.046 110.052 301.98 110.052C297.915 110.052 293.922 108.883 290.401 106.663L180.08 37.0703C178.906 36.33 177.932 35.2653 177.254 33.9832C176.577 32.701 176.22 31.2465 176.22 29.766C176.22 28.2855 176.577 26.831 177.254 25.5489C177.932 24.2667 178.906 23.2019 180.08 22.4617L210.313 3.38994C213.834 1.16915 217.828 0 221.893 0C225.958 0 229.951 1.16915 233.472 3.38994V3.38994Z","fill","#404040"],["id","text17679","d","M203.855 25.5322L202.293 24.547L219.112 19.6361L220.65 20.6061L212.865 31.2161L211.303 30.2309L217.983 21.3792L217.887 21.3185L203.855 25.5322ZM209.237 22.8646L215.532 26.8357L214.211 27.6694L207.915 23.6982L209.237 22.8646ZM221.557 29.6966L216.007 33.1979L214.589 32.3037L223.816 26.4833L225.185 27.3473L223.744 28.2567L223.864 28.3325C224.549 28.1733 225.253 28.143 225.978 28.2415C226.707 28.3375 227.42 28.6053 228.117 29.0449C228.742 29.439 229.16 29.8646 229.372 30.3219C229.588 30.7766 229.568 31.249 229.312 31.739C229.06 32.2266 228.541 32.7179 227.756 33.2131L221.894 36.9114L220.476 36.0171L226.243 32.3794C226.967 31.9222 227.344 31.4473 227.372 30.9547C227.404 30.4595 227.092 30.0048 226.435 29.5905C225.982 29.3051 225.48 29.1118 224.927 29.0108C224.378 28.9122 223.814 28.9173 223.233 29.0259C222.652 29.1346 222.094 29.3581 221.557 29.6966ZM224.556 43.1988C223.871 42.7668 223.371 42.3399 223.054 41.918C222.734 41.4987 222.552 41.0957 222.508 40.7092C222.464 40.3278 222.506 39.9754 222.634 39.652L224.556 39.8642C224.516 40.0512 224.486 40.2747 224.466 40.5349C224.442 40.7976 224.52 41.0869 224.7 41.4027C224.881 41.7235 225.249 42.0595 225.806 42.4106C226.55 42.8805 227.345 43.1546 228.19 43.2329C229.035 43.3112 229.842 43.1078 230.611 42.6228L232.485 41.4406L232.365 41.3648C232.093 41.4052 231.736 41.4431 231.296 41.4784C230.863 41.5138 230.373 41.4797 229.824 41.3761C229.284 41.2726 228.713 41.0313 228.112 40.6524C227.367 40.1825 226.875 39.6495 226.635 39.0533C226.398 38.4597 226.444 37.842 226.773 37.2004C227.105 36.5612 227.752 35.9385 228.713 35.3322C229.658 34.7361 230.647 34.3218 231.68 34.0894C232.718 33.8544 233.725 33.8026 234.702 33.934C235.683 34.0628 236.562 34.3723 237.339 34.8624C237.94 35.2413 238.316 35.6051 238.468 35.9537C238.628 36.3023 238.677 36.6155 238.612 36.8934C238.556 37.1713 238.5 37.3936 238.444 37.5603L238.588 37.6513L240.054 36.7267L241.424 37.5906L231.933 43.5777C231.14 44.0779 230.315 44.3709 229.458 44.4568C228.601 44.5478 227.754 44.4758 226.917 44.2408C226.08 44.011 225.293 43.6636 224.556 43.1988ZM229.578 39.9703C230.147 40.329 230.757 40.5501 231.41 40.6334C232.063 40.7168 232.736 40.6688 233.428 40.4894C234.121 40.3101 234.808 40.0057 235.489 39.5762C236.154 39.1569 236.64 38.7236 236.949 38.2765C237.257 37.8294 237.359 37.3911 237.255 36.9616C237.151 36.5322 236.81 36.1356 236.234 35.7718C235.633 35.3929 234.98 35.1731 234.275 35.1125C233.575 35.0544 232.868 35.1238 232.155 35.3209C231.446 35.5204 230.779 35.8173 230.155 36.2113C229.514 36.6155 229.047 37.0361 228.755 37.4732C228.471 37.9102 228.387 38.3422 228.503 38.7691C228.627 39.196 228.985 39.5964 229.578 39.9703ZM244.379 46.3363L249.833 42.8956L251.251 43.7899L242.024 49.6102L240.607 48.716L242.169 47.7308L242.072 47.6701C241.388 47.8293 240.653 47.8684 239.868 47.7876C239.087 47.7042 238.348 47.4428 237.651 47.0032C237.075 46.6394 236.688 46.2365 236.492 45.7944C236.3 45.3498 236.332 44.885 236.588 44.4C236.848 43.9124 237.371 43.4211 238.156 42.926L244.019 39.2276L245.436 40.1219L239.67 43.7596C238.997 44.184 238.648 44.6412 238.624 45.1313C238.604 45.6239 238.889 46.0559 239.477 46.4272C239.83 46.6496 240.278 46.8188 240.823 46.935C241.372 47.0537 241.956 47.074 242.577 46.9956C243.202 46.9199 243.802 46.7001 244.379 46.3363ZM258.341 44.382L246.039 52.1424L244.621 51.2482L256.923 43.4877L258.341 44.382ZM251.134 55.6295C250.549 55.2607 250.129 54.8565 249.873 54.4169C249.62 53.9749 249.564 53.5328 249.704 53.0907C249.848 52.6461 250.221 52.2343 250.822 51.8554C251.35 51.5219 251.883 51.3173 252.419 51.2415C252.96 51.1632 253.499 51.1746 254.035 51.2756C254.572 51.3767 255.097 51.5308 255.609 51.7379C256.13 51.9451 256.632 52.1661 257.117 52.401C257.75 52.7092 258.258 52.9619 258.643 53.1589C259.035 53.3559 259.358 53.4759 259.61 53.5189C259.866 53.5644 260.108 53.5151 260.337 53.3711L260.385 53.3408C260.977 52.9669 261.276 52.5741 261.28 52.1623C261.288 51.7531 260.965 51.3426 260.313 50.9308C259.636 50.5039 258.957 50.2626 258.276 50.2071C257.595 50.1515 257.009 50.1805 256.516 50.2942L255.651 49.1423C256.452 48.9402 257.209 48.8669 257.922 48.9225C258.643 48.9781 259.303 49.117 259.904 49.3393C260.513 49.5616 261.049 49.8193 261.514 50.1123C261.81 50.2993 262.115 50.5367 262.427 50.8247C262.747 51.1127 262.98 51.4386 263.124 51.8023C263.272 52.1686 263.248 52.5653 263.052 52.9922C262.856 53.4191 262.391 53.8637 261.658 54.326L255.579 58.1608L254.161 57.2665L255.411 56.4783L255.339 56.4328C255.042 56.4985 254.668 56.5326 254.216 56.5352C253.763 56.5377 253.27 56.472 252.738 56.3381C252.205 56.2042 251.671 55.968 251.134 55.6295ZM252.624 54.9626C253.184 55.3163 253.767 55.5449 254.372 55.6485C254.98 55.7546 255.557 55.7596 256.102 55.6636C256.65 55.5702 257.117 55.4022 257.501 55.1596L258.799 54.3412C258.667 54.3487 258.468 54.3071 258.204 54.2161C257.948 54.1252 257.666 54.0102 257.357 53.8713C257.057 53.7324 256.766 53.5947 256.486 53.4583C256.214 53.3218 255.992 53.212 255.819 53.1286C255.403 52.9265 254.98 52.7585 254.552 52.6246C254.131 52.4907 253.717 52.4288 253.308 52.4389C252.908 52.449 252.528 52.5678 252.167 52.7951C251.675 53.1059 251.484 53.4557 251.597 53.8448C251.717 54.2338 252.059 54.6064 252.624 54.9626ZM258.167 59.793L267.393 53.9727L268.763 54.8366L267.369 55.7157L267.465 55.7764C268.09 55.5945 268.765 55.5528 269.49 55.6513C270.215 55.7498 270.853 55.9734 271.406 56.322C271.51 56.3877 271.638 56.4711 271.79 56.5721C271.943 56.6731 272.055 56.7515 272.127 56.807L270.685 57.7165C270.649 57.6786 270.557 57.5977 270.409 57.4739C270.269 57.3502 270.104 57.2289 269.916 57.1102C269.468 56.8272 268.973 56.634 268.433 56.5304C267.9 56.4268 267.367 56.4142 266.835 56.4925C266.31 56.5708 265.84 56.7414 265.423 57.0041L259.584 60.6873L258.167 59.793Z","fill","white"],["id","g17868"],["id","path17753","d","M310.438 95.5637L284.335 92.2704L279.114 75.8043L299.997 62.6315L323.254 67.7199L331.32 82.3908L310.438 95.5637Z","fill","#E01B24"],["id","rect17808","d","M323.255 67.7198L284.336 92.2706L310.438 95.563L331.321 82.3902L323.255 67.7198Z","fill","#C01C28"],["id","flutter",1,"animated"],["id","path17613","d","M153.384 53.9105L263.705 123.503C264.879 124.243 265.853 125.308 266.531 126.59C267.208 127.872 267.565 129.326 267.565 130.807C267.565 132.288 267.208 133.742 266.531 135.024C265.853 136.306 264.879 137.371 263.705 138.111L233.472 157.183C229.951 159.404 225.958 160.573 221.893 160.573C217.827 160.573 213.834 159.404 210.313 157.183L99.9922 87.5909C98.8187 86.8506 97.8442 85.7859 97.1667 84.5037C96.4891 83.2215 96.1325 81.7671 96.1325 80.2865C96.1325 78.806 96.4891 77.3516 97.1667 76.0694C97.8442 74.7872 98.8187 73.7225 99.9922 72.9822L130.226 53.9105C133.746 51.6897 137.74 50.5205 141.805 50.5205C145.87 50.5205 149.864 51.6897 153.384 53.9105V53.9105Z","fill","#404040"],["id","text17687","d","M125.923 78.2139L138.225 70.4535L145.602 75.1067L144.28 75.9403L138.394 72.2268L134.237 74.849L139.571 78.2139L138.25 79.0476L132.915 75.6827L127.413 79.1537L125.923 78.2139ZM149.379 77.4892L137.077 85.2497L135.659 84.3554L147.961 76.5949L149.379 77.4892ZM149.26 88.1759L154.715 84.7353L156.132 85.6295L146.906 91.4499L145.488 90.5556L147.05 89.5704L146.954 89.5098C146.269 89.6689 145.534 89.7081 144.749 89.6272C143.968 89.5439 143.229 89.2824 142.532 88.8428C141.956 88.4791 141.569 88.0761 141.373 87.6341C141.181 87.1895 141.213 86.7246 141.469 86.2396C141.73 85.7521 142.252 85.2607 143.037 84.7656L148.9 81.0672L150.317 81.9615L144.551 85.5992C143.878 86.0236 143.53 86.4809 143.506 86.9709C143.486 87.4635 143.77 87.8955 144.359 88.2669C144.711 88.4892 145.16 88.6584 145.704 88.7746C146.253 88.8934 146.837 88.9136 147.458 88.8353C148.083 88.7595 148.684 88.5397 149.26 88.1759ZM162.741 89.7987L161.54 90.5565L156.758 87.5403L157.96 86.7824L162.741 89.7987ZM161.564 86.2671L162.982 87.1613L154.187 92.7089C153.787 92.9615 153.545 93.1876 153.461 93.3871C153.385 93.5867 153.405 93.7661 153.521 93.9252C153.645 94.0844 153.811 94.2296 154.019 94.361C154.175 94.4595 154.312 94.5353 154.428 94.5883C154.548 94.6389 154.644 94.6793 154.716 94.7096L153.731 95.6948C153.599 95.6569 153.429 95.595 153.22 95.5091C153.008 95.4258 152.77 95.3007 152.506 95.134C152.105 94.8814 151.799 94.5795 151.586 94.2284C151.378 93.8797 151.324 93.5147 151.424 93.1333C151.528 92.7543 151.849 92.3956 152.385 92.0571L161.564 86.2671ZM168.887 93.6751L167.685 94.433L162.904 91.4167L164.105 90.6589L168.887 93.6751ZM167.709 90.1435L169.127 91.0378L160.333 96.5853C159.932 96.8379 159.69 97.064 159.606 97.2636C159.53 97.4631 159.55 97.6425 159.666 97.8016C159.79 97.9608 159.956 98.1061 160.164 98.2374C160.321 98.3359 160.457 98.4117 160.573 98.4648C160.693 98.5153 160.789 98.5557 160.861 98.586L159.876 99.5712C159.744 99.5333 159.574 99.4715 159.365 99.3856C159.153 99.3022 158.915 99.1772 158.651 99.0104C158.25 98.7578 157.944 98.4559 157.732 98.1048C157.523 97.7562 157.469 97.3911 157.569 97.0097C157.674 96.6308 157.994 96.272 158.531 95.9335L167.709 90.1435ZM165.369 103.34C164.48 102.779 163.91 102.171 163.657 101.517C163.413 100.863 163.471 100.202 163.832 99.5352C164.2 98.8683 164.857 98.2368 165.802 97.6406C166.747 97.0444 167.752 96.6276 168.817 96.3901C169.891 96.1527 170.94 96.1022 171.965 96.2386C172.998 96.375 173.931 96.7059 174.764 97.2314C175.245 97.5345 175.639 97.8844 175.948 98.281C176.256 98.6776 176.422 99.1108 176.446 99.5807C176.474 100.048 176.308 100.539 175.948 101.055C175.587 101.57 174.977 102.099 174.116 102.642L173.515 103.021L166.403 98.5349L167.628 97.7619L173.299 101.339C173.819 101.011 174.18 100.652 174.38 100.263C174.584 99.8763 174.614 99.4885 174.47 99.0995C174.33 98.713 174.003 98.358 173.491 98.0347C172.926 97.6785 172.297 97.4587 171.605 97.3754C170.92 97.292 170.245 97.321 169.58 97.4625C168.916 97.604 168.329 97.8351 167.82 98.1559L167.003 98.6713C166.307 99.1108 165.836 99.5592 165.592 100.016C165.355 100.474 165.327 100.918 165.508 101.35C165.692 101.78 166.07 102.175 166.643 102.536C167.015 102.771 167.404 102.951 167.808 103.074C168.221 103.198 168.643 103.263 169.076 103.268C169.512 103.27 169.951 103.208 170.391 103.082L171.376 104.188C170.768 104.391 170.117 104.495 169.424 104.503C168.735 104.508 168.043 104.415 167.346 104.223C166.653 104.028 165.994 103.734 165.369 103.34ZM171.539 106.989L180.765 101.168L182.135 102.032L180.741 102.911L180.837 102.972C181.462 102.79 182.137 102.749 182.862 102.847C183.587 102.946 184.225 103.169 184.778 103.518C184.882 103.583 185.01 103.667 185.162 103.768C185.315 103.869 185.427 103.947 185.499 104.003L184.057 104.912C184.021 104.874 183.929 104.794 183.781 104.67C183.641 104.546 183.476 104.425 183.288 104.306C182.84 104.023 182.345 103.83 181.805 103.726C181.272 103.623 180.739 103.61 180.207 103.688C179.682 103.767 179.211 103.937 178.795 104.2L172.956 107.883L171.539 106.989Z","fill","white"],["id","g17995"],["id","path17983","d","M207.692 141.152L219.827 148.807L212.748 126.479L202.635 125.203L207.692 141.152Z","fill","#1A5FB4"],["id","path17985","d","M201.624 122.014L252.188 128.393L240.053 120.738L199.601 115.634L201.624 122.014Z","fill","#62A0EA"],["id","path17987","d","M204.658 131.583L240.053 136.048L227.917 128.393L202.635 125.203L204.658 131.583Z","fill","#62A0EA"],["id","path17989","d","M202.635 125.203L212.748 126.479L214.771 132.859L204.658 131.583L202.635 125.203Z","fill","#3584E4"],["id","firebase",1,"animated"],["id","path17604","d","M73.2963 104.431L183.618 174.023C184.791 174.764 185.766 175.828 186.443 177.11C187.121 178.393 187.477 179.847 187.477 181.328C187.477 182.808 187.121 184.263 186.443 185.545C185.766 186.827 184.791 187.892 183.618 188.632L153.384 207.704C149.864 209.924 145.87 211.094 141.805 211.094C137.74 211.094 133.746 209.924 130.226 207.704L19.9044 138.111C18.7309 137.371 17.7564 136.306 17.0789 135.024C16.4014 133.742 16.0447 132.288 16.0447 130.807C16.0447 129.326 16.4014 127.872 17.0789 126.59C17.7564 125.308 18.7309 124.243 19.9044 123.503L50.1379 104.431C53.6584 102.21 57.6519 101.041 61.7171 101.041C65.7822 101.041 69.7758 102.21 73.2963 104.431V104.431Z","fill","#404040"],["id","text17695","d","M40.8099 124.777L53.1122 117.017L60.4887 121.67L59.1672 122.504L53.2803 118.79L49.1235 121.413L54.4577 124.777L53.1362 125.611L47.802 122.246L42.2996 125.717L40.8099 124.777ZM50.5457 130.919L59.7724 125.099L61.19 125.993L51.9633 131.813L50.5457 130.919ZM62.031 124.583C61.7547 124.409 61.6105 124.199 61.5985 123.954C61.5905 123.712 61.7186 123.507 61.9829 123.34C62.2472 123.174 62.5716 123.093 62.9561 123.098C63.3445 123.105 63.6769 123.196 63.9532 123.371C64.2295 123.545 64.3717 123.753 64.3797 123.996C64.3917 124.241 64.2656 124.447 64.0013 124.614C63.737 124.78 63.4106 124.86 63.0221 124.852C62.6377 124.847 62.3073 124.758 62.031 124.583ZM54.5598 133.451L63.7865 127.631L65.1561 128.495L63.7625 129.374L63.8586 129.434C64.4833 129.253 65.1581 129.211 65.883 129.309C66.6078 129.408 67.2465 129.631 67.7992 129.98C67.9033 130.046 68.0315 130.129 68.1836 130.23C68.3358 130.331 68.4479 130.41 68.52 130.465L67.0783 131.375C67.0423 131.337 66.9502 131.256 66.802 131.132C66.6619 131.008 66.4977 130.887 66.3095 130.768C65.8609 130.485 65.3664 130.292 64.8257 130.189C64.2931 130.085 63.7605 130.072 63.2279 130.151C62.7033 130.229 62.2327 130.399 61.8162 130.662L55.9775 134.345L54.5598 133.451ZM64.2491 139.806C63.36 139.245 62.7894 138.637 62.5371 137.983C62.2928 137.329 62.3509 136.668 62.7113 136.001C63.0797 135.334 63.7365 134.703 64.6816 134.107C65.6267 133.51 66.6318 133.094 67.6971 132.856C68.7703 132.619 69.8195 132.568 70.8447 132.705C71.8779 132.841 72.811 133.172 73.644 133.697C74.1245 134.001 74.519 134.35 74.8273 134.747C75.1357 135.144 75.3019 135.577 75.3259 136.047C75.3539 136.514 75.1877 137.005 74.8273 137.521C74.4669 138.036 73.8562 138.565 72.9952 139.108L72.3945 139.487L65.2823 135.001L66.5077 134.228L72.1783 137.805C72.6989 137.477 73.0593 137.118 73.2595 136.729C73.4637 136.342 73.4938 135.955 73.3496 135.566C73.2095 135.179 72.8831 134.824 72.3705 134.501C71.8058 134.145 71.1771 133.925 70.4843 133.841C69.7995 133.758 69.1247 133.787 68.4599 133.929C67.7952 134.07 67.2085 134.301 66.6999 134.622L65.883 135.137C65.1862 135.577 64.7156 136.025 64.4713 136.483C64.235 136.94 64.207 137.384 64.3872 137.816C64.5714 138.246 64.9499 138.641 65.5225 139.002C65.895 139.237 66.2834 139.417 66.6879 139.54C67.1004 139.664 67.5229 139.729 67.9554 139.734C68.3919 139.736 68.8304 139.674 69.2709 139.548L70.256 140.655C69.6473 140.857 68.9966 140.961 68.3038 140.969C67.615 140.974 66.9222 140.881 66.2254 140.689C65.5326 140.494 64.8738 140.2 64.2491 139.806ZM70.6104 143.576L82.9127 135.816L84.3303 136.71L79.7891 139.575L79.9092 139.65C80.1735 139.615 80.5219 139.577 80.9544 139.537C81.3949 139.496 81.8875 139.524 82.4321 139.62C82.9848 139.716 83.5615 139.953 84.1622 140.332C84.9391 140.823 85.4296 141.377 85.6339 141.996C85.8381 142.615 85.75 143.254 85.3696 143.913C84.9891 144.573 84.3143 145.208 83.3452 145.819C82.3681 146.436 81.3549 146.865 80.3057 147.108C79.2605 147.348 78.2473 147.406 77.2662 147.282C76.289 147.156 75.416 146.85 74.6471 146.365C74.0544 145.991 73.678 145.63 73.5178 145.281C73.3616 144.93 73.3136 144.614 73.3736 144.334C73.4377 144.051 73.5018 143.824 73.5659 143.652L73.3977 143.546L71.98 144.44L70.6104 143.576ZM76.6174 141.545C75.9206 141.985 75.408 142.437 75.0796 142.902C74.7552 143.364 74.6391 143.814 74.7312 144.251C74.8273 144.685 75.1597 145.082 75.7284 145.44C76.3211 145.814 76.9718 146.028 77.6806 146.081C78.3975 146.134 79.1223 146.055 79.8552 145.846C80.596 145.636 81.2948 145.324 81.9516 144.91C82.6003 144.501 83.0849 144.069 83.4053 143.614C83.7337 143.159 83.8498 142.71 83.7537 142.265C83.6656 141.82 83.3212 141.409 82.7205 141.03C82.1438 140.666 81.5131 140.452 80.8283 140.389C80.1475 140.324 79.4467 140.392 78.7259 140.594C78.009 140.793 77.3062 141.11 76.6174 141.545ZM83.4233 151.931C82.8386 151.563 82.4181 151.158 82.1618 150.719C81.9095 150.277 81.8535 149.835 81.9936 149.393C82.1378 148.948 82.5102 148.536 83.1109 148.157C83.6395 147.824 84.1722 147.619 84.7088 147.543C85.2494 147.465 85.788 147.476 86.3247 147.578C86.8613 147.679 87.3859 147.833 87.8985 148.04C88.4191 148.247 88.9217 148.468 89.4062 148.703C90.039 149.011 90.5476 149.264 90.932 149.461C91.3245 149.658 91.6468 149.778 91.8991 149.821C92.1554 149.866 92.3977 149.817 92.626 149.673L92.674 149.643C93.2667 149.269 93.5651 148.876 93.5691 148.464C93.5771 148.055 93.2547 147.644 92.6019 147.233C91.9252 146.806 91.2464 146.565 90.5656 146.509C89.8848 146.453 89.2981 146.482 88.8055 146.596L87.9405 145.444C88.7415 145.242 89.4983 145.169 90.2112 145.224C90.932 145.28 91.5928 145.419 92.1935 145.641C92.8022 145.864 93.3388 146.121 93.8033 146.414C94.0997 146.601 94.404 146.839 94.7164 147.127C95.0368 147.415 95.269 147.74 95.4132 148.104C95.5614 148.471 95.5373 148.867 95.3411 149.294C95.1449 149.721 94.6803 150.166 93.9475 150.628L87.8685 154.463L86.4508 153.568L87.7003 152.78L87.6282 152.735C87.3318 152.8 86.9574 152.835 86.5049 152.837C86.0523 152.84 85.5598 152.774 85.0272 152.64C84.4945 152.506 83.9599 152.27 83.4233 151.931ZM84.913 151.264C85.4737 151.618 86.0563 151.847 86.6611 151.95C87.2698 152.056 87.8464 152.062 88.3911 151.966C88.9397 151.872 89.4062 151.704 89.7907 151.462L91.0882 150.643C90.956 150.651 90.7578 150.609 90.4935 150.518C90.2372 150.427 89.9549 150.312 89.6465 150.173C89.3462 150.034 89.0558 149.897 88.7755 149.76C88.5032 149.624 88.2809 149.514 88.1087 149.43C87.6922 149.228 87.2698 149.06 86.8413 148.927C86.4208 148.793 86.0063 148.731 85.5978 148.741C85.1974 148.751 84.8169 148.87 84.4565 149.097C83.9639 149.408 83.7737 149.758 83.8858 150.147C84.006 150.536 84.3484 150.908 84.913 151.264ZM104.152 155.701L102.518 155.125C102.65 154.94 102.738 154.736 102.782 154.511C102.834 154.286 102.794 154.049 102.662 153.799C102.53 153.548 102.258 153.293 101.845 153.033C101.281 152.677 100.68 152.462 100.043 152.389C99.4143 152.316 98.9017 152.404 98.5053 152.654C98.1529 152.877 98.0027 153.133 98.0548 153.423C98.1068 153.714 98.3371 154.074 98.7456 154.503L99.7788 155.58C100.403 156.226 100.712 156.807 100.704 157.323C100.7 157.835 100.375 158.295 99.7307 158.702C99.2021 159.035 98.5774 159.237 97.8565 159.308C97.1397 159.381 96.3908 159.323 95.6099 159.134C94.829 158.944 94.0802 158.624 93.3633 158.171C92.4222 157.578 91.8476 156.958 91.6393 156.311C91.4311 155.664 91.6373 155.041 92.258 154.443L93.94 155.079C93.5716 155.473 93.4414 155.861 93.5495 156.243C93.6617 156.627 94.0081 157.002 94.5887 157.368C95.2495 157.785 95.9143 158.027 96.5831 158.096C97.2598 158.164 97.7965 158.073 98.1929 157.823C98.5133 157.621 98.6695 157.381 98.6615 157.103C98.6575 156.822 98.4773 156.502 98.1208 156.14L96.9435 154.943C96.2987 154.284 95.9884 153.696 96.0124 153.181C96.0444 152.666 96.3788 152.207 97.0156 151.805C97.5362 151.477 98.1429 151.279 98.8357 151.21C99.5325 151.145 100.249 151.2 100.986 151.377C101.727 151.557 102.422 151.851 103.071 152.26C103.984 152.836 104.5 153.415 104.62 153.996C104.745 154.579 104.588 155.148 104.152 155.701ZM102.97 164.231C102.081 163.671 101.51 163.063 101.258 162.409C101.014 161.754 101.072 161.094 101.432 160.427C101.801 159.76 102.457 159.129 103.402 158.532C104.348 157.936 105.353 157.519 106.418 157.282C107.491 157.044 108.54 156.994 109.566 157.13C110.599 157.267 111.532 157.598 112.365 158.123C112.845 158.426 113.24 158.776 113.548 159.173C113.857 159.569 114.023 160.003 114.047 160.472C114.075 160.94 113.909 161.431 113.548 161.946C113.188 162.462 112.577 162.991 111.716 163.534L111.115 163.913L104.003 159.427L105.229 158.654L110.899 162.231C111.42 161.902 111.78 161.544 111.98 161.155C112.185 160.768 112.215 160.38 112.071 159.991C111.93 159.605 111.604 159.25 111.091 158.926C110.527 158.57 109.898 158.35 109.205 158.267C108.52 158.184 107.846 158.213 107.181 158.354C106.516 158.496 105.929 158.727 105.421 159.048L104.604 159.563C103.907 160.003 103.437 160.451 103.192 160.908C102.956 161.365 102.928 161.81 103.108 162.242C103.292 162.671 103.671 163.067 104.243 163.428C104.616 163.663 105.004 163.842 105.409 163.966C105.821 164.09 106.244 164.154 106.676 164.159C107.113 164.162 107.551 164.1 107.992 163.974L108.977 165.08C108.368 165.282 107.717 165.387 107.025 165.395C106.336 165.4 105.643 165.306 104.946 165.114C104.253 164.92 103.595 164.625 102.97 164.231Z","fill","white"],["id","g18226"],["id","path18053","d","M155.808 167.927L124.087 182.22L141.458 191.272L143.376 188.153L148.438 189.71L158.074 175.074L150.427 176.682L155.808 167.927Z","fill","#FFA500"],["id","path18167","d","M124.087 182.22L150.427 176.682L141.458 191.272L124.087 182.22Z","fill","#FF7800"],["id","path17997","d","M124.087 182.22L130.885 192.225L146.745 196.513L163.361 180.314L124.087 182.22Z","fill","#F5C211"],["id","creative",1,"skill-page"],[2,"font-family","'Dancing Script', cursive"],[1,"software"],[1,"logos"],["src","assets/Blender.svg","alt","The logo of Blender \u2013 free and open-source 3D computer graphics software"],[1,"softwareName"],["src","assets/Inkscape.svg","alt",""],["src","assets/Godot.svg","alt",""],["id","container3D",1,"container3D"],["id","room",1,"room"]],template:function(t,n){1&t&&(hn(0,"link",0),gt(1,"main")(2,"section",1)(3,"div",2)(4,"h1")(5,"span",3),zn(6,"Fle"),Ut(),gt(7,"span",4),zn(8,"xi"),Ut(),zn(9,"ble "),Ut(),gt(10,"p"),zn(11," I have experience working with diverse frameworks and languages and I am always willing to learn more. "),Ut()(),gt(12,"div",5),function j1(){He.lFrame.currentNamespace="svg"}(),gt(13,"svg",6)(14,"g",7),hn(15,"path",8),gt(16,"g",9),hn(17,"path",10)(18,"path",11),gt(19,"g",12),hn(20,"path",13)(21,"path",14),Ut()(),gt(22,"g",15),hn(23,"path",16)(24,"path",17),gt(25,"g",18),hn(26,"path",19)(27,"path",20)(28,"path",21)(29,"path",22),Ut()(),gt(30,"g",23),hn(31,"path",24)(32,"path",25),gt(33,"g",26),hn(34,"path",27)(35,"path",28)(36,"path",29),Ut()()()()()(),function q1(){!function KI(){He.lFrame.currentNamespace=null}()}(),gt(37,"section",30)(38,"div",2)(39,"h1")(40,"span",31),zn(41,"Creative"),Ut()(),gt(42,"p"),zn(43,"I am skilled in both 2D and 3D design,"),Ut(),gt(44,"div",32)(45,"div",33),hn(46,"img",34),gt(47,"h3",35),zn(48,"Blender"),Ut()(),gt(49,"div",33),hn(50,"img",36),gt(51,"h3",35),zn(52,"Inkscape"),Ut()(),gt(53,"div",33),hn(54,"img",37),gt(55,"h3",35),zn(56,"Godot"),Ut()()()(),gt(57,"div",38),hn(58,"canvas",39),Ut()()())},styles:['.skill-page[_ngcontent-%COMP%]{padding:0 7vw;display:grid;gap:3vh 3vw;height:100vh;align-items:center}@media (min-aspect-ratio: .7){.skill-page[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}.cards[_ngcontent-%COMP%]{display:grid;padding:4vw}.cards[_ngcontent-%COMP%] > h1[_ngcontent-%COMP%], .cards[_ngcontent-%COMP%] > h1[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{font-family:Abel,sans-serif;font-size:min(10vh,10vw);margin-bottom:.2em}.cards[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{font-size:max(2vh,3vw);font-family:"Exo 2",sans-serif;font-weight:200}.angular-card[_ngcontent-%COMP%]:before{z-index:0;position:absolute;content:"";top:0;left:0;height:100%;width:100%;-webkit-mask-image:url(/assets/logo-angular.svg);mask-image:url(/assets/logo-angular.svg);-webkit-mask-position:50% 50%;mask-position:50% 50%;-webkit-mask-size:contain;mask-size:contain;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;background-color:#202020;background-size:contain;background-position:50% 50%;background-repeat:no-repeat}#angular[_ngcontent-%COMP%], #flutter[_ngcontent-%COMP%], #firebase[_ngcontent-%COMP%]{opacity:0}#angular[_ngcontent-%COMP%]{animation-delay:.2s}#flutter[_ngcontent-%COMP%]{animation-delay:.3s}#firebase[_ngcontent-%COMP%]{animation-delay:.4s}.shown[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn 1s ease-in-out forwards}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:translate(-150px) translateY(100px);opacity:0}30%{opacity:0}to{transform:translate(0) translateY(0);opacity:1}}.software[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);margin-top:1em;width:-moz-fit-content;width:fit-content}.logos[_ngcontent-%COMP%]{padding:1em}.logos[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{height:10vh;aspect-ratio:1;transition:all .3s ease-in-out}.logos[_ngcontent-%COMP%]:hover > img[_ngcontent-%COMP%]{transform:translateY(-10%)}.softwareName[_ngcontent-%COMP%]{color:#505050;text-align:center;transform:translateY(-100%);opacity:0;transition:all .3s ease-in-out}.logos[_ngcontent-%COMP%]:hover > .softwareName[_ngcontent-%COMP%]{opacity:1;transform:translateY(-50%)}.room[_ngcontent-%COMP%], .container3D[_ngcontent-%COMP%]{width:100%;aspect-ratio:1}']})}class Tp{constructor(){this.title="CV"}scrollPercentage(e){return void 0===e?1:Math.min(window.scrollY/(this.skillPage?.clientHeight??1),1)}easeFn(e){return Math.min(e*e*e,1)}onScroll(e){this.skillPage.style.opacity=this.easeFn(2*this.scrollPercentage(this.skillPage)).toString(),this.scrollbar.style.height=`${Math.min(window.scrollY/(document.body.offsetHeight-window.innerHeight)*100,100)}vh`}ngOnInit(){this.skillPage=document.getElementById("skills")??void 0,this.scrollbar=document.getElementById("scrollbar")??void 0;let e=0;document.querySelectorAll(".icon").forEach(t=>{t instanceof HTMLElement&&(t.style.animationDelay=`${e}s`,e+=.2)})}static#e=this.\u0275fac=function(t){return new(t||Tp)};static#t=this.\u0275cmp=Wo({type:Tp,selectors:[["app-root"]],hostBindings:function(t,n){1&t&&gc("scroll",function(s){return n.onScroll(s)},0,rm)},decls:10,vars:0,consts:[["id","scrollbar",1,"scrollbar"],[1,"profile","page"],[1,"sidebar"],[1,"links"],[1,"icon","fa-brands","fa-github"],[1,"icon","fa-brands","fa-linkedin"],["id","skills",1,"skills","page"]],template:function(t,n){1&t&&(gt(0,"main"),hn(1,"div",0),gt(2,"section",1),hn(3,"app-profile"),gt(4,"div",2)(5,"div",3),hn(6,"i",4)(7,"i",5),Ut()()(),gt(8,"section",6),hn(9,"app-skills"),Ut()())},dependencies:[Nd,Ap],styles:[".sidebar[_ngcontent-%COMP%]{position:absolute;top:0;left:0;background-color:#131316;height:100vh;width:35vw}.scrollbar[_ngcontent-%COMP%]{z-index:100;position:fixed;top:0;left:0;height:0vh;width:1vw;background-color:#ffffff30;overflow:hidden}.links[_ngcontent-%COMP%]{margin:3vh;width:-moz-fit-content;width:fit-content;display:grid;justify-items:center}.icon[_ngcontent-%COMP%]{padding:.1em;font-size:5vh;color:#505050;background:linear-gradient(-20deg,turquoise 0%,#ff00dd 100%);-webkit-background-clip:text;background-clip:text;transition:color .3s ease-in-out;transform:translate(-300%);animation:_ngcontent-%COMP%_comeIn 1s ease-in-out forwards}.icon[_ngcontent-%COMP%]:hover{color:transparent;cursor:pointer}@keyframes _ngcontent-%COMP%_comeIn{0%{transform:translate(-300%);opacity:0}60%{opacity:0}to{transform:translateY(0);opacity:1}}li[_ngcontent-%COMP%], a[_ngcontent-%COMP%]{flex-grow:1;font-size:3vh;list-style:none;text-decoration:none;color:gray;transition:all .2s ease-in-out}li[_ngcontent-%COMP%]:hover, a[_ngcontent-%COMP%]:hover{cursor:pointer;font-size:6vh;color:#fff;flex-grow:1.5}#skills[_ngcontent-%COMP%]{opacity:0;margin-bottom:20vh}"]})}class Ip{static#e=this.\u0275fac=function(t){return new(t||Ip)};static#t=this.\u0275mod=Us({type:Ip,bootstrap:[Tp]});static#n=this.\u0275inj=ss({imports:[nk,Pd]})}tk().bootstrapModule(Ip).catch(i=>console.error(i))}},Tt=>{Tt(Tt.s=802)}]);